!function(){!function(){let e=document.querySelector(".team__list");e.addEventListener("click",function(t){if(t.preventDefault(),t.target.classList.contains("member__link")){let n=t.target,i=e.querySelector(".member.is-active");if(i&&(i.querySelector(".member__text").style.height="0px",i.classList.remove("is-active")),!i||i.querySelector(".member__link")!=n){let e=n.closest(".member");e.classList.add("is-active");let t=e.querySelector(".member__text");t.style.height=t.scrollHeight+"px"}}})}(),function(){let e=document.querySelectorAll(".menu__block"),t=document.querySelector("body");e.forEach(function(e){e.addEventListener("click",function(e){e.preventDefault();let n=this,i=document.querySelector(".menu__item.is-active");if(i&&(i.querySelector(".menu__desc").style.width="0px",i.classList.remove("is-active")),!i||i.querySelector(".menu__block")!=n){let e=n.closest(".menu__item");e.classList.add("is-active");let i=e.querySelector(".menu__desc");t.offsetWidth>480?i.style.width=function(){let e=document.documentElement.clientWidth,t=document.querySelectorAll(".menu__block"),n=e-parseFloat(getComputedStyle(t[0]).width)*t.length;return n>550?550:n}()+"px":i.style.width="auto"}})})}()}(),$(function(){let e=$(".candy-bar__slider");$(".scroll-btn").on("click",function(t){t.preventDefault();let n,i,o=$(this),l=e.find(".candy-bar__item"),c=l.filter(".active");o.hasClass("scroll-btn--forward")&&(n=c.next(),i=l.first()),o.hasClass("scroll-btn--back")&&(n=c.prev(),i=l.last()),function(t){let n=e.find(".candy-bar__item"),i=n.filter(".active"),o=n.eq(t),l=o.index(),c=e.find(".candy-bar__list");o.length&&c.animate({left:100*-l+"%"},500,function(){i.removeClass("active"),o.addClass("active")})}(n.length?n.index():i.index())})}),ymaps.ready(init);var geoObjects=[],marks=[{latitude:55.7587,longitude:37.5828,hintContent:'<div class="map__hint">Кудринская площадь д.1</div>'},{latitude:55.7427,longitude:37.5799,hintContent:'<div class="map__hint">ул.Плющиха д.11</div>'},{latitude:55.7574,longitude:37.6208,hintContent:'<div class="map__hint">Площадь Революции д.1</div>'},{latitude:55.75,longitude:37.6037,hintContent:'<div class="map__hint">Большой Знаменский пер. д.23</div>'}];function init(){var e=new ymaps.Map("map",{center:[55.75269656,37.59427083],zoom:14,controls:["zoomControl"],behaviors:["drag"]});for(let e=0;e<marks.length;e++)geoObjects[e]=new ymaps.Placemark([marks[e].latitude,marks[e].longitude],{hintContent:marks[e].hintContent},{iconLayout:"default#image",iconImageHref:"https://vadimbeck.github.io/web/img/marker.png",iconImageSize:[46,57],iconImageOffset:[-23,-57]});var t=new ymaps.Clusterer({clusterIcons:[{href:"https://vadimbeck.github.io/web/img/marker.png",size:[46,57],offset:[-23,-57]}],clusterIconContentLayout:null});e.geoObjects.add(t),t.add(geoObjects)}const menu=function(){let e=document.querySelector(".menu-btn"),t=document.querySelector(".header"),n=document.querySelector("body"),i=document.querySelector(".nav__list"),o=!1;function l(){e.classList.toggle("is-active"),t.classList.toggle("is-active"),n.classList.toggle("locked"),o=!o}return document.addEventListener("keydown",function(e){27==e.keyCode&&o&&l()}),{menuOver:function(){e.addEventListener("click",l),i.addEventListener("click",function(e){e.target.classList.contains("nav__link")&&n.offsetWidth<=768&&l()})}}}();menu.menuOver();let OnePageScroll=function(){const e=document,t=e.querySelector(".wrapper"),n=e.querySelector("#content"),i=e.querySelectorAll(".section");let o,l=e.querySelectorAll(".nav__link"),c=e.querySelectorAll(".listing__item"),a=!1;function s(t){if(!a){a=!0;let i=-100*t+"%";n.style.top=i,e.querySelector(".listing__item.is-active").classList.remove("is-active"),c[t].classList.add("is-active"),setTimeout(function(){a=!1},900)}}function r(e){let t=n.style.top?-parseInt(n.style.top,10)/100:0;"up"==e&&t>0&&s(t-1),"down"==e&&t<i.length-1&&s(t+1)}t.addEventListener("wheel",function(e){r(e.deltaY<0?"up":"down")}),t.addEventListener("touchmove",function(e){e.preventDefault()}),t.addEventListener("touchstart",function(e){/Android|AppleWebKit|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&(o=e.touches[0].clientY)},!1),t.addEventListener("touchend",function(e){let t=e.changedTouches[0].clientY-o;if(Math.abs(t)>50){r(t>0?"up":"down")}},!1),l.forEach(function(e){e.addEventListener("click",function(e){e.preventDefault(),s(this.dataset.index)})}),c.forEach(function(e){e.addEventListener("click",function(e){e.preventDefault(),link=e.target,s(link.dataset.index)})}),e.querySelector(".intro-button").addEventListener("click",function(e){e.preventDefault(),s(7)}),e.addEventListener("keyup",function(e){let t;38==e.keyCode&&(t="up"),40==e.keyCode&&(t="down"),r(t)})};OnePageScroll();const overlay=function(){let e=document.querySelector("body"),t=document.querySelector(".modal"),n=document.querySelector(".modal__inner"),i=document.createElement("div");i.classList.add("modal__text");let o=function(){t.classList.remove("is-active"),e.classList.remove("locked")};return{open:function(l,c){let a=document.createElement("button");i.textContent=l,n.innerHTML="",c?(a.classList.add("order-button"),a.textContent="Закрыть"):a.classList.add("modal__close"),n.appendChild(i),n.appendChild(a),t.classList.add("is-active"),e.classList.add("locked"),a.addEventListener("click",e=>{e.preventDefault(),o()}),t.addEventListener("click",e=>{e.target===t&&o()}),document.addEventListener("keydown",e=>{27===e.keyCode&&o()})},close:o}}(),ajaxForm=function(e){let t=new FormData;t.append("name",e.elements.name.value),t.append("phone",e.elements.phone.value),t.append("comment",e.elements.textarea.value),t.append("to","client@mail.ru");const n=new XMLHttpRequest;return n.responseType="json",n.open("POST","https://webdev-api.loftschool.com/sendmail"),n.setRequestHeader("X-Requested-With","XMLHttpRequest"),n.send(t),n},submitForm=function(){let e=document.querySelector("#order-form");if(validateForm(e)){let t=ajaxForm(e);t.addEventListener("load",()=>{let e=!1;if(t.status>=400){let n="Ошибка соединения с сервером, попробуйте позже";overlay.open(`${n}. Ошибка ${t.status}`,e)}else 0==t.response.status?(content=t.response.message,overlay.open(content,e)):(content="Сообщение отправлено",e=!0,overlay.open(content,e))})}};function validateForm(e){let t=!0;return validateField(e.elements.name)||(t=!1),validateField(e.elements.phone)||(t=!1),validateField(e.elements.textarea)||(t=!1),t}function validateField(e){return e.nextElementSibling.textContent=e.validationMessage,e.checkValidity()}let orderBtn=document.querySelector("#send");orderBtn.addEventListener("click",e=>{e.preventDefault(),submitForm()}),function(){const e=document.querySelectorAll(".reviews__item"),t=document.querySelectorAll(".reviews__pix-item");let n=0;for(let i=0;i<e.length;i++)t[i].addEventListener("click",function(o){o.preventDefault(),e[i].classList.toggle("is-active"),t[i].classList.toggle("is-active"),t[n].classList.toggle("is-active"),e[n].classList.toggle("is-active"),n=i})}(),document.addEventListener("DOMContentLoaded",function(){!function(){let e=document.querySelector(".video__content"),t=document.querySelector(".video__btn"),n=document.querySelector(".video__range--volume"),i=document.querySelector(".video__range--progress"),o=document.querySelector(".video__play"),l=!1;function c(){e.play(),l=!0,t.classList.add("hidden"),o.classList.add("stop")}function a(){e.pause(),l=!1,t.classList.remove("hidden"),o.classList.remove("stop")}e.ontimeupdate=function(){!function(){let t=e.duration,n=e.currentTime;i.value=n/t*100}(),e.currentTime==e.duration&&a()},t.addEventListener("click",function(){l||c()}),e.addEventListener("click",function(){l&&a()}),n.addEventListener("input",function(){let t=this.value;e.volume=t/100}),i.addEventListener("click",function(t){let n=i.offsetWidth,o=t.offsetX;i.value=o/n*100,e.pause(),e.currentTime=e.duration*(o/n),e.play()}),o.addEventListener("click",function(){l?l&&(a(),e.currentTime=0):c()})}()},!1);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFjY29yZGVvbi5qcyIsImpxdWVyeVNsaWRlci5qcyIsIm1hcC5qcyIsIm1lbnUuanMiLCJvcHMuanMiLCJyZXF1ZXN0LmpzIiwic2xpZGVzaG93LmpzIiwidmlkZW8uanMiXSwibmFtZXMiOlsidGVhbSIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwicHJldmVudERlZmF1bHQiLCJ0YXJnZXQiLCJjbGFzc0xpc3QiLCJjb250YWlucyIsImxpbmsiLCJhY3RpdmUiLCJzdHlsZSIsImhlaWdodCIsInJlbW92ZSIsImN1cnJlbnQiLCJjbG9zZXN0IiwiYWRkIiwiY3VycmVudFRleHQiLCJzY3JvbGxIZWlnaHQiLCJhY3RpdmF0ZVRlYW0iLCJsaW5rcyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJib2R5IiwiZm9yRWFjaCIsImVsZW0iLCJ0aGlzIiwid2lkdGgiLCJvZmZzZXRXaWR0aCIsImRvY3VtZW50RWxlbWVudCIsImNsaWVudFdpZHRoIiwicmVxV2lkdGgiLCJwYXJzZUZsb2F0IiwiZ2V0Q29tcHV0ZWRTdHlsZSIsImxlbmd0aCIsIndpZHRoQ2FsYyIsImFjdGl2YXRlTWVudSIsIiQiLCJzbGlkZXIiLCJvbiIsImV4aXN0ZWRJdGVtIiwiZWRnZUl0ZW0iLCIkdGhpcyIsIml0ZW1zIiwiZmluZCIsImFjdGl2ZUl0ZW0iLCJmaWx0ZXIiLCJoYXNDbGFzcyIsIm5leHQiLCJmaXJzdCIsInByZXYiLCJsYXN0IiwibnVtIiwicmVxSXRlbSIsImVxIiwicmVxSW5kZXgiLCJpbmRleCIsImxpc3QiLCJhbmltYXRlIiwibGVmdCIsInJlbW92ZUNsYXNzIiwiYWRkQ2xhc3MiLCJtb3ZlU2xpZGUiLCJ5bWFwcyIsInJlYWR5IiwiaW5pdCIsImdlb09iamVjdHMiLCJtYXJrcyIsImxhdGl0dWRlIiwibG9uZ2l0dWRlIiwiaGludENvbnRlbnQiLCJtYXAiLCJNYXAiLCJjZW50ZXIiLCJ6b29tIiwiY29udHJvbHMiLCJiZWhhdmlvcnMiLCJpIiwiUGxhY2VtYXJrIiwiaWNvbkxheW91dCIsImljb25JbWFnZUhyZWYiLCJpY29uSW1hZ2VTaXplIiwiaWNvbkltYWdlT2Zmc2V0IiwiY2x1c3RlcmVyIiwiQ2x1c3RlcmVyIiwiY2x1c3Rlckljb25zIiwiaHJlZiIsInNpemUiLCJvZmZzZXQiLCJjbHVzdGVySWNvbkNvbnRlbnRMYXlvdXQiLCJtZW51IiwiYnV0dG9uIiwiaGVhZGVyIiwibmF2IiwiYWN0IiwidG9nZ2xlTWVudSIsInRvZ2dsZSIsImtleUNvZGUiLCJtZW51T3ZlciIsIk9uZVBhZ2VTY3JvbGwiLCJkIiwid3JhcHBlciIsImNvbnRlbnQiLCJzZWN0aW9ucyIsImNsaWVudFkiLCJtZW51TGlua3MiLCJwb2ludHMiLCJwYXVzZSIsIm1vdmVDb250ZW50IiwicG9zIiwidG9wIiwic2V0VGltZW91dCIsInNjcm9sbCIsIndheSIsImN1cnJlbnRQb3MiLCJwYXJzZUludCIsImRlbHRhWSIsInRlc3QiLCJuYXZpZ2F0b3IiLCJ1c2VyQWdlbnQiLCJ0b3VjaGVzIiwiY2hhbmdlZFRvdWNoZXMiLCJNYXRoIiwiYWJzIiwiZGF0YXNldCIsIm92ZXJsYXkiLCJtb2RhbCIsIm1vZGFsSW5uZXIiLCJtb2RhbFRleHQiLCJjcmVhdGVFbGVtZW50IiwiY2xvc2VPdmVybGF5Iiwib3BlbiIsInJlcGx5IiwidGV4dENvbnRlbnQiLCJpbm5lckhUTUwiLCJhcHBlbmRDaGlsZCIsImNsb3NlIiwiYWpheEZvcm0iLCJmb3JtIiwiZGF0YSIsIkZvcm1EYXRhIiwiYXBwZW5kIiwiZWxlbWVudHMiLCJuYW1lIiwidmFsdWUiLCJwaG9uZSIsInRleHRhcmVhIiwieGhyIiwiWE1MSHR0cFJlcXVlc3QiLCJyZXNwb25zZVR5cGUiLCJzZXRSZXF1ZXN0SGVhZGVyIiwic2VuZCIsInN1Ym1pdEZvcm0iLCJ2YWxpZGF0ZUZvcm0iLCJyZXF1ZXN0Iiwic3RhdHVzIiwicmVzcG9uc2UiLCJtZXNzYWdlIiwidmFsaWQiLCJ2YWxpZGF0ZUZpZWxkIiwiZmllbGQiLCJuZXh0RWxlbWVudFNpYmxpbmciLCJ2YWxpZGF0aW9uTWVzc2FnZSIsImNoZWNrVmFsaWRpdHkiLCJvcmRlckJ0biIsInBpeCIsInZpZGVvIiwicGxheUJ0biIsInZvbHVtZSIsInByb2dyZXNzQmFyIiwic3dpdGNoQnRuIiwicGxheWluZyIsInBsYXkiLCJvbnRpbWV1cGRhdGUiLCJkdXJhdGlvbiIsInRpbWUiLCJjdXJyZW50VGltZSIsInByb2dyZXNzIiwib2Zmc2V0WCIsInZpZGVvUGxheWVyIl0sIm1hcHBpbmdzIjoiQ0FBQSxZQVdBLFdBQ0EsSUFBQUEsRUFBQUMsU0FBQUMsY0FBQSxlQUNBRixFQUFBRyxpQkFBQSxRQUFBLFNBQUFDLEdBRUEsR0FEQUEsRUFBQUMsaUJBQ0FELEVBQUFFLE9BQUFDLFVBQUFDLFNBQUEsZ0JBQUEsQ0FDQSxJQUFBQyxFQUFBTCxFQUFBRSxPQUVBSSxFQUFBVixFQUFBRSxjQUFBLHFCQU9BLEdBTEFRLElBQ0FBLEVBQUFSLGNBQUEsaUJBQ0FTLE1BQUFDLE9BQUEsTUFDQUYsRUFBQUgsVUFBQU0sT0FBQSxlQUVBSCxHQUFBQSxFQUFBUixjQUFBLGtCQUFBTyxFQUFBLENBQ0EsSUFBQUssRUFBQUwsRUFBQU0sUUFBQSxXQUNBRCxFQUFBUCxVQUFBUyxJQUFBLGFBRUEsSUFBQUMsRUFBQUgsRUFBQVosY0FBQSxpQkFDQWUsRUFBQU4sTUFBQUMsT0FBQUssRUFBQUMsYUFBQSxTQUtBQyxHQUVBLFdBQ0EsSUFBQUMsRUFBQW5CLFNBQUFvQixpQkFBQSxnQkFDQUMsRUFBQXJCLFNBQUFDLGNBQUEsUUFDQWtCLEVBQUFHLFFBQUEsU0FBQUMsR0FDQUEsRUFBQXJCLGlCQUFBLFFBQUEsU0FBQUMsR0FDQUEsRUFBQUMsaUJBQ0EsSUFBQUksRUFBQWdCLEtBQ0FmLEVBQUFULFNBQUFDLGNBQUEseUJBUUEsR0FOQVEsSUFDQUEsRUFBQVIsY0FBQSxlQUNBUyxNQUFBZSxNQUFBLE1BQ0FoQixFQUFBSCxVQUFBTSxPQUFBLGVBR0FILEdBQUFBLEVBQUFSLGNBQUEsaUJBQUFP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d0ssR0FBQSxFQVFBLFNBQUFDLElBQ0FOLEVBQUFNLE9BQ0FELEdBQUEsRUFDQUosRUFBQS9KLFVBQUFTLElBQUEsVUFDQXlKLEVBQUFsSyxVQUFBUyxJQUFBLFFBRUEsU0FBQTBGLElBQ0EyRCxFQUFBM0QsUUFDQWdFLEdBQUEsRUFDQUosRUFBQS9KLFVBQUFNLE9BQUEsVUFDQTRKLEVBQUFsSyxVQUFBTSxPQUFBLFFBaEJBd0osRUFBQU8sYUFBQSxZQWtCQSxXQUNBLElBQUFDLEVBQUFSLEVBQUFRLFNBQ0FDLEVBQUFULEVBQUFVLFlBQ0FQLEVBQUF6QixNQUFBK0IsRUFBQUQsRUFBQSxJQXBCQUcsR0FDQVgsRUFBQVUsYUFBQVYsRUFBQVEsVUFDQW5FLEtBcUJBNEQsRUFBQW5LLGlCQUFBLFFBQUEsV0FDQXVLLEdBQ0FDLE1BR0FOLEVBQUFsSyxpQkFBQSxRQUFBLFdBQ0F1SyxHQUNBaEUsTUFHQTZELEVBQUFwSyxpQkFBQSxRQUFBLFdBQ0EsSUFBQTRJLEVBQUF0SCxLQUFBc0gsTUFDQXNCLEVBQUFFLE9BQUF4QixFQUFBLE1BRUF5QixFQUFBckssaUJBQUEsUUFBQSxTQUFBQyxHQUNBLElBQUFzQixFQUFBOEksRUFBQTdJLFlBQ0FpRixFQUFBeEcsRUFBQTZLLFFBQ0FULEVBQUF6QixNQUFBbkMsRUFBQWxGLEVBQUEsSUFDQTJJLEVBQUEzRCxRQUNBMkQsRUFBQVUsWUFBQVYsRUFBQVEsVUFBQWpFLEVBQUFsRixHQUNBMkksRUFBQU0sU0FFQUYsRUFBQXRLLGlCQUFBLFFBQUEsV0FDQXVLLEVBR0FBLElBQ0FoRSxJQUNBMkQsRUFBQVUsWUFBQSxHQUpBSixNQVNBTyxLQUNBIiwiZmlsZSI6InNjcmlwdC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24oKXtcclxuXHJcbiAgZnVuY3Rpb24gd2lkdGhDYWxjKCkge1xyXG4gICAgbGV0IHdpZHRoID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudFdpZHRoO1xyXG4gICAgbGV0IGxpbmtzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLm1lbnVfX2Jsb2NrJyk7XHJcbiAgICBsZXQgbGlua1dpZHRoID0gcGFyc2VGbG9hdChnZXRDb21wdXRlZFN0eWxlKGxpbmtzWzBdKS53aWR0aCk7XHJcblxyXG4gICAgbGV0IHJlcVdpZHRoID0gd2lkdGggLSBsaW5rV2lkdGggKiBsaW5rcy5sZW5ndGg7XHJcbiAgICByZXR1cm4gcmVxV2lkdGggPiA1NTAgPyA1NTAgOiByZXFXaWR0aDtcclxuICB9XHJcbiAgXHJcbiAgZnVuY3Rpb24gYWN0aXZhdGVUZWFtKCkge1xyXG4gICAgbGV0IHRlYW0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudGVhbV9fbGlzdCcpOyAgIFxyXG4gICAgdGVhbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGUpe1xyXG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICBpZihlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ21lbWJlcl9fbGluaycpKXtcclxuICAgICAgICBsZXQgbGluayA9IGUudGFyZ2V0O1xyXG5cclxuICAgICAgICBsZXQgYWN0aXZlID0gdGVhbS5xdWVyeVNlbGVjdG9yKCcubWVtYmVyLmlzLWFjdGl2ZScpO1xyXG5cclxuICAgICAgICBpZihhY3RpdmUpIHtcclxuICAgICAgICAgIGxldCBhY3RpdmVUZXh0ID0gYWN0aXZlLnF1ZXJ5U2VsZWN0b3IoJy5tZW1iZXJfX3RleHQnKTsgICAgICAgICAgXHJcbiAgICAgICAgICBhY3RpdmVUZXh0LnN0eWxlLmhlaWdodCA9ICcwcHgnO1xyXG4gICAgICAgICAgYWN0aXZlLmNsYXNzTGlzdC5yZW1vdmUoJ2lzLWFjdGl2ZScpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZighYWN0aXZlIHx8IGFjdGl2ZS5xdWVyeVNlbGVjdG9yKCcubWVtYmVyX19saW5rJykgIT0gbGluaykge1xyXG4gICAgICAgICAgbGV0IGN1cnJlbnQgID0gbGluay5jbG9zZXN0KCcubWVtYmVyJyk7XHJcbiAgICAgICAgICBjdXJyZW50LmNsYXNzTGlzdC5hZGQoJ2lzLWFjdGl2ZScpO1xyXG5cclxuICAgICAgICAgIGxldCBjdXJyZW50VGV4dCA9IGN1cnJlbnQucXVlcnlTZWxlY3RvcignLm1lbWJlcl9fdGV4dCcpO1xyXG4gICAgICAgICAgY3VycmVudFRleHQuc3R5bGUuaGVpZ2h0ID0gY3VycmVudFRleHQuc2Nyb2xsSGVpZ2h0ICsgJ3B4JztcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0pICAgIFxyXG4gIH1cclxuICBhY3RpdmF0ZVRlYW0oKVxyXG5cclxuICBmdW5jdGlvbiBhY3RpdmF0ZU1lbnUoKSB7XHJcbiAgICBsZXQgbGlua3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcubWVudV9fYmxvY2snKTtcclxuICAgIGxldCBib2R5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignYm9keScpOyAgXHJcbiAgICBsaW5rcy5mb3JFYWNoKGZ1bmN0aW9uKGVsZW0pe1xyXG4gICAgICBlbGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZSl7XHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIGxldCBsaW5rID0gdGhpczsgICAgICAgIFxyXG4gICAgICAgIGxldCBhY3RpdmUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubWVudV9faXRlbS5pcy1hY3RpdmUnKTtcclxuXHJcbiAgICAgICAgaWYoYWN0aXZlKSB7XHJcbiAgICAgICAgICBsZXQgYWN0aXZlVGV4dCA9IGFjdGl2ZS5xdWVyeVNlbGVjdG9yKCcubWVudV9fZGVzYycpOyAgICAgICAgICBcclxuICAgICAgICAgIGFjdGl2ZVRleHQuc3R5bGUud2lkdGggPSAnMHB4JztcclxuICAgICAgICAgIGFjdGl2ZS5jbGFzc0xpc3QucmVtb3ZlKCdpcy1hY3RpdmUnKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmKCFhY3RpdmUgfHwgYWN0aXZlLnF1ZXJ5U2VsZWN0b3IoJy5tZW51X19ibG9jaycpICE9IGxpbmspIHtcclxuICAgICAgICAgIGxldCBjdXJyZW50ICA9IGxpbmsuY2xvc2VzdCgnLm1lbnVfX2l0ZW0nKTtcclxuICAgICAgICAgIGN1cnJlbnQuY2xhc3NMaXN0LmFkZCgnaXMtYWN0aXZlJyk7XHJcblxyXG4gICAgICAgICAgbGV0IGN1cnJlbnRUZXh0ID0gY3VycmVudC5xdWVyeVNlbGVjdG9yKCcubWVudV9fZGVzYycpO1xyXG4gICAgICAgICAgaWYgKGJvZHkub2Zmc2V0V2lkdGggPiA0ODApIHtcclxuICAgICAgICAgIGN1cnJlbnRUZXh0LnN0eWxlLndpZHRoID0gd2lkdGhDYWxjKCkgKyAncHgnO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY3VycmVudFRleHQuc3R5bGUud2lkdGggPSAnYXV0byc7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSAgICAgIFxyXG4gICAgICB9KVxyXG4gICAgfSlcclxuICB9XHJcbiAgYWN0aXZhdGVNZW51KCk7ICBcclxufSgpKTtcclxuXHJcblxyXG4gICIsIiQoZnVuY3Rpb24gKCkge1xyXG4gICAgbGV0IHNsaWRlciA9ICQoJy5jYW5keS1iYXJfX3NsaWRlcicpO1xyXG4gICAgXHJcbiAgbGV0IG1vdmVTbGlkZSA9IGZ1bmN0aW9uKG51bSkge1xyXG4gICAgbGV0IGl0ZW1zID0gc2xpZGVyLmZpbmQoJy5jYW5keS1iYXJfX2l0ZW0nKTtcclxuICAgIGxldCBhY3RpdmVJdGVtID0gaXRlbXMuZmlsdGVyKCcuYWN0aXZlJyk7XHJcbiAgICBsZXQgcmVxSXRlbSA9IGl0ZW1zLmVxKG51bSk7XHJcbiAgICBsZXQgcmVxSW5kZXggPSByZXFJdGVtLmluZGV4KCk7XHJcbiAgICBsZXQgbGlzdCA9IHNsaWRlci5maW5kKCcuY2FuZHktYmFyX19saXN0Jyk7XHJcbiAgICBsZXQgZHVyYXRpb24gPSA1MDA7XHJcbiAgICBpZiAocmVxSXRlbS5sZW5ndGgpIHtcclxuICAgICAgbGlzdC5hbmltYXRlKHtcclxuICAgICAgICAnbGVmdCc6IC1yZXFJbmRleCAqIDEwMCArJyUnXHJcbiAgICAgIH0sIGR1cmF0aW9uLCBmdW5jdGlvbigpIHtcclxuICAgICAgICBhY3RpdmVJdGVtLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgICByZXFJdGVtLmFkZENsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgfSlcclxuICAgIH1cclxuICB9XHJcbiAgXHJcbiAgJCgnLnNjcm9sbC1idG4nKS5vbignY2xpY2snLCBmdW5jdGlvbihlKSB7XHJcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICBsZXQgJHRoaXMgPSAkKHRoaXMpO1xyXG4gICAgbGV0IGl0ZW1zID0gc2xpZGVyLmZpbmQoJy5jYW5keS1iYXJfX2l0ZW0nKTtcclxuICAgIGxldCBhY3RpdmVJdGVtID0gaXRlbXMuZmlsdGVyKCcuYWN0aXZlJyk7XHJcbiAgICBsZXQgZXhpc3RlZEl0ZW07XHJcbiAgICBsZXQgZWRnZUl0ZW07XHJcblxyXG4gICAgaWYgKCR0aGlzLmhhc0NsYXNzKCdzY3JvbGwtYnRuLS1mb3J3YXJkJykpIHtcclxuICAgICAgZXhpc3RlZEl0ZW0gPSBhY3RpdmVJdGVtLm5leHQoKTtcclxuICAgICAgZWRnZUl0ZW0gPSBpdGVtcy5maXJzdCgpOyAgICAgXHJcbiAgICB9IFxyXG4gICAgaWYgKCR0aGlzLmhhc0NsYXNzKCdzY3JvbGwtYnRuLS1iYWNrJykpIHtcclxuICAgICAgZXhpc3RlZEl0ZW0gPSBhY3RpdmVJdGVtLnByZXYoKTtcclxuICAgICAgZWRnZUl0ZW0gPSBpdGVtcy5sYXN0KCk7ICAgICAgXHJcbiAgICB9XHJcblxyXG4gICAgbGV0IHJlcUl0ZW0gPSBleGlzdGVkSXRlbS5sZW5ndGggPyBleGlzdGVkSXRlbS5pbmRleCgpIDogZWRnZUl0ZW0uaW5kZXgoKTtcclxuICAgIG1vdmVTbGlkZShyZXFJdGVtKTtcclxuICAgIH0pXHJcbn0pIiwieW1hcHMucmVhZHkoaW5pdCk7XHJcbiAgdmFyIGdlb09iamVjdHM9IFtdO1xyXG4gIHZhciBtYXJrcyA9IFtcclxuICAgIHtcclxuICAgICAgbGF0aXR1ZGU6IDU1Ljc1ODcsXHJcbiAgICAgIGxvbmdpdHVkZTogMzcuNTgyOCxcclxuICAgICAgaGludENvbnRlbnQ6ICc8ZGl2IGNsYXNzPVwibWFwX19oaW50XCI+0JrRg9C00YDQuNC90YHQutCw0Y8g0L/Qu9C+0YnQsNC00Ywg0LQuMTwvZGl2PicsXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICBsYXRpdHVkZTogNTUuNzQyNyxcclxuICAgICAgbG9uZ2l0dWRlOiAzNy41Nzk5LFxyXG4gICAgICBoaW50Q29udGVudDogJzxkaXYgY2xhc3M9XCJtYXBfX2hpbnRcIj7Rg9C7LtCf0LvRjtGJ0LjRhdCwINC0LjExPC9kaXY+JyxcclxuICAgIH0sXHJcbiAgICB7XHJcbiAgICAgIGxhdGl0dWRlOiA1NS43NTc0LFxyXG4gICAgICBsb25naXR1ZGU6IDM3LjYyMDgsXHJcbiAgICAgIGhpbnRDb250ZW50OiAnPGRpdiBjbGFzcz1cIm1hcF9faGludFwiPtCf0LvQvtGJ0LDQtNGMINCg0LXQstC+0LvRjtGG0LjQuCDQtC4xPC9kaXY+JyxcclxuICAgIH0sXHJcbiAgICB7XHJcbiAgICAgIGxhdGl0dWRlOiA1NS43NTAwLFxyXG4gICAgICBsb25naXR1ZGU6IDM3LjYwMzcsXHJcbiAgICAgIGhpbnRDb250ZW50OiAnPGRpdiBjbGFzcz1cIm1hcF9faGludFwiPtCR0L7Qu9GM0YjQvtC5INCX0L3QsNC80LXQvdGB0LrQuNC5INC/0LXRgC4g0LQuMjM8L2Rpdj4nLFxyXG4gICAgfVxyXG4gIF1cclxuXHJcbmZ1bmN0aW9uIGluaXQoKSB7XHJcbiAgdmFyIG1hcCA9IG5ldyB5bWFwcy5NYXAoJ21hcCcsIHtcclxuICAgIGNlbnRlcjogWzU1Ljc1MjY5NjU2LCAzNy41OTQyNzA4M10sXHJcbiAgICB6b29tOiAxNCxcclxuICAgIGNvbnRyb2xzOiBbJ3pvb21Db250cm9sJ10sXHJcbiAgICBiZWhhdmlvcnM6IFsnZHJhZyddXHJcbiAgfSk7XHJcbiAgZm9yIChsZXQgaT0wOyBpPG1hcmtzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICBnZW9PYmplY3RzW2ldID0gbmV3IHltYXBzLlBsYWNlbWFyayhbbWFya3NbaV0ubGF0aXR1ZGUsIG1hcmtzW2ldLmxvbmdpdHVkZV0sXHJcbiAgICAgIHtcclxuICAgICAgICBoaW50Q29udGVudDogbWFya3NbaV0uaGludENvbnRlbnRcclxuICAgICAgfSxcclxuICAgICAge1xyXG4gICAgICAgIGljb25MYXlvdXQ6ICdkZWZhdWx0I2ltYWdlJyxcclxuICAgICAgICBpY29uSW1hZ2VIcmVmOiAnaHR0cHM6Ly92YWRpbWJlY2suZ2l0aHViLmlvL3dlYi9pbWcvbWFya2VyLnBuZycsXHJcbiAgICAgICAgaWNvbkltYWdlU2l6ZTogWzQ2LCA1N10sXHJcbiAgICAgICAgaWNvbkltYWdlT2Zmc2V0OiBbLTIzLCAtNTddXHJcbiAgICAgIH0pO1xyXG4gIH1cclxuICB2YXIgY2x1c3RlcmVyID0gbmV3IHltYXBzLkNsdXN0ZXJlcih7XHJcbiAgICBjbHVzdGVySWNvbnM6IFtcclxuICAgICAge1xyXG4gICAgICAgIGhyZWY6ICdodHRwczovL3ZhZGltYmVjay5naXRodWIuaW8vd2ViL2ltZy9tYXJrZXIucG5nJyxcclxuICAgICAgICBzaXplOiBbNDYsIDU3XSxcclxuICAgICAgICBvZmZzZXQ6IFstMjMsIC01N11cclxuICAgICAgfVxyXG4gICAgXSxcclxuICAgIGNsdXN0ZXJJY29uQ29udGVudExheW91dDogbnVsbFxyXG4gIH0pO1xyXG4gIG1hcC5nZW9PYmplY3RzLmFkZChjbHVzdGVyZXIpO1xyXG4gIGNsdXN0ZXJlci5hZGQoZ2VvT2JqZWN0cyk7XHJcbn0iLCJjb25zdCBtZW51ID0gKGZ1bmN0aW9uKCkge1xyXG4gIGxldCBidXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubWVudS1idG4nKTtcclxuICBsZXQgaGVhZGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmhlYWRlcicpO1xyXG4gIGxldCBib2R5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignYm9keScpO1xyXG4gIGxldCBuYXYgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubmF2X19saXN0Jyk7XHJcbiAgbGV0IGFjdCA9IGZhbHNlO1xyXG5cclxuICBmdW5jdGlvbiB0b2dnbGVNZW51KCkge1xyXG4gICAgICBidXR0b24uY2xhc3NMaXN0LnRvZ2dsZSgnaXMtYWN0aXZlJyk7XHJcbiAgICAgIGhlYWRlci5jbGFzc0xpc3QudG9nZ2xlKCdpcy1hY3RpdmUnKTtcclxuICAgICAgYm9keS5jbGFzc0xpc3QudG9nZ2xlKCdsb2NrZWQnKTtcclxuXHJcbiAgICAgIGFjdCA/IGFjdCA9IGZhbHNlIDogYWN0ID0gdHJ1ZTtcclxuICB9XHJcblxyXG4gIGxldCBhZGRMaXN0ZW5lcnMgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0b2dnbGVNZW51KTtcclxuXHJcbiAgICAgICAgbmF2LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZSl7XHJcbiAgICAgICAgICBsZXQgdGFyZ2V0ID0gZS50YXJnZXQ7XHJcbiAgICAgICAgICBpZiAodGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnbmF2X19saW5rJykgJiYgYm9keS5vZmZzZXRXaWR0aCA8PSA3NjgpIHtcclxuICAgICAgICAgICAgdG9nZ2xlTWVudSgpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBmdW5jdGlvbihlKXtcclxuICAgICAgICBpZiAoZS5rZXlDb2RlID09IDI3ICYmIGFjdCkge1xyXG4gICAgICAgICAgdG9nZ2xlTWVudSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSlcclxuICByZXR1cm4ge1xyXG4gICAgbWVudU92ZXI6IGFkZExpc3RlbmVycyAgXHJcbiAgfVxyXG59KCkpO1xyXG5tZW51Lm1lbnVPdmVyKCk7IiwibGV0IE9uZVBhZ2VTY3JvbGwgPSBmdW5jdGlvbigpe1xyXG4gIGNvbnN0IGQgPSBkb2N1bWVudDtcclxuICBjb25zdCB3cmFwcGVyID0gZC5xdWVyeVNlbGVjdG9yKCcud3JhcHBlcicpO1xyXG4gIGNvbnN0IGNvbnRlbnQgPSBkLnF1ZXJ5U2VsZWN0b3IoJyNjb250ZW50Jyk7XHJcbiAgY29uc3Qgc2VjdGlvbnMgPSBkLnF1ZXJ5U2VsZWN0b3JBbGwoJy5zZWN0aW9uJyk7XHJcbiAgbGV0IG1lbnVMaW5rcyA9IGQucXVlcnlTZWxlY3RvckFsbCgnLm5hdl9fbGluaycpOyAgXHJcbiAgbGV0IHBvaW50cyA9IGQucXVlcnlTZWxlY3RvckFsbCgnLmxpc3RpbmdfX2l0ZW0nKTtcclxuICBsZXQgcGF1c2UgPSBmYWxzZTtcclxuICBsZXQgY2xpZW50WTtcclxuICBcclxuICBmdW5jdGlvbiBtb3ZlQ29udGVudChpbmRleCkge1xyXG4gICAgaWYgKCFwYXVzZSkge1xyXG4gICAgICBwYXVzZSA9IHRydWU7XHJcbiAgICBsZXQgcG9zID0gaW5kZXggKiAtMTAwICsgJyUnO1xyXG4gICAgY29udGVudC5zdHlsZS50b3AgPSBwb3M7XHJcblxyXG4gICAgbGV0IGFjdGl2ZSA9IGQucXVlcnlTZWxlY3RvcignLmxpc3RpbmdfX2l0ZW0uaXMtYWN0aXZlJyk7XHJcbiAgICBhY3RpdmUuY2xhc3NMaXN0LnJlbW92ZSgnaXMtYWN0aXZlJyk7XHJcbiAgICBwb2ludHNbaW5kZXhdLmNsYXNzTGlzdC5hZGQoJ2lzLWFjdGl2ZScpO1xyXG5cclxuICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHsgICAgICAgIFxyXG4gICAgICAgIHBhdXNlID0gZmFsc2U7XHJcbiAgICAgIH0sIDkwMClcclxuICAgIH0gICBcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIHNjcm9sbCh3YXkpIHtcclxuICAgIGxldCBjdXJyZW50UG9zID0gIWNvbnRlbnQuc3R5bGUudG9wID8gMCA6IC1wYXJzZUludChjb250ZW50LnN0eWxlLnRvcCwgMTApLzEwMDtcclxuICAgIGlmICh3YXkgPT0gJ3VwJyAmJiBjdXJyZW50UG9zID4gMCkgeyAgICAgIFxyXG4gICAgICBtb3ZlQ29udGVudChjdXJyZW50UG9zLTEpO1xyXG4gICAgfVxyXG4gICAgaWYod2F5ID09ICdkb3duJyAmJiBjdXJyZW50UG9zIDwgc2VjdGlvbnMubGVuZ3RoLTEpIHtcclxuICAgICAgbW92ZUNvbnRlbnQoY3VycmVudFBvcysxKTtcclxuICAgIH0gXHJcbiAgfVxyXG5cclxuICB3cmFwcGVyLmFkZEV2ZW50TGlzdGVuZXIoJ3doZWVsJywgZnVuY3Rpb24oZSkge1xyXG4gICAgbGV0IHdheSA9IGUuZGVsdGFZIDwgMCA/ICd1cCcgOiAnZG93bic7XHJcbiAgICBzY3JvbGwod2F5KTtcclxuICB9KVxyXG4gIHdyYXBwZXIuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2htb3ZlJywgZnVuY3Rpb24oZSkge1xyXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gIH0pXHJcblxyXG4gIHdyYXBwZXIuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hzdGFydCcsIGZ1bmN0aW9uKGUpIHtcclxuICAgIGlmICgvQW5kcm9pZHxBcHBsZVdlYktpdHx3ZWJPU3xpUGhvbmV8aVBhZHxpUG9kfEJsYWNrQmVycnl8SUVNb2JpbGV8T3BlcmEgTWluaS9pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCkpIHtcclxuICAgICAgY2xpZW50WSA9IGUudG91Y2hlc1swXS5jbGllbnRZO1xyXG4gICAgfVxyXG4gIH0sIGZhbHNlKTtcclxuXHJcbiAgd3JhcHBlci5hZGRFdmVudExpc3RlbmVyKCd0b3VjaGVuZCcsIGZ1bmN0aW9uKGUpIHsgICAgICBcclxuICAgICAgbGV0IGRlbHRhWSA9IGUuY2hhbmdlZFRvdWNoZXNbMF0uY2xpZW50WSAtIGNsaWVudFk7XHJcbiAgICAgIGlmIChNYXRoLmFicyhkZWx0YVkpPjUwKXtcclxuICAgICAgICBsZXQgd2F5ID0gZGVsdGFZID4gMCA/ICd1cCcgOiAnZG93bic7XHJcbiAgICAgICAgc2Nyb2xsKHdheSk7XHJcbiAgICAgIH1cclxuICB9LCBmYWxzZSk7XHJcblxyXG4gIG1lbnVMaW5rcy5mb3JFYWNoKGZ1bmN0aW9uKGVsZW0pIHsgICAgXHJcbiAgICBlbGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZSl7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgbGV0IGluZGV4ID0gdGhpcy5kYXRhc2V0LmluZGV4OyAgICAgICAgXHJcbiAgICAgIG1vdmVDb250ZW50KGluZGV4KTtcclxuICAgIH0pICAgICAgXHJcbiAgfSlcclxuXHJcbiAgcG9pbnRzLmZvckVhY2goZnVuY3Rpb24oZWxlbSkge1xyXG4gICAgZWxlbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGUpe1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIGxpbmsgPSBlLnRhcmdldDtcclxuICAgICAgbGV0IGluZGV4ID0gbGluay5kYXRhc2V0LmluZGV4O1xyXG4gICAgICBtb3ZlQ29udGVudChpbmRleCk7XHJcbiAgICB9KVxyXG4gIH0pXHJcblxyXG4gIGxldCBidXR0b24gPSBkLnF1ZXJ5U2VsZWN0b3IoJy5pbnRyby1idXR0b24nKTtcclxuICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihlKSB7XHJcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICBtb3ZlQ29udGVudCg3KTtcclxuICB9KVxyXG5cclxuICBkLmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywgZnVuY3Rpb24oZSkge1xyXG4gICAgbGV0IHdheTtcclxuICAgIGlmIChlLmtleUNvZGUgPT0gMzgpIHtcclxuICAgICAgd2F5ID0gJ3VwJztcclxuICAgIH1cclxuICAgIGlmIChlLmtleUNvZGUgPT0gNDApIHtcclxuICAgICAgd2F5ID0gJ2Rvd24nO1xyXG4gICAgIH1cclxuICAgICBzY3JvbGwod2F5KTtcclxuICB9KVxyXG59XHJcbk9uZVBhZ2VTY3JvbGwoKTsiLCJjb25zdCBvdmVybGF5ID0gKGZ1bmN0aW9uKCl7XHJcbiAgbGV0IGJvZHkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdib2R5Jyk7XHJcbiAgbGV0IG1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsJyk7XHJcbiAgbGV0IG1vZGFsSW5uZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2lubmVyJyk7ICBcclxuXHJcbiAgbGV0IG1vZGFsVGV4dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gIG1vZGFsVGV4dC5jbGFzc0xpc3QuYWRkKCdtb2RhbF9fdGV4dCcpOyAgXHJcblxyXG4gIGxldCBvcGVuT3ZlcmxheSA9IGZ1bmN0aW9uKGNvbnRlbnQsIHJlcGx5KSB7XHJcbiAgICBsZXQgYnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XHJcbiAgICBtb2RhbFRleHQudGV4dENvbnRlbnQgPSBjb250ZW50O1xyXG4gICAgbW9kYWxJbm5lci5pbm5lckhUTUwgPSBcIlwiO1xyXG4gICAgaWYocmVwbHkpIHtcclxuICAgICAgYnV0dG9uLmNsYXNzTGlzdC5hZGQoJ29yZGVyLWJ1dHRvbicpO1xyXG4gICAgICBidXR0b24udGV4dENvbnRlbnQgPSAn0JfQsNC60YDRi9GC0YwnO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgYnV0dG9uLmNsYXNzTGlzdC5hZGQoJ21vZGFsX19jbG9zZScpO1xyXG4gICAgfVxyXG4gICAgbW9kYWxJbm5lci5hcHBlbmRDaGlsZChtb2RhbFRleHQpO1xyXG4gICAgbW9kYWxJbm5lci5hcHBlbmRDaGlsZChidXR0b24pO1xyXG5cclxuICAgIG1vZGFsLmNsYXNzTGlzdC5hZGQoJ2lzLWFjdGl2ZScpO1xyXG4gICAgYm9keS5jbGFzc0xpc3QuYWRkKCdsb2NrZWQnKTtcclxuXHJcbiAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIGNsb3NlT3ZlcmxheSgpO1xyXG4gICAgfSlcclxuXHJcbiAgICBtb2RhbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XHJcbiAgICAgIGlmIChlLnRhcmdldCA9PT0gbW9kYWwpIHtcclxuICAgICAgICBjbG9zZU92ZXJsYXkoKTtcclxuICAgICAgfVxyXG4gICAgfSlcclxuXHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgKGUpID0+IHtcclxuICAgICAgaWYgKGUua2V5Q29kZSA9PT0gMjcpIFxyXG4gICAgICAgIGNsb3NlT3ZlcmxheSgpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBsZXQgY2xvc2VPdmVybGF5ID0gZnVuY3Rpb24oKSB7XHJcbiAgICBtb2RhbC5jbGFzc0xpc3QucmVtb3ZlKCdpcy1hY3RpdmUnKTtcclxuICAgIGJvZHkuY2xhc3NMaXN0LnJlbW92ZSgnbG9ja2VkJyk7XHJcbiAgfVxyXG5cclxuICByZXR1cm4ge1xyXG4gICAgb3Blbjogb3Blbk92ZXJsYXksXHJcbiAgICBjbG9zZTogY2xvc2VPdmVybGF5XHJcbiAgfTtcclxufSgpKTtcclxuXHJcbmNvbnN0IGFqYXhGb3JtID0gZnVuY3Rpb24oZm9ybSkge1xyXG4gXHJcbiAgbGV0IGRhdGEgPSBuZXcgRm9ybURhdGEoKTtcclxuICAgIGRhdGEuYXBwZW5kKFwibmFtZVwiLCBmb3JtLmVsZW1lbnRzLm5hbWUudmFsdWUpO1xyXG4gICAgZGF0YS5hcHBlbmQoXCJwaG9uZVwiLCBmb3JtLmVsZW1lbnRzLnBob25lLnZhbHVlKTtcclxuICAgIGRhdGEuYXBwZW5kKFwiY29tbWVudFwiLCBmb3JtLmVsZW1lbnRzLnRleHRhcmVhLnZhbHVlKTtcclxuICAgIGRhdGEuYXBwZW5kKFwidG9cIiwgXCJjbGllbnRAbWFpbC5ydVwiKTtcclxuICBcclxuICAgIGNvbnN0IHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xyXG4gICAgeGhyLnJlc3BvbnNlVHlwZSA9ICdqc29uJztcclxuICAgIHhoci5vcGVuKCdQT1NUJywnaHR0cHM6Ly93ZWJkZXYtYXBpLmxvZnRzY2hvb2wuY29tL3NlbmRtYWlsJyk7XHJcbiAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcihcIlgtUmVxdWVzdGVkLVdpdGhcIiwgXCJYTUxIdHRwUmVxdWVzdFwiKTtcclxuICAgIHhoci5zZW5kKGRhdGEpO1xyXG5cclxuICAgIHJldHVybiB4aHI7XHJcbiAgXHJcbn1cclxuXHJcbmNvbnN0IHN1Ym1pdEZvcm0gPSBmdW5jdGlvbigpIHsgIFxyXG4gIGxldCBmb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI29yZGVyLWZvcm0nKTtcclxuICBpZiAodmFsaWRhdGVGb3JtKGZvcm0pKSB7XHJcbiAgICBcclxuICBsZXQgcmVxdWVzdCA9IGFqYXhGb3JtKGZvcm0pOyAgXHJcbiAgICByZXF1ZXN0LmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCAoKT0+IHtcclxuICAgICAgbGV0IHJlcGx5ID0gZmFsc2U7XHJcbiAgICAgIGlmIChyZXF1ZXN0LnN0YXR1cyA+PTQwMCkge1xyXG4gICAgICAgIGxldCBjb250ZW50ID0gJ9Ce0YjQuNCx0LrQsCDRgdC+0LXQtNC40L3QtdC90LjRjyDRgSDRgdC10YDQstC10YDQvtC8LCDQv9C+0L/RgNC+0LHRg9C50YLQtSDQv9C+0LfQttC1JztcclxuICAgICAgICBvdmVybGF5Lm9wZW4oYCR7Y29udGVudH0uINCe0YjQuNCx0LrQsCAke3JlcXVlc3Quc3RhdHVzfWAsIHJlcGx5KTtcclxuICAgICAgfSBlbHNlIGlmIChyZXF1ZXN0LnJlc3BvbnNlLnN0YXR1cyA9PSAwKSB7XHJcbiAgICAgICAgY29udGVudCA9IHJlcXVlc3QucmVzcG9uc2UubWVzc2FnZTtcclxuICAgICAgICBvdmVybGF5Lm9wZW4oY29udGVudCwgcmVwbHkpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGNvbnRlbnQgPSAn0KHQvtC+0LHRidC10L3QuNC1INC+0YLQv9GA0LDQstC70LXQvdC+JztcclxuICAgICAgICByZXBseSA9IHRydWU7XHJcbiAgICAgICAgb3ZlcmxheS5vcGVuKGNvbnRlbnQsIHJlcGx5KTtcclxuICAgICAgfVxyXG4gICAgfSlcclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHZhbGlkYXRlRm9ybShmb3JtKSB7XHJcbiAgbGV0IHZhbGlkID0gdHJ1ZTtcclxuICBpZighdmFsaWRhdGVGaWVsZChmb3JtLmVsZW1lbnRzLm5hbWUpKSB7XHJcbiAgICB2YWxpZCA9IGZhbHNlO1xyXG4gIH1cclxuICBpZighdmFsaWRhdGVGaWVsZChmb3JtLmVsZW1lbnRzLnBob25lKSkge1xyXG4gICAgdmFsaWQgPSBmYWxzZTtcclxuICB9XHJcbiAgaWYoIXZhbGlkYXRlRmllbGQoZm9ybS5lbGVtZW50cy50ZXh0YXJlYSkpIHtcclxuICAgIHZhbGlkID0gZmFsc2U7XHJcbiAgfVxyXG4gIHJldHVybiB2YWxpZDtcclxufVxyXG5mdW5jdGlvbiB2YWxpZGF0ZUZpZWxkKGZpZWxkKSB7XHJcbiAgZmllbGQubmV4dEVsZW1lbnRTaWJsaW5nLnRleHRDb250ZW50ID0gZmllbGQudmFsaWRhdGlvbk1lc3NhZ2U7XHJcbiAgcmV0dXJuIGZpZWxkLmNoZWNrVmFsaWRpdHkoKTtcclxufVxyXG5cclxubGV0IG9yZGVyQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3NlbmQnKTtcclxub3JkZXJCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBlID0+IHtcclxuICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgc3VibWl0Rm9ybSgpO1xyXG59KTsiLCIoZnVuY3Rpb24oKXtcclxuICBjb25zdCBpdGVtcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5yZXZpZXdzX19pdGVtJyk7XHJcbiAgY29uc3QgcGl4ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnJldmlld3NfX3BpeC1pdGVtJyk7XHJcbiAgbGV0IGFjdGl2ZSA9IDA7XHJcblxyXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgaXRlbXMubGVuZ3RoOyBpKyspIHtcclxuICAgIHBpeFtpXS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICBpdGVtc1tpXS5jbGFzc0xpc3QudG9nZ2xlKCdpcy1hY3RpdmUnKTtcclxuICAgICAgcGl4W2ldLmNsYXNzTGlzdC50b2dnbGUoJ2lzLWFjdGl2ZScpO1xyXG4gICAgIFxyXG4gICAgICBwaXhbYWN0aXZlXS5jbGFzc0xpc3QudG9nZ2xlKCdpcy1hY3RpdmUnKTtcclxuICAgICAgaXRlbXNbYWN0aXZlXS5jbGFzc0xpc3QudG9nZ2xlKCdpcy1hY3RpdmUnKTtcclxuICAgICAgYWN0aXZlID0gaTsgICAgIFxyXG4gICAgfSlcclxuICB9XHJcbn0oKSk7IiwiZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKCkge1xyXG4gIGxldCB2aWRlb1BsYXllciA9IGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgbGV0IHZpZGVvID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnZpZGVvX19jb250ZW50Jyk7XHJcbiAgICBsZXQgcGxheUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy52aWRlb19fYnRuJyk7XHJcbiAgICBsZXQgdm9sdW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnZpZGVvX19yYW5nZS0tdm9sdW1lJyk7XHJcbiAgICBsZXQgcHJvZ3Jlc3NCYXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudmlkZW9fX3JhbmdlLS1wcm9ncmVzcycpO1xyXG4gICAgbGV0IHN3aXRjaEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy52aWRlb19fcGxheScpO1xyXG4gICAgbGV0IHBsYXlpbmcgPSBmYWxzZTtcclxuICBcclxuICAgIHZpZGVvLm9udGltZXVwZGF0ZSA9IGZ1bmN0aW9uKCl7XHJcbiAgICAgIHByb2dyZXNzKCk7XHJcbiAgICAgIGlmKHZpZGVvLmN1cnJlbnRUaW1lID09IHZpZGVvLmR1cmF0aW9uKXtcclxuICAgICAgICBwYXVzZSgpO1xyXG4gICAgICB9XHJcbiAgICB9IFxyXG4gICAgZnVuY3Rpb24gcGxheSgpIHtcclxuICAgICAgdmlkZW8ucGxheSgpO1xyXG4gICAgICBwbGF5aW5nID0gdHJ1ZTtcclxuICAgICAgcGxheUJ0bi5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKTtcclxuICAgICAgc3dpdGNoQnRuLmNsYXNzTGlzdC5hZGQoJ3N0b3AnKTtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIHBhdXNlKCkge1xyXG4gICAgICB2aWRlby5wYXVzZSgpO1xyXG4gICAgICBwbGF5aW5nID0gZmFsc2U7XHJcbiAgICAgIHBsYXlCdG4uY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7XHJcbiAgICAgIHN3aXRjaEJ0bi5jbGFzc0xpc3QucmVtb3ZlKCdzdG9wJyk7XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBwcm9ncmVzcygpe1xyXG4gICAgICBsZXQgZHVyYXRpb24gPSB2aWRlby5kdXJhdGlvbjtcclxuICAgICAgbGV0IHRpbWUgPSB2aWRlby5jdXJyZW50VGltZTtcclxuICAgICAgcHJvZ3Jlc3NCYXIudmFsdWUgPSAodGltZS9kdXJhdGlvbikqMTAwO1xyXG4gICAgfVxyXG4gIFxyXG4gICAgcGxheUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCl7XHJcbiAgICAgIGlmKCFwbGF5aW5nKSB7XHJcbiAgICAgICAgcGxheSgpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICAgIHZpZGVvLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oKXtcclxuICAgICAgICBpZihwbGF5aW5nKSB7XHJcbiAgICAgICAgICBwYXVzZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgdm9sdW1lLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgZnVuY3Rpb24oKXtcclxuICAgICAgbGV0IHZhbHVlID0gdGhpcy52YWx1ZTtcclxuICAgICAgdmlkZW8udm9sdW1lID0gdmFsdWUvMTAwO1xyXG4gICAgfSlcclxuICAgIHByb2dyZXNzQmFyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICBsZXQgd2lkdGggPSBwcm9ncmVzc0Jhci5vZmZzZXRXaWR0aDtcclxuICAgICAgbGV0IHBvcyA9IGUub2Zmc2V0WDtcclxuICAgICAgcHJvZ3Jlc3NCYXIudmFsdWUgPSAocG9zL3dpZHRoKSoxMDA7XHJcbiAgICAgIHZpZGVvLnBhdXNlKCk7XHJcbiAgICAgIHZpZGVvLmN1cnJlbnRUaW1lID0gdmlkZW8uZHVyYXRpb24qKHBvcy93aWR0aCk7XHJcbiAgICAgIHZpZGVvLnBsYXkoKTtcclxuICAgIH0pXHJcbiAgICBzd2l0Y2hCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLGZ1bmN0aW9uKCl7XHJcbiAgICAgIGlmKCFwbGF5aW5nKSB7XHJcbiAgICAgICAgcGxheSgpO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2UgaWYocGxheWluZykge1xyXG4gICAgICAgIHBhdXNlKCk7XHJcbiAgICAgICAgdmlkZW8uY3VycmVudFRpbWUgPSAwO1xyXG4gICAgICB9XHJcbiAgICB9KVxyXG4gIFxyXG4gIH1cclxuICB2aWRlb1BsYXllcigpO1xyXG59LCBmYWxzZSk7XHJcbiJdfQ==
