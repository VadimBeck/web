!function(){!function(){let e=document.querySelector(".team__list");e.addEventListener("click",function(t){if(t.preventDefault(),t.target.classList.contains("member__link")){let n=t.target,i=e.querySelector(".member.is-active");if(i&&(i.querySelector(".member__text").style.height="0px",i.classList.remove("is-active")),!i||i.querySelector(".member__link")!=n){let e=n.closest(".member");e.classList.add("is-active");let t=e.querySelector(".member__text");t.style.height=t.scrollHeight+"px"}}})}(),function(){let e=document.querySelectorAll(".menu__block"),t=document.querySelector("body");e.forEach(function(e){e.addEventListener("click",function(e){e.preventDefault();let n=this,i=document.querySelector(".menu__item.is-active");if(i&&(i.querySelector(".menu__desc").style.width="0px",i.classList.remove("is-active")),!i||i.querySelector(".menu__block")!=n){let e=n.closest(".menu__item");e.classList.add("is-active");let i=e.querySelector(".menu__desc");t.offsetWidth>480?i.style.width=function(){let e=document.documentElement.clientWidth,t=document.querySelectorAll(".menu__block"),n=e-parseFloat(getComputedStyle(t[0]).width)*t.length;return n>550?550:n}()+"px":i.style.width="auto"}})})}()}(),$(function(){let e=$(".candy-bar__slider");$(".scroll-btn").on("click",function(t){t.preventDefault();let n,i,o=$(this),l=e.find(".candy-bar__item"),c=l.filter(".active");o.hasClass("scroll-btn--forward")&&(n=c.next(),i=l.first()),o.hasClass("scroll-btn--back")&&(n=c.prev(),i=l.last()),function(t){let n=e.find(".candy-bar__item"),i=n.filter(".active"),o=n.eq(t),l=o.index(),c=e.find(".candy-bar__list");o.length&&c.animate({left:100*-l+"%"},500,function(){i.removeClass("active"),o.addClass("active")})}(n.length?n.index():i.index())})}),ymaps.ready(init);var geoObjects=[],marks=[{latitude:55.7587,longitude:37.5828,hintContent:'<div class="map__hint">Кудринская площадь д.1</div>'},{latitude:55.7427,longitude:37.5799,hintContent:'<div class="map__hint">ул.Плющиха д.11</div>'},{latitude:55.7574,longitude:37.6208,hintContent:'<div class="map__hint">Площадь Революции д.1</div>'},{latitude:55.75,longitude:37.6037,hintContent:'<div class="map__hint">Большой Знаменский пер. д.23</div>'}];function init(){var e=new ymaps.Map("map",{center:[55.75269656,37.59427083],zoom:14,controls:["zoomControl"],behaviors:["drag"]});for(let e=0;e<marks.length;e++)geoObjects[e]=new ymaps.Placemark([marks[e].latitude,marks[e].longitude],{hintContent:marks[e].hintContent},{iconLayout:"default#image",iconImageHref:"../img/map-marker.png",iconImageSize:[46,57],iconImageOffset:[-23,-57]});var t=new ymaps.Clusterer({clusterIcons:[{href:"../img/map-marker.png",size:[46,57],offset:[-23,-57]}],clusterIconContentLayout:null});e.geoObjects.add(t),t.add(geoObjects)}const menu=function(){let e=document.querySelector(".menu-btn"),t=document.querySelector(".header"),n=document.querySelector("body"),i=document.querySelector(".nav__list"),o=!1;function l(){e.classList.toggle("is-active"),t.classList.toggle("is-active"),n.classList.toggle("locked"),o=!o}return document.addEventListener("keydown",function(e){27==e.keyCode&&o&&l()}),{menuOver:function(){e.addEventListener("click",l),i.addEventListener("click",function(e){e.target.classList.contains("nav__link")&&n.offsetWidth<=768&&l()})}}}();menu.menuOver();let OnePageScroll=function(){const e=document,t=e.querySelector(".wrapper"),n=e.querySelector("#content"),i=e.querySelectorAll(".section");let o,l=e.querySelectorAll(".nav__link"),c=e.querySelectorAll(".listing__item"),a=!1;function s(t){if(!a){a=!0;let i=-100*t+"%";n.style.top=i,e.querySelector(".listing__item.is-active").classList.remove("is-active"),c[t].classList.add("is-active"),setTimeout(function(){a=!1},900)}}function r(e){let t=n.style.top?-parseInt(n.style.top,10)/100:0;"up"==e&&t>0&&s(t-1),"down"==e&&t<i.length-1&&s(t+1)}t.addEventListener("wheel",function(e){r(e.deltaY<0?"up":"down")}),t.addEventListener("touchmove",function(e){e.preventDefault()}),t.addEventListener("touchstart",function(e){/Android|AppleWebKit|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&(o=e.touches[0].clientY)},!1),t.addEventListener("touchend",function(e){r(e.changedTouches[0].clientY-o>0?"up":"down")},!1),l.forEach(function(e){e.addEventListener("click",function(e){e.preventDefault(),s(this.dataset.index)})}),c.forEach(function(e){e.addEventListener("click",function(e){e.preventDefault(),link=e.target,s(link.dataset.index)})}),e.querySelector(".intro-button").addEventListener("click",function(e){e.preventDefault(),s(7)}),e.addEventListener("keyup",function(e){let t;38==e.keyCode&&(t="up"),40==e.keyCode&&(t="down"),r(t)})};OnePageScroll();const overlay=function(){let e=document.querySelector("body"),t=document.querySelector(".modal"),n=document.querySelector(".modal__inner"),i=document.createElement("div");i.classList.add("modal__text");let o=function(){t.classList.remove("is-active"),e.classList.remove("locked")};return{open:function(l,c){let a=document.createElement("button");i.textContent=l,n.innerHTML="",c?(a.classList.add("order-button"),a.textContent="Закрыть"):a.classList.add("modal__close"),n.appendChild(i),n.appendChild(a),t.classList.add("is-active"),e.classList.add("locked"),a.addEventListener("click",e=>{e.preventDefault(),o()}),t.addEventListener("click",e=>{e.target===t&&o()}),document.addEventListener("keydown",e=>{27===e.keyCode&&o()})},close:o}}(),ajaxForm=function(e){let t=new FormData;t.append("name",e.elements.name.value),t.append("phone",e.elements.phone.value),t.append("comment",e.elements.textarea.value),t.append("to","client@mail.ru");const n=new XMLHttpRequest;return n.responseType="json",n.open("POST","https://webdev-api.loftschool.com/sendmail"),n.setRequestHeader("X-Requested-With","XMLHttpRequest"),n.send(t),n},submitForm=function(){let e=document.querySelector("#order-form");if(validateForm(e)){let t=ajaxForm(e);t.addEventListener("load",()=>{let e=!1;if(t.status>=400){let n="Ошибка соединения с сервером, попробуйте позже";overlay.open(`${n}. Ошибка ${t.status}`,e)}else 0==t.response.status?(content=t.response.message,overlay.open(content,e)):(content="Сообщение отправлено",e=!0,overlay.open(content,e))})}};function validateForm(e){let t=!0;return validateField(e.elements.name)||(t=!1),validateField(e.elements.phone)||(t=!1),validateField(e.elements.textarea)||(t=!1),t}function validateField(e){return e.nextElementSibling.textContent=e.validationMessage,e.checkValidity()}let orderBtn=document.querySelector("#send");orderBtn.addEventListener("click",e=>{e.preventDefault(),submitForm()}),function(){const e=document.querySelectorAll(".reviews__item"),t=document.querySelectorAll(".reviews__pix-item");let n=0;for(let i=0;i<e.length;i++)t[i].addEventListener("click",function(o){o.preventDefault(),e[i].classList.toggle("is-active"),t[i].classList.toggle("is-active"),t[n].classList.toggle("is-active"),e[n].classList.toggle("is-active"),n=i})}();let videoPlayer=function(){let e=document.querySelector(".video__content"),t=document.querySelector(".video__btn"),n=document.querySelector(".video__volume"),i=document.querySelector(".video__progress"),o=document.querySelector(".video__play"),l=!1;function c(){e.play(),l=!0,t.classList.add("hidden"),o.classList.add("stop")}function a(){e.pause(),l=!1,t.classList.remove("hidden"),o.classList.remove("stop")}e.ontimeupdate=function(){!function(){let t=e.duration,n=e.currentTime;i.value=n/t*100}(),e.currentTime==e.duration&&a()},t.addEventListener("click",function(){l||c()}),e.addEventListener("click",function(){l&&a()}),n.addEventListener("input",function(){let t=this.value;e.volume=t/100}),i.addEventListener("click",function(t){let n=i.offsetWidth,o=t.offsetX;i.value=o/n*100,e.pause(),e.currentTime=e.duration*(o/n),e.play()}),o.addEventListener("click",function(){l?l&&(a(),e.currentTime=0):c()})};videoPlayer();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFjY29yZGVvbi5qcyIsImpxdWVyeVNsaWRlci5qcyIsIm1hcC5qcyIsIm1lbnUuanMiLCJvcHMuanMiLCJyZXF1ZXN0LmpzIiwic2xpZGVzaG93LmpzIiwidmlkZW8uanMiXSwibmFtZXMiOlsidGVhbSIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwicHJldmVudERlZmF1bHQiLCJ0YXJnZXQiLCJjbGFzc0xpc3QiLCJjb250YWlucyIsImxpbmsiLCJhY3RpdmUiLCJzdHlsZSIsImhlaWdodCIsInJlbW92ZSIsImN1cnJlbnQiLCJjbG9zZXN0IiwiYWRkIiwiY3VycmVudFRleHQiLCJzY3JvbGxIZWlnaHQiLCJhY3RpdmF0ZVRlYW0iLCJsaW5rcyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJib2R5IiwiZm9yRWFjaCIsImVsZW0iLCJ0aGlzIiwid2lkdGgiLCJvZmZzZXRXaWR0aCIsImRvY3VtZW50RWxlbWVudCIsImNsaWVudFdpZHRoIiwicmVxV2lkdGgiLCJwYXJzZUZsb2F0IiwiZ2V0Q29tcHV0ZWRTdHlsZSIsImxlbmd0aCIsIndpZHRoQ2FsYyIsImFjdGl2YXRlTWVudSIsIiQiLCJzbGlkZXIiLCJvbiIsImV4aXN0ZWRJdGVtIiwiZWRnZUl0ZW0iLCIkdGhpcyIsIml0ZW1zIiwiZmluZCIsImFjdGl2ZUl0ZW0iLCJmaWx0ZXIiLCJoYXNDbGFzcyIsIm5leHQiLCJmaXJzdCIsInByZXYiLCJsYXN0IiwibnVtIiwicmVxSXRlbSIsImVxIiwicmVxSW5kZXgiLCJpbmRleCIsImxpc3QiLCJhbmltYXRlIiwibGVmdCIsInJlbW92ZUNsYXNzIiwiYWRkQ2xhc3MiLCJtb3ZlU2xpZGUiLCJ5bWFwcyIsInJlYWR5IiwiaW5pdCIsImdlb09iamVjdHMiLCJtYXJrcyIsImxhdGl0dWRlIiwibG9uZ2l0dWRlIiwiaGludENvbnRlbnQiLCJtYXAiLCJNYXAiLCJjZW50ZXIiLCJ6b29tIiwiY29udHJvbHMiLCJiZWhhdmlvcnMiLCJpIiwiUGxhY2VtYXJrIiwiaWNvbkxheW91dCIsImljb25JbWFnZUhyZWYiLCJpY29uSW1hZ2VTaXplIiwiaWNvbkltYWdlT2Zmc2V0IiwiY2x1c3RlcmVyIiwiQ2x1c3RlcmVyIiwiY2x1c3Rlckljb25zIiwiaHJlZiIsInNpemUiLCJvZmZzZXQiLCJjbHVzdGVySWNvbkNvbnRlbnRMYXlvdXQiLCJtZW51IiwiYnV0dG9uIiwiaGVhZGVyIiwibmF2IiwiYWN0IiwidG9nZ2xlTWVudSIsInRvZ2dsZSIsImtleUNvZGUiLCJtZW51T3ZlciIsIk9uZVBhZ2VTY3JvbGwiLCJkIiwid3JhcHBlciIsImNvbnRlbnQiLCJzZWN0aW9ucyIsImNsaWVudFkiLCJtZW51TGlua3MiLCJwb2ludHMiLCJwYXVzZSIsIm1vdmVDb250ZW50IiwicG9zIiwidG9wIiwic2V0VGltZW91dCIsInNjcm9sbCIsIndheSIsImN1cnJlbnRQb3MiLCJwYXJzZUludCIsImRlbHRhWSIsInRlc3QiLCJuYXZpZ2F0b3IiLCJ1c2VyQWdlbnQiLCJ0b3VjaGVzIiwiY2hhbmdlZFRvdWNoZXMiLCJkYXRhc2V0Iiwib3ZlcmxheSIsIm1vZGFsIiwibW9kYWxJbm5lciIsIm1vZGFsVGV4dCIsImNyZWF0ZUVsZW1lbnQiLCJjbG9zZU92ZXJsYXkiLCJvcGVuIiwicmVwbHkiLCJ0ZXh0Q29udGVudCIsImlubmVySFRNTCIsImFwcGVuZENoaWxkIiwiY2xvc2UiLCJhamF4Rm9ybSIsImZvcm0iLCJkYXRhIiwiRm9ybURhdGEiLCJhcHBlbmQiLCJlbGVtZW50cyIsIm5hbWUiLCJ2YWx1ZSIsInBob25lIiwidGV4dGFyZWEiLCJ4aHIiLCJYTUxIdHRwUmVxdWVzdCIsInJlc3BvbnNlVHlwZSIsInNldFJlcXVlc3RIZWFkZXIiLCJzZW5kIiwic3VibWl0Rm9ybSIsInZhbGlkYXRlRm9ybSIsInJlcXVlc3QiLCJzdGF0dXMiLCJyZXNwb25zZSIsIm1lc3NhZ2UiLCJ2YWxpZCIsInZhbGlkYXRlRmllbGQiLCJmaWVsZCIsIm5leHRFbGVtZW50U2libGluZyIsInZhbGlkYXRpb25NZXNzYWdlIiwiY2hlY2tWYWxpZGl0eSIsIm9yZGVyQnRuIiwicGl4IiwidmlkZW9QbGF5ZXIiLCJ2aWRlbyIsInBsYXlCdG4iLCJ2b2x1bWUiLCJwcm9ncmVzc0JhciIsInN3aXRjaEJ0biIsInBsYXlpbmciLCJwbGF5Iiwib250aW1ldXBkYXRlIiwiZHVyYXRpb24iLCJ0aW1lIiwiY3VycmVudFRpbWUiLCJwcm9ncmVzcyIsIm9mZnNldFgiXSwibWFwcGluZ3MiOiJDQUFBLFlBV0EsV0FDQSxJQUFBQSxFQUFBQyxTQUFBQyxjQUFBLGVBQ0FGLEVBQUFHLGlCQUFBLFFBQUEsU0FBQUMsR0FFQSxHQURBQSxFQUFBQyxpQkFDQUQsRUFBQUUsT0FBQUMsVUFBQUMsU0FBQSxnQkFBQSxDQUNBLElBQUFDLEVBQUFMLEVBQUFFLE9BRUFJLEVBQUFWLEVBQUFFLGNBQUEscUJBT0EsR0FMQVEsSUFDQUEsRUFBQVIsY0FBQSxpQkFDQVMsTUFBQUMsT0FBQSxNQUNBRixFQUFBSCxVQUFBTSxPQUFBLGVBRUFILEdBQUFBLEVBQUFSLGNBQUEsa0JBQUFPLEVBQUEsQ0FDQSxJQUFBSyxFQUFBTCxFQUFBTSxRQUFBLFdBQ0FELEVBQUFQLFVBQUFTLElBQUEsYUFFQSxJQUFBQyxFQUFBSCxFQUFBWixjQUFBLGlCQUNBZSxFQUFBTixNQUFBQyxPQUFBSyxFQUFBQyxhQUFBLFNBS0FDLEdBRUEsV0FDQSxJQUFBQyxFQUFBbkIsU0FBQW9CLGlCQUFBLGdCQUNBQyxFQUFBckIsU0FBQUMsY0FBQSxRQUNBa0IsRUFBQUcsUUFBQSxTQUFBQyxHQUNBQSxFQUFBckIsaUJBQUEsUUFBQSxTQUFBQyxHQUNBQSxFQUFBQyxpQkFDQSxJQUFBSSxFQUFBZ0IsS0FDQWYsRUFBQVQsU0FBQUMsY0FBQSx5QkFRQSxHQU5BUSxJQUNBQSxFQUFBUixjQUFBLGVBQ0FTLE1BQUFlLE1BQUEsTUFDQWhCLEVBQUFILFVBQUFNLE9BQUEsZUFHQUgsR0FBQUEsRUFBQVIsY0FBQSxpQkFBQU8sRUFBQSxDQUNBLElB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SyxVQUFBUyxJQUFBLFFBRUEsU0FBQTBGLElBQ0EwRCxFQUFBMUQsUUFDQStELEdBQUEsRUFDQUosRUFBQTlKLFVBQUFNLE9BQUEsVUFDQTJKLEVBQUFqSyxVQUFBTSxPQUFBLFFBaEJBdUosRUFBQU8sYUFBQSxZQWtCQSxXQUNBLElBQUFDLEVBQUFSLEVBQUFRLFNBQ0FDLEVBQUFULEVBQUFVLFlBQ0FQLEVBQUExQixNQUFBZ0MsRUFBQUQsRUFBQSxJQXBCQUcsR0FDQVgsRUFBQVUsYUFBQVYsRUFBQVEsVUFDQWxFLEtBcUJBMkQsRUFBQWxLLGlCQUFBLFFBQUEsV0FDQXNLLEdBQ0FDLE1BR0FOLEVBQUFqSyxpQkFBQSxRQUFBLFdBQ0FzSyxHQUNBL0QsTUFHQTRELEVBQUFuSyxpQkFBQSxRQUFBLFdBQ0EsSUFBQTBJLEVBQUFwSCxLQUFBb0gsTUFDQXVCLEVBQUFFLE9BQUF6QixFQUFBLE1BRUEwQixFQUFBcEssaUJBQUEsUUFBQSxTQUFBQyxHQUNBLElBQUFzQixFQUFBNkksRUFBQTVJLFlBQ0FpRixFQUFBeEcsRUFBQTRLLFFBQ0FULEVBQUExQixNQUFBakMsRUFBQWxGLEVBQUEsSUFDQTBJLEVBQUExRCxRQUNBMEQsRUFBQVUsWUFBQVYsRUFBQVEsVUFBQWhFLEVBQUFsRixHQUNBMEksRUFBQU0sU0FFQUYsRUFBQXJLLGlCQUFBLFFBQUEsV0FDQXNLLEVBR0FBLElBQ0EvRCxJQUNBMEQsRUFBQVUsWUFBQSxHQUpBSixPQVNBUCIsImZpbGUiOiJzY3JpcHQubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCl7XHJcblxyXG4gIGZ1bmN0aW9uIHdpZHRoQ2FsYygpIHtcclxuICAgIGxldCB3aWR0aCA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aDtcclxuICAgIGxldCBsaW5rcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5tZW51X19ibG9jaycpO1xyXG4gICAgbGV0IGxpbmtXaWR0aCA9IHBhcnNlRmxvYXQoZ2V0Q29tcHV0ZWRTdHlsZShsaW5rc1swXSkud2lkdGgpO1xyXG5cclxuICAgIGxldCByZXFXaWR0aCA9IHdpZHRoIC0gbGlua1dpZHRoICogbGlua3MubGVuZ3RoO1xyXG4gICAgcmV0dXJuIHJlcVdpZHRoID4gNTUwID8gNTUwIDogcmVxV2lkdGg7XHJcbiAgfVxyXG4gIFxyXG4gIGZ1bmN0aW9uIGFjdGl2YXRlVGVhbSgpIHtcclxuICAgIGxldCB0ZWFtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnRlYW1fX2xpc3QnKTsgICBcclxuICAgIHRlYW0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihlKXtcclxuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgaWYoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdtZW1iZXJfX2xpbmsnKSl7XHJcbiAgICAgICAgbGV0IGxpbmsgPSBlLnRhcmdldDtcclxuXHJcbiAgICAgICAgbGV0IGFjdGl2ZSA9IHRlYW0ucXVlcnlTZWxlY3RvcignLm1lbWJlci5pcy1hY3RpdmUnKTtcclxuXHJcbiAgICAgICAgaWYoYWN0aXZlKSB7XHJcbiAgICAgICAgICBsZXQgYWN0aXZlVGV4dCA9IGFjdGl2ZS5xdWVyeVNlbGVjdG9yKCcubWVtYmVyX190ZXh0Jyk7ICAgICAgICAgIFxyXG4gICAgICAgICAgYWN0aXZlVGV4dC5zdHlsZS5oZWlnaHQgPSAnMHB4JztcclxuICAgICAgICAgIGFjdGl2ZS5jbGFzc0xpc3QucmVtb3ZlKCdpcy1hY3RpdmUnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYoIWFjdGl2ZSB8fCBhY3RpdmUucXVlcnlTZWxlY3RvcignLm1lbWJlcl9fbGluaycpICE9IGxpbmspIHtcclxuICAgICAgICAgIGxldCBjdXJyZW50ICA9IGxpbmsuY2xvc2VzdCgnLm1lbWJlcicpO1xyXG4gICAgICAgICAgY3VycmVudC5jbGFzc0xpc3QuYWRkKCdpcy1hY3RpdmUnKTtcclxuXHJcbiAgICAgICAgICBsZXQgY3VycmVudFRleHQgPSBjdXJyZW50LnF1ZXJ5U2VsZWN0b3IoJy5tZW1iZXJfX3RleHQnKTtcclxuICAgICAgICAgIGN1cnJlbnRUZXh0LnN0eWxlLmhlaWdodCA9IGN1cnJlbnRUZXh0LnNjcm9sbEhlaWdodCArICdweCc7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9KSAgICBcclxuICB9XHJcbiAgYWN0aXZhdGVUZWFtKClcclxuXHJcbiAgZnVuY3Rpb24gYWN0aXZhdGVNZW51KCkge1xyXG4gICAgbGV0IGxpbmtzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLm1lbnVfX2Jsb2NrJyk7XHJcbiAgICBsZXQgYm9keSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2JvZHknKTsgIFxyXG4gICAgbGlua3MuZm9yRWFjaChmdW5jdGlvbihlbGVtKXtcclxuICAgICAgZWxlbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGUpe1xyXG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICBsZXQgbGluayA9IHRoaXM7ICAgICAgICBcclxuICAgICAgICBsZXQgYWN0aXZlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1lbnVfX2l0ZW0uaXMtYWN0aXZlJyk7XHJcblxyXG4gICAgICAgIGlmKGFjdGl2ZSkge1xyXG4gICAgICAgICAgbGV0IGFjdGl2ZVRleHQgPSBhY3RpdmUucXVlcnlTZWxlY3RvcignLm1lbnVfX2Rlc2MnKTsgICAgICAgICAgXHJcbiAgICAgICAgICBhY3RpdmVUZXh0LnN0eWxlLndpZHRoID0gJzBweCc7XHJcbiAgICAgICAgICBhY3RpdmUuY2xhc3NMaXN0LnJlbW92ZSgnaXMtYWN0aXZlJyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZighYWN0aXZlIHx8IGFjdGl2ZS5xdWVyeVNlbGVjdG9yKCcubWVudV9fYmxvY2snKSAhPSBsaW5rKSB7XHJcbiAgICAgICAgICBsZXQgY3VycmVudCAgPSBsaW5rLmNsb3Nlc3QoJy5tZW51X19pdGVtJyk7XHJcbiAgICAgICAgICBjdXJyZW50LmNsYXNzTGlzdC5hZGQoJ2lzLWFjdGl2ZScpO1xyXG5cclxuICAgICAgICAgIGxldCBjdXJyZW50VGV4dCA9IGN1cnJlbnQucXVlcnlTZWxlY3RvcignLm1lbnVfX2Rlc2MnKTtcclxuICAgICAgICAgIGlmIChib2R5Lm9mZnNldFdpZHRoID4gNDgwKSB7XHJcbiAgICAgICAgICBjdXJyZW50VGV4dC5zdHlsZS53aWR0aCA9IHdpZHRoQ2FsYygpICsgJ3B4JztcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGN1cnJlbnRUZXh0LnN0eWxlLndpZHRoID0gJ2F1dG8nO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0gICAgICBcclxuICAgICAgfSlcclxuICAgIH0pXHJcbiAgfVxyXG4gIGFjdGl2YXRlTWVudSgpOyAgXHJcbn0oKSk7XHJcblxyXG5cclxuICAiLCIkKGZ1bmN0aW9uICgpIHtcclxuICAgIGxldCBzbGlkZXIgPSAkKCcuY2FuZHktYmFyX19zbGlkZXInKTtcclxuICAgIFxyXG4gIGxldCBtb3ZlU2xpZGUgPSBmdW5jdGlvbihudW0pIHtcclxuICAgIGxldCBpdGVtcyA9IHNsaWRlci5maW5kKCcuY2FuZHktYmFyX19pdGVtJyk7XHJcbiAgICBsZXQgYWN0aXZlSXRlbSA9IGl0ZW1zLmZpbHRlcignLmFjdGl2ZScpO1xyXG4gICAgbGV0IHJlcUl0ZW0gPSBpdGVtcy5lcShudW0pO1xyXG4gICAgbGV0IHJlcUluZGV4ID0gcmVxSXRlbS5pbmRleCgpO1xyXG4gICAgbGV0IGxpc3QgPSBzbGlkZXIuZmluZCgnLmNhbmR5LWJhcl9fbGlzdCcpO1xyXG4gICAgbGV0IGR1cmF0aW9uID0gNTAwO1xyXG4gICAgaWYgKHJlcUl0ZW0ubGVuZ3RoKSB7XHJcbiAgICAgIGxpc3QuYW5pbWF0ZSh7XHJcbiAgICAgICAgJ2xlZnQnOiAtcmVxSW5kZXggKiAxMDAgKyclJ1xyXG4gICAgICB9LCBkdXJhdGlvbiwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgYWN0aXZlSXRlbS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgICAgcmVxSXRlbS5hZGRDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgIH0pXHJcbiAgICB9XHJcbiAgfVxyXG4gIFxyXG4gICQoJy5zY3JvbGwtYnRuJykub24oJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xyXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgbGV0ICR0aGlzID0gJCh0aGlzKTtcclxuICAgIGxldCBpdGVtcyA9IHNsaWRlci5maW5kKCcuY2FuZHktYmFyX19pdGVtJyk7XHJcbiAgICBsZXQgYWN0aXZlSXRlbSA9IGl0ZW1zLmZpbHRlcignLmFjdGl2ZScpO1xyXG4gICAgbGV0IGV4aXN0ZWRJdGVtO1xyXG4gICAgbGV0IGVkZ2VJdGVtO1xyXG5cclxuICAgIGlmICgkdGhpcy5oYXNDbGFzcygnc2Nyb2xsLWJ0bi0tZm9yd2FyZCcpKSB7XHJcbiAgICAgIGV4aXN0ZWRJdGVtID0gYWN0aXZlSXRlbS5uZXh0KCk7XHJcbiAgICAgIGVkZ2VJdGVtID0gaXRlbXMuZmlyc3QoKTsgICAgIFxyXG4gICAgfSBcclxuICAgIGlmICgkdGhpcy5oYXNDbGFzcygnc2Nyb2xsLWJ0bi0tYmFjaycpKSB7XHJcbiAgICAgIGV4aXN0ZWRJdGVtID0gYWN0aXZlSXRlbS5wcmV2KCk7XHJcbiAgICAgIGVkZ2VJdGVtID0gaXRlbXMubGFzdCgpOyAgICAgIFxyXG4gICAgfVxyXG5cclxuICAgIGxldCByZXFJdGVtID0gZXhpc3RlZEl0ZW0ubGVuZ3RoID8gZXhpc3RlZEl0ZW0uaW5kZXgoKSA6IGVkZ2VJdGVtLmluZGV4KCk7XHJcbiAgICBtb3ZlU2xpZGUocmVxSXRlbSk7XHJcbiAgICB9KVxyXG59KSIsInltYXBzLnJlYWR5KGluaXQpO1xyXG4gIHZhciBnZW9PYmplY3RzPSBbXTtcclxuICB2YXIgbWFya3MgPSBbXHJcbiAgICB7XHJcbiAgICAgIGxhdGl0dWRlOiA1NS43NTg3LFxyXG4gICAgICBsb25naXR1ZGU6IDM3LjU4MjgsXHJcbiAgICAgIGhpbnRDb250ZW50OiAnPGRpdiBjbGFzcz1cIm1hcF9faGludFwiPtCa0YPQtNGA0LjQvdGB0LrQsNGPINC/0LvQvtGJ0LDQtNGMINC0LjE8L2Rpdj4nLFxyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgbGF0aXR1ZGU6IDU1Ljc0MjcsXHJcbiAgICAgIGxvbmdpdHVkZTogMzcuNTc5OSxcclxuICAgICAgaGludENvbnRlbnQ6ICc8ZGl2IGNsYXNzPVwibWFwX19oaW50XCI+0YPQuy7Qn9C70Y7RidC40YXQsCDQtC4xMTwvZGl2PicsXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICBsYXRpdHVkZTogNTUuNzU3NCxcclxuICAgICAgbG9uZ2l0dWRlOiAzNy42MjA4LFxyXG4gICAgICBoaW50Q29udGVudDogJzxkaXYgY2xhc3M9XCJtYXBfX2hpbnRcIj7Qn9C70L7RidCw0LTRjCDQoNC10LLQvtC70Y7RhtC40Lgg0LQuMTwvZGl2PicsXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICBsYXRpdHVkZTogNTUuNzUwMCxcclxuICAgICAgbG9uZ2l0dWRlOiAzNy42MDM3LFxyXG4gICAgICBoaW50Q29udGVudDogJzxkaXYgY2xhc3M9XCJtYXBfX2hpbnRcIj7QkdC+0LvRjNGI0L7QuSDQl9C90LDQvNC10L3RgdC60LjQuSDQv9C10YAuINC0LjIzPC9kaXY+JyxcclxuICAgIH1cclxuICBdXHJcblxyXG5mdW5jdGlvbiBpbml0KCkge1xyXG4gIHZhciBtYXAgPSBuZXcgeW1hcHMuTWFwKCdtYXAnLCB7XHJcbiAgICBjZW50ZXI6IFs1NS43NTI2OTY1NiwgMzcuNTk0MjcwODNdLFxyXG4gICAgem9vbTogMTQsXHJcbiAgICBjb250cm9sczogWyd6b29tQ29udHJvbCddLFxyXG4gICAgYmVoYXZpb3JzOiBbJ2RyYWcnXVxyXG4gIH0pO1xyXG4gIGZvciAobGV0IGk9MDsgaTxtYXJrcy5sZW5ndGg7IGkrKykge1xyXG4gICAgZ2VvT2JqZWN0c1tpXSA9IG5ldyB5bWFwcy5QbGFjZW1hcmsoW21hcmtzW2ldLmxhdGl0dWRlLCBtYXJrc1tpXS5sb25naXR1ZGVdLFxyXG4gICAgICB7XHJcbiAgICAgICAgaGludENvbnRlbnQ6IG1hcmtzW2ldLmhpbnRDb250ZW50XHJcbiAgICAgIH0sXHJcbiAgICAgIHtcclxuICAgICAgICBpY29uTGF5b3V0OiAnZGVmYXVsdCNpbWFnZScsXHJcbiAgICAgICAgaWNvbkltYWdlSHJlZjogJy4uL2ltZy9tYXAtbWFya2VyLnBuZycsXHJcbiAgICAgICAgaWNvbkltYWdlU2l6ZTogWzQ2LCA1N10sXHJcbiAgICAgICAgaWNvbkltYWdlT2Zmc2V0OiBbLTIzLCAtNTddXHJcbiAgICAgIH0pO1xyXG4gIH1cclxuICB2YXIgY2x1c3RlcmVyID0gbmV3IHltYXBzLkNsdXN0ZXJlcih7XHJcbiAgICBjbHVzdGVySWNvbnM6IFtcclxuICAgICAge1xyXG4gICAgICAgIGhyZWY6ICcuLi9pbWcvbWFwLW1hcmtlci5wbmcnLFxyXG4gICAgICAgIHNpemU6IFs0NiwgNTddLFxyXG4gICAgICAgIG9mZnNldDogWy0yMywgLTU3XVxyXG4gICAgICB9XHJcbiAgICBdLFxyXG4gICAgY2x1c3Rlckljb25Db250ZW50TGF5b3V0OiBudWxsXHJcbiAgfSk7XHJcbiAgbWFwLmdlb09iamVjdHMuYWRkKGNsdXN0ZXJlcik7XHJcbiAgY2x1c3RlcmVyLmFkZChnZW9PYmplY3RzKTtcclxufSIsImNvbnN0IG1lbnUgPSAoZnVuY3Rpb24oKSB7XHJcbiAgbGV0IGJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tZW51LWJ0bicpO1xyXG4gIGxldCBoZWFkZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaGVhZGVyJyk7XHJcbiAgbGV0IGJvZHkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdib2R5Jyk7XHJcbiAgbGV0IG5hdiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5uYXZfX2xpc3QnKTtcclxuICBsZXQgYWN0ID0gZmFsc2U7XHJcblxyXG4gIGZ1bmN0aW9uIHRvZ2dsZU1lbnUoKSB7XHJcbiAgICAgIGJ1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKCdpcy1hY3RpdmUnKTtcclxuICAgICAgaGVhZGVyLmNsYXNzTGlzdC50b2dnbGUoJ2lzLWFjdGl2ZScpO1xyXG4gICAgICBib2R5LmNsYXNzTGlzdC50b2dnbGUoJ2xvY2tlZCcpO1xyXG5cclxuICAgICAgYWN0ID8gYWN0ID0gZmFsc2UgOiBhY3QgPSB0cnVlO1xyXG4gIH1cclxuXHJcbiAgbGV0IGFkZExpc3RlbmVycyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRvZ2dsZU1lbnUpO1xyXG5cclxuICAgICAgICBuYXYuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihlKXtcclxuICAgICAgICAgIGxldCB0YXJnZXQgPSBlLnRhcmdldDtcclxuICAgICAgICAgIGlmICh0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCduYXZfX2xpbmsnKSAmJiBib2R5Lm9mZnNldFdpZHRoIDw9IDc2OCkge1xyXG4gICAgICAgICAgICB0b2dnbGVNZW51KCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGZ1bmN0aW9uKGUpe1xyXG4gICAgICAgIGlmIChlLmtleUNvZGUgPT0gMjcgJiYgYWN0KSB7XHJcbiAgICAgICAgICB0b2dnbGVNZW51KCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KVxyXG4gIHJldHVybiB7XHJcbiAgICBtZW51T3ZlcjogYWRkTGlzdGVuZXJzICBcclxuICB9XHJcbn0oKSk7XHJcbm1lbnUubWVudU92ZXIoKTsiLCJsZXQgT25lUGFnZVNjcm9sbCA9IGZ1bmN0aW9uKCl7XHJcbiAgY29uc3QgZCA9IGRvY3VtZW50O1xyXG4gIGNvbnN0IHdyYXBwZXIgPSBkLnF1ZXJ5U2VsZWN0b3IoJy53cmFwcGVyJyk7XHJcbiAgY29uc3QgY29udGVudCA9IGQucXVlcnlTZWxlY3RvcignI2NvbnRlbnQnKTtcclxuICBjb25zdCBzZWN0aW9ucyA9IGQucXVlcnlTZWxlY3RvckFsbCgnLnNlY3Rpb24nKTtcclxuICBsZXQgbWVudUxpbmtzID0gZC5xdWVyeVNlbGVjdG9yQWxsKCcubmF2X19saW5rJyk7ICBcclxuICBsZXQgcG9pbnRzID0gZC5xdWVyeVNlbGVjdG9yQWxsKCcubGlzdGluZ19faXRlbScpO1xyXG4gIGxldCBwYXVzZSA9IGZhbHNlO1xyXG4gIGxldCBjbGllbnRZO1xyXG4gIFxyXG4gIGZ1bmN0aW9uIG1vdmVDb250ZW50KGluZGV4KSB7XHJcbiAgICBpZiAoIXBhdXNlKSB7XHJcbiAgICAgIHBhdXNlID0gdHJ1ZTtcclxuICAgIGxldCBwb3MgPSBpbmRleCAqIC0xMDAgKyAnJSc7XHJcbiAgICBjb250ZW50LnN0eWxlLnRvcCA9IHBvcztcclxuXHJcbiAgICBsZXQgYWN0aXZlID0gZC5xdWVyeVNlbGVjdG9yKCcubGlzdGluZ19faXRlbS5pcy1hY3RpdmUnKTtcclxuICAgIGFjdGl2ZS5jbGFzc0xpc3QucmVtb3ZlKCdpcy1hY3RpdmUnKTtcclxuICAgIHBvaW50c1tpbmRleF0uY2xhc3NMaXN0LmFkZCgnaXMtYWN0aXZlJyk7XHJcblxyXG4gICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkgeyAgICAgICAgXHJcbiAgICAgICAgcGF1c2UgPSBmYWxzZTtcclxuICAgICAgfSwgOTAwKVxyXG4gICAgfSAgIFxyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gc2Nyb2xsKHdheSkge1xyXG4gICAgbGV0IGN1cnJlbnRQb3MgPSAhY29udGVudC5zdHlsZS50b3AgPyAwIDogLXBhcnNlSW50KGNvbnRlbnQuc3R5bGUudG9wLCAxMCkvMTAwO1xyXG4gICAgaWYgKHdheSA9PSAndXAnICYmIGN1cnJlbnRQb3MgPiAwKSB7ICAgICAgXHJcbiAgICAgIG1vdmVDb250ZW50KGN1cnJlbnRQb3MtMSk7XHJcbiAgICB9XHJcbiAgICBpZih3YXkgPT0gJ2Rvd24nICYmIGN1cnJlbnRQb3MgPCBzZWN0aW9ucy5sZW5ndGgtMSkge1xyXG4gICAgICBtb3ZlQ29udGVudChjdXJyZW50UG9zKzEpO1xyXG4gICAgfSBcclxuICB9XHJcblxyXG4gIHdyYXBwZXIuYWRkRXZlbnRMaXN0ZW5lcignd2hlZWwnLCBmdW5jdGlvbihlKSB7XHJcbiAgICBsZXQgd2F5ID0gZS5kZWx0YVkgPCAwID8gJ3VwJyA6ICdkb3duJztcclxuICAgIHNjcm9sbCh3YXkpO1xyXG4gIH0pXHJcbiAgd3JhcHBlci5hZGRFdmVudExpc3RlbmVyKCd0b3VjaG1vdmUnLCBmdW5jdGlvbihlKSB7XHJcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgfSlcclxuXHJcbiAgd3JhcHBlci5hZGRFdmVudExpc3RlbmVyKCd0b3VjaHN0YXJ0JywgZnVuY3Rpb24oZSkge1xyXG4gICAgaWYgKC9BbmRyb2lkfEFwcGxlV2ViS2l0fHdlYk9TfGlQaG9uZXxpUGFkfGlQb2R8QmxhY2tCZXJyeXxJRU1vYmlsZXxPcGVyYSBNaW5pL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSkge1xyXG4gICAgICBjbGllbnRZID0gZS50b3VjaGVzWzBdLmNsaWVudFk7XHJcbiAgICB9XHJcbiAgfSwgZmFsc2UpO1xyXG5cclxuICB3cmFwcGVyLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJywgZnVuY3Rpb24oZSkgeyAgICAgIFxyXG4gICAgICBsZXQgZGVsdGFZID0gZS5jaGFuZ2VkVG91Y2hlc1swXS5jbGllbnRZIC0gY2xpZW50WTtcclxuICAgICAgbGV0IHdheSA9IGRlbHRhWSA+IDAgPyAndXAnIDogJ2Rvd24nO1xyXG4gICAgICBzY3JvbGwod2F5KTsgICBcclxuICB9LCBmYWxzZSk7XHJcblxyXG4gIG1lbnVMaW5rcy5mb3JFYWNoKGZ1bmN0aW9uKGVsZW0pIHsgICAgXHJcbiAgICBlbGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZSl7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgbGV0IGluZGV4ID0gdGhpcy5kYXRhc2V0LmluZGV4OyAgICAgICAgXHJcbiAgICAgIG1vdmVDb250ZW50KGluZGV4KTtcclxuICAgIH0pICAgICAgXHJcbiAgfSlcclxuXHJcbiAgcG9pbnRzLmZvckVhY2goZnVuY3Rpb24oZWxlbSkge1xyXG4gICAgZWxlbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGUpe1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIGxpbmsgPSBlLnRhcmdldDtcclxuICAgICAgbGV0IGluZGV4ID0gbGluay5kYXRhc2V0LmluZGV4O1xyXG4gICAgICBtb3ZlQ29udGVudChpbmRleCk7XHJcbiAgICB9KVxyXG4gIH0pXHJcblxyXG4gIGxldCBidXR0b24gPSBkLnF1ZXJ5U2VsZWN0b3IoJy5pbnRyby1idXR0b24nKTtcclxuICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihlKSB7XHJcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICBtb3ZlQ29udGVudCg3KTtcclxuICB9KVxyXG5cclxuICBkLmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywgZnVuY3Rpb24oZSkge1xyXG4gICAgbGV0IHdheTtcclxuICAgIGlmIChlLmtleUNvZGUgPT0gMzgpIHtcclxuICAgICAgd2F5ID0gJ3VwJztcclxuICAgIH1cclxuICAgIGlmIChlLmtleUNvZGUgPT0gNDApIHtcclxuICAgICAgd2F5ID0gJ2Rvd24nO1xyXG4gICAgIH1cclxuICAgICBzY3JvbGwod2F5KTtcclxuICB9KVxyXG59XHJcbk9uZVBhZ2VTY3JvbGwoKTsiLCJjb25zdCBvdmVybGF5ID0gKGZ1bmN0aW9uKCl7XHJcbiAgbGV0IGJvZHkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdib2R5Jyk7XHJcbiAgbGV0IG1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsJyk7XHJcbiAgbGV0IG1vZGFsSW5uZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2lubmVyJyk7ICBcclxuXHJcbiAgbGV0IG1vZGFsVGV4dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gIG1vZGFsVGV4dC5jbGFzc0xpc3QuYWRkKCdtb2RhbF9fdGV4dCcpOyAgXHJcblxyXG4gIGxldCBvcGVuT3ZlcmxheSA9IGZ1bmN0aW9uKGNvbnRlbnQsIHJlcGx5KSB7XHJcbiAgICBsZXQgYnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XHJcbiAgICBtb2RhbFRleHQudGV4dENvbnRlbnQgPSBjb250ZW50O1xyXG4gICAgbW9kYWxJbm5lci5pbm5lckhUTUwgPSBcIlwiO1xyXG4gICAgaWYocmVwbHkpIHtcclxuICAgICAgYnV0dG9uLmNsYXNzTGlzdC5hZGQoJ29yZGVyLWJ1dHRvbicpO1xyXG4gICAgICBidXR0b24udGV4dENvbnRlbnQgPSAn0JfQsNC60YDRi9GC0YwnO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgYnV0dG9uLmNsYXNzTGlzdC5hZGQoJ21vZGFsX19jbG9zZScpO1xyXG4gICAgfVxyXG4gICAgbW9kYWxJbm5lci5hcHBlbmRDaGlsZChtb2RhbFRleHQpO1xyXG4gICAgbW9kYWxJbm5lci5hcHBlbmRDaGlsZChidXR0b24pO1xyXG5cclxuICAgIG1vZGFsLmNsYXNzTGlzdC5hZGQoJ2lzLWFjdGl2ZScpO1xyXG4gICAgYm9keS5jbGFzc0xpc3QuYWRkKCdsb2NrZWQnKTtcclxuXHJcbiAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIGNsb3NlT3ZlcmxheSgpO1xyXG4gICAgfSlcclxuXHJcbiAgICBtb2RhbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XHJcbiAgICAgIGlmIChlLnRhcmdldCA9PT0gbW9kYWwpIHtcclxuICAgICAgICBjbG9zZU92ZXJsYXkoKTtcclxuICAgICAgfVxyXG4gICAgfSlcclxuXHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgKGUpID0+IHtcclxuICAgICAgaWYgKGUua2V5Q29kZSA9PT0gMjcpIFxyXG4gICAgICAgIGNsb3NlT3ZlcmxheSgpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBsZXQgY2xvc2VPdmVybGF5ID0gZnVuY3Rpb24oKSB7XHJcbiAgICBtb2RhbC5jbGFzc0xpc3QucmVtb3ZlKCdpcy1hY3RpdmUnKTtcclxuICAgIGJvZHkuY2xhc3NMaXN0LnJlbW92ZSgnbG9ja2VkJyk7XHJcbiAgfVxyXG5cclxuICByZXR1cm4ge1xyXG4gICAgb3Blbjogb3Blbk92ZXJsYXksXHJcbiAgICBjbG9zZTogY2xvc2VPdmVybGF5XHJcbiAgfTtcclxufSgpKTtcclxuXHJcbmNvbnN0IGFqYXhGb3JtID0gZnVuY3Rpb24oZm9ybSkge1xyXG4gXHJcbiAgbGV0IGRhdGEgPSBuZXcgRm9ybURhdGEoKTtcclxuICAgIGRhdGEuYXBwZW5kKFwibmFtZVwiLCBmb3JtLmVsZW1lbnRzLm5hbWUudmFsdWUpO1xyXG4gICAgZGF0YS5hcHBlbmQoXCJwaG9uZVwiLCBmb3JtLmVsZW1lbnRzLnBob25lLnZhbHVlKTtcclxuICAgIGRhdGEuYXBwZW5kKFwiY29tbWVudFwiLCBmb3JtLmVsZW1lbnRzLnRleHRhcmVhLnZhbHVlKTtcclxuICAgIGRhdGEuYXBwZW5kKFwidG9cIiwgXCJjbGllbnRAbWFpbC5ydVwiKTtcclxuICBcclxuICAgIGNvbnN0IHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xyXG4gICAgeGhyLnJlc3BvbnNlVHlwZSA9ICdqc29uJztcclxuICAgIHhoci5vcGVuKCdQT1NUJywnaHR0cHM6Ly93ZWJkZXYtYXBpLmxvZnRzY2hvb2wuY29tL3NlbmRtYWlsJyk7XHJcbiAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcihcIlgtUmVxdWVzdGVkLVdpdGhcIiwgXCJYTUxIdHRwUmVxdWVzdFwiKTtcclxuICAgIHhoci5zZW5kKGRhdGEpO1xyXG5cclxuICAgIHJldHVybiB4aHI7XHJcbiAgXHJcbn1cclxuXHJcbmNvbnN0IHN1Ym1pdEZvcm0gPSBmdW5jdGlvbigpIHsgIFxyXG4gIGxldCBmb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI29yZGVyLWZvcm0nKTtcclxuICBpZiAodmFsaWRhdGVGb3JtKGZvcm0pKSB7XHJcbiAgICBcclxuICBsZXQgcmVxdWVzdCA9IGFqYXhGb3JtKGZvcm0pOyAgXHJcbiAgICByZXF1ZXN0LmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCAoKT0+IHtcclxuICAgICAgbGV0IHJlcGx5ID0gZmFsc2U7XHJcbiAgICAgIGlmIChyZXF1ZXN0LnN0YXR1cyA+PTQwMCkge1xyXG4gICAgICAgIGxldCBjb250ZW50ID0gJ9Ce0YjQuNCx0LrQsCDRgdC+0LXQtNC40L3QtdC90LjRjyDRgSDRgdC10YDQstC10YDQvtC8LCDQv9C+0L/RgNC+0LHRg9C50YLQtSDQv9C+0LfQttC1JztcclxuICAgICAgICBvdmVybGF5Lm9wZW4oYCR7Y29udGVudH0uINCe0YjQuNCx0LrQsCAke3JlcXVlc3Quc3RhdHVzfWAsIHJlcGx5KTtcclxuICAgICAgfSBlbHNlIGlmIChyZXF1ZXN0LnJlc3BvbnNlLnN0YXR1cyA9PSAwKSB7XHJcbiAgICAgICAgY29udGVudCA9IHJlcXVlc3QucmVzcG9uc2UubWVzc2FnZTtcclxuICAgICAgICBvdmVybGF5Lm9wZW4oY29udGVudCwgcmVwbHkpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGNvbnRlbnQgPSAn0KHQvtC+0LHRidC10L3QuNC1INC+0YLQv9GA0LDQstC70LXQvdC+JztcclxuICAgICAgICByZXBseSA9IHRydWU7XHJcbiAgICAgICAgb3ZlcmxheS5vcGVuKGNvbnRlbnQsIHJlcGx5KTtcclxuICAgICAgfVxyXG4gICAgfSlcclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHZhbGlkYXRlRm9ybShmb3JtKSB7XHJcbiAgbGV0IHZhbGlkID0gdHJ1ZTtcclxuICBpZighdmFsaWRhdGVGaWVsZChmb3JtLmVsZW1lbnRzLm5hbWUpKSB7XHJcbiAgICB2YWxpZCA9IGZhbHNlO1xyXG4gIH1cclxuICBpZighdmFsaWRhdGVGaWVsZChmb3JtLmVsZW1lbnRzLnBob25lKSkge1xyXG4gICAgdmFsaWQgPSBmYWxzZTtcclxuICB9XHJcbiAgaWYoIXZhbGlkYXRlRmllbGQoZm9ybS5lbGVtZW50cy50ZXh0YXJlYSkpIHtcclxuICAgIHZhbGlkID0gZmFsc2U7XHJcbiAgfVxyXG4gIHJldHVybiB2YWxpZDtcclxufVxyXG5mdW5jdGlvbiB2YWxpZGF0ZUZpZWxkKGZpZWxkKSB7XHJcbiAgZmllbGQubmV4dEVsZW1lbnRTaWJsaW5nLnRleHRDb250ZW50ID0gZmllbGQudmFsaWRhdGlvbk1lc3NhZ2U7XHJcbiAgcmV0dXJuIGZpZWxkLmNoZWNrVmFsaWRpdHkoKTtcclxufVxyXG5cclxubGV0IG9yZGVyQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3NlbmQnKTtcclxub3JkZXJCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBlID0+IHtcclxuICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgc3VibWl0Rm9ybSgpO1xyXG59KTsiLCIoZnVuY3Rpb24oKXtcclxuICBjb25zdCBpdGVtcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5yZXZpZXdzX19pdGVtJyk7XHJcbiAgY29uc3QgcGl4ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnJldmlld3NfX3BpeC1pdGVtJyk7XHJcbiAgbGV0IGFjdGl2ZSA9IDA7XHJcblxyXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgaXRlbXMubGVuZ3RoOyBpKyspIHtcclxuICAgIHBpeFtpXS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICBpdGVtc1tpXS5jbGFzc0xpc3QudG9nZ2xlKCdpcy1hY3RpdmUnKTtcclxuICAgICAgcGl4W2ldLmNsYXNzTGlzdC50b2dnbGUoJ2lzLWFjdGl2ZScpO1xyXG4gICAgIFxyXG4gICAgICBwaXhbYWN0aXZlXS5jbGFzc0xpc3QudG9nZ2xlKCdpcy1hY3RpdmUnKTtcclxuICAgICAgaXRlbXNbYWN0aXZlXS5jbGFzc0xpc3QudG9nZ2xlKCdpcy1hY3RpdmUnKTtcclxuICAgICAgYWN0aXZlID0gaTsgICAgIFxyXG4gICAgfSlcclxuICB9XHJcbn0oKSk7IiwibGV0IHZpZGVvUGxheWVyID0gZnVuY3Rpb24oKXtcclxuXHJcbiAgbGV0IHZpZGVvID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnZpZGVvX19jb250ZW50Jyk7XHJcbiAgbGV0IHBsYXlCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudmlkZW9fX2J0bicpO1xyXG4gIGxldCB2b2x1bWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudmlkZW9fX3ZvbHVtZScpO1xyXG4gIGxldCBwcm9ncmVzc0JhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy52aWRlb19fcHJvZ3Jlc3MnKTtcclxuICBsZXQgc3dpdGNoQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnZpZGVvX19wbGF5Jyk7XHJcbiAgbGV0IHBsYXlpbmcgPSBmYWxzZTtcclxuXHJcbiAgdmlkZW8ub250aW1ldXBkYXRlID0gZnVuY3Rpb24oKXtcclxuICAgIHByb2dyZXNzKCk7XHJcbiAgICBpZih2aWRlby5jdXJyZW50VGltZSA9PSB2aWRlby5kdXJhdGlvbil7XHJcbiAgICAgIHBhdXNlKCk7XHJcbiAgICB9XHJcbiAgfSBcclxuICBmdW5jdGlvbiBwbGF5KCkge1xyXG4gICAgdmlkZW8ucGxheSgpO1xyXG4gICAgcGxheWluZyA9IHRydWU7XHJcbiAgICBwbGF5QnRuLmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpO1xyXG4gICAgc3dpdGNoQnRuLmNsYXNzTGlzdC5hZGQoJ3N0b3AnKTtcclxuICB9XHJcbiAgZnVuY3Rpb24gcGF1c2UoKSB7XHJcbiAgICB2aWRlby5wYXVzZSgpO1xyXG4gICAgcGxheWluZyA9IGZhbHNlO1xyXG4gICAgcGxheUJ0bi5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTtcclxuICAgIHN3aXRjaEJ0bi5jbGFzc0xpc3QucmVtb3ZlKCdzdG9wJyk7XHJcbiAgfVxyXG4gIGZ1bmN0aW9uIHByb2dyZXNzKCl7XHJcbiAgICBsZXQgZHVyYXRpb24gPSB2aWRlby5kdXJhdGlvbjtcclxuICAgIGxldCB0aW1lID0gdmlkZW8uY3VycmVudFRpbWU7XHJcbiAgICBwcm9ncmVzc0Jhci52YWx1ZSA9ICh0aW1lL2R1cmF0aW9uKSoxMDA7XHJcbiAgfVxyXG5cclxuICBwbGF5QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oKXtcclxuICAgIGlmKCFwbGF5aW5nKSB7XHJcbiAgICAgIHBsYXkoKTtcclxuICAgIH1cclxuICB9KTtcclxuICB2aWRlby5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCl7XHJcbiAgICAgIGlmKHBsYXlpbmcpIHtcclxuICAgICAgICBwYXVzZSgpO1xyXG4gICAgICB9XHJcbiAgfSk7XHJcbiAgdm9sdW1lLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgZnVuY3Rpb24oKXtcclxuICAgIGxldCB2YWx1ZSA9IHRoaXMudmFsdWU7XHJcbiAgICB2aWRlby52b2x1bWUgPSB2YWx1ZS8xMDA7XHJcbiAgfSlcclxuICBwcm9ncmVzc0Jhci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcclxuICAgIGxldCB3aWR0aCA9IHByb2dyZXNzQmFyLm9mZnNldFdpZHRoO1xyXG4gICAgbGV0IHBvcyA9IGUub2Zmc2V0WDtcclxuICAgIHByb2dyZXNzQmFyLnZhbHVlID0gKHBvcy93aWR0aCkqMTAwO1xyXG4gICAgdmlkZW8ucGF1c2UoKTtcclxuICAgIHZpZGVvLmN1cnJlbnRUaW1lID0gdmlkZW8uZHVyYXRpb24qKHBvcy93aWR0aCk7XHJcbiAgICB2aWRlby5wbGF5KCk7XHJcbiAgfSlcclxuICBzd2l0Y2hCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLGZ1bmN0aW9uKCl7XHJcbiAgICBpZighcGxheWluZykge1xyXG4gICAgICBwbGF5KCk7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmKHBsYXlpbmcpIHtcclxuICAgICAgcGF1c2UoKTtcclxuICAgICAgdmlkZW8uY3VycmVudFRpbWUgPSAwO1xyXG4gICAgfVxyXG4gIH0pXHJcblxyXG59XHJcbnZpZGVvUGxheWVyKCk7XHJcbiJdfQ==
