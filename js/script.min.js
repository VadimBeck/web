!function(){!function(){let e=document.querySelector(".team__list");e.addEventListener("click",function(t){if(t.preventDefault(),t.target.classList.contains("member__link")){let n=t.target,i=e.querySelector(".member.is-active");if(i&&(i.querySelector(".member__text").style.height="0px",i.classList.remove("is-active")),!i||i.querySelector(".member__link")!=n){let e=n.closest(".member");e.classList.add("is-active");let t=e.querySelector(".member__text");t.style.height=t.scrollHeight+"px"}}})}(),function(){let e=document.querySelectorAll(".menu__block"),t=document.querySelector("body");e.forEach(function(e){e.addEventListener("click",function(e){e.preventDefault();let n=this,i=document.querySelector(".menu__item.is-active");if(i&&(i.querySelector(".menu__desc").style.width="0px",i.classList.remove("is-active")),!i||i.querySelector(".menu__block")!=n){let e=n.closest(".menu__item");e.classList.add("is-active");let i=e.querySelector(".menu__desc");t.offsetWidth>480?i.style.width=function(){let e=document.documentElement.clientWidth,t=document.querySelectorAll(".menu__block"),n=e-parseFloat(getComputedStyle(t[0]).width)*t.length;return n>550?550:n}()+"px":i.style.width="auto"}})})}()}(),$(function(){let e=$(".candy-bar__slider");$(".scroll-btn").on("click",function(t){t.preventDefault();let n,i,o=$(this),l=e.find(".candy-bar__item"),c=l.filter(".active");o.hasClass("scroll-btn--forward")&&(n=c.next(),i=l.first()),o.hasClass("scroll-btn--back")&&(n=c.prev(),i=l.last()),function(t){let n=e.find(".candy-bar__item"),i=n.filter(".active"),o=n.eq(t),l=o.index(),c=e.find(".candy-bar__list");o.length&&c.animate({left:100*-l+"%"},500,function(){i.removeClass("active"),o.addClass("active")})}(n.length?n.index():i.index())})}),ymaps.ready(init);var geoObjects=[],marks=[{latitude:55.7587,longitude:37.5828,hintContent:'<div class="map__hint">Кудринская площадь д.1</div>'},{latitude:55.7427,longitude:37.5799,hintContent:'<div class="map__hint">ул.Плющиха д.11</div>'},{latitude:55.7574,longitude:37.6208,hintContent:'<div class="map__hint">Площадь Революции д.1</div>'},{latitude:55.75,longitude:37.6037,hintContent:'<div class="map__hint">Большой Знаменский пер. д.23</div>'}];function init(){var e=new ymaps.Map("map",{center:[55.75269656,37.59427083],zoom:14,controls:["zoomControl"],behaviors:["drag"]});for(let e=0;e<marks.length;e++)geoObjects[e]=new ymaps.Placemark([marks[e].latitude,marks[e].longitude],{hintContent:marks[e].hintContent},{iconLayout:"default#image",iconImageHref:"../img/marker.png",iconImageSize:[46,57],iconImageOffset:[-23,-57]});var t=new ymaps.Clusterer({clusterIcons:[{href:"../img/marker.png",size:[46,57],offset:[-23,-57]}],clusterIconContentLayout:null});e.geoObjects.add(t),t.add(geoObjects)}const menu=function(){let e=document.querySelector(".menu-btn"),t=document.querySelector(".header"),n=document.querySelector("body"),i=document.querySelector(".nav__list"),o=!1;function l(){e.classList.toggle("is-active"),t.classList.toggle("is-active"),n.classList.toggle("locked"),o=!o}return document.addEventListener("keydown",function(e){27==e.keyCode&&o&&l()}),{menuOver:function(){e.addEventListener("click",l),i.addEventListener("click",function(e){e.target.classList.contains("nav__link")&&n.offsetWidth<=768&&l()})}}}();menu.menuOver();let OnePageScroll=function(){const e=document,t=e.querySelector(".wrapper"),n=e.querySelector("#content"),i=e.querySelectorAll(".section");let o,l=e.querySelectorAll(".nav__link"),c=e.querySelectorAll(".listing__item"),a=!1;function s(t){if(!a){a=!0;let i=-100*t+"%";n.style.top=i,e.querySelector(".listing__item.is-active").classList.remove("is-active"),c[t].classList.add("is-active"),setTimeout(function(){a=!1},900)}}function r(e){let t=n.style.top?-parseInt(n.style.top,10)/100:0;"up"==e&&t>0&&s(t-1),"down"==e&&t<i.length-1&&s(t+1)}t.addEventListener("wheel",function(e){r(e.deltaY<0?"up":"down")}),t.addEventListener("touchmove",function(e){e.preventDefault()}),t.addEventListener("touchstart",function(e){/Android|AppleWebKit|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&(o=e.touches[0].clientY)},!1),t.addEventListener("touchend",function(e){let t=e.changedTouches[0].clientY-o;if(Math.abs(t)>50){r(t>0?"up":"down")}},!1),l.forEach(function(e){e.addEventListener("click",function(e){e.preventDefault(),s(this.dataset.index)})}),c.forEach(function(e){e.addEventListener("click",function(e){e.preventDefault(),link=e.target,s(link.dataset.index)})}),e.querySelector(".intro-button").addEventListener("click",function(e){e.preventDefault(),s(7)}),e.addEventListener("keyup",function(e){let t;38==e.keyCode&&(t="up"),40==e.keyCode&&(t="down"),r(t)})};OnePageScroll();const overlay=function(){let e=document.querySelector("body"),t=document.querySelector(".modal"),n=document.querySelector(".modal__inner"),i=document.createElement("div");i.classList.add("modal__text");let o=function(){t.classList.remove("is-active"),e.classList.remove("locked")};return{open:function(l,c){let a=document.createElement("button");i.textContent=l,n.innerHTML="",c?(a.classList.add("order-button"),a.textContent="Закрыть"):a.classList.add("modal__close"),n.appendChild(i),n.appendChild(a),t.classList.add("is-active"),e.classList.add("locked"),a.addEventListener("click",e=>{e.preventDefault(),o()}),t.addEventListener("click",e=>{e.target===t&&o()}),document.addEventListener("keydown",e=>{27===e.keyCode&&o()})},close:o}}(),ajaxForm=function(e){let t=new FormData;t.append("name",e.elements.name.value),t.append("phone",e.elements.phone.value),t.append("comment",e.elements.textarea.value),t.append("to","client@mail.ru");const n=new XMLHttpRequest;return n.responseType="json",n.open("POST","https://webdev-api.loftschool.com/sendmail"),n.setRequestHeader("X-Requested-With","XMLHttpRequest"),n.send(t),n},submitForm=function(){let e=document.querySelector("#order-form");if(validateForm(e)){let t=ajaxForm(e);t.addEventListener("load",()=>{let e=!1;if(t.status>=400){let n="Ошибка соединения с сервером, попробуйте позже";overlay.open(`${n}. Ошибка ${t.status}`,e)}else 0==t.response.status?(content=t.response.message,overlay.open(content,e)):(content="Сообщение отправлено",e=!0,overlay.open(content,e))})}};function validateForm(e){let t=!0;return validateField(e.elements.name)||(t=!1),validateField(e.elements.phone)||(t=!1),validateField(e.elements.textarea)||(t=!1),t}function validateField(e){return e.nextElementSibling.textContent=e.validationMessage,e.checkValidity()}let orderBtn=document.querySelector("#send");orderBtn.addEventListener("click",e=>{e.preventDefault(),submitForm()}),function(){const e=document.querySelectorAll(".reviews__item"),t=document.querySelectorAll(".reviews__pix-item");let n=0;for(let i=0;i<e.length;i++)t[i].addEventListener("click",function(o){o.preventDefault(),e[i].classList.toggle("is-active"),t[i].classList.toggle("is-active"),t[n].classList.toggle("is-active"),e[n].classList.toggle("is-active"),n=i})}(),document.addEventListener("DOMContentLoaded",function(){!function(){let e=document.querySelector(".video__content"),t=document.querySelector(".video__btn"),n=document.querySelector(".video__range--volume"),i=document.querySelector(".video__range--progress"),o=document.querySelector(".video__play"),l=!1;function c(){e.play(),l=!0,t.classList.add("hidden"),o.classList.add("stop")}function a(){e.pause(),l=!1,t.classList.remove("hidden"),o.classList.remove("stop")}e.ontimeupdate=function(){!function(){let t=e.duration,n=e.currentTime;i.value=n/t*100}(),e.currentTime==e.duration&&a()},t.addEventListener("click",function(){l||c()}),e.addEventListener("click",function(){l&&a()}),n.addEventListener("input",function(){let t=this.value;e.volume=t/100}),i.addEventListener("click",function(t){let n=i.offsetWidth,o=t.offsetX;i.value=o/n*100,e.pause(),e.currentTime=e.duration*(o/n),e.play()}),o.addEventListener("click",function(){l?l&&(a(),e.currentTime=0):c()})}()},!1);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFjY29yZGVvbi5qcyIsImpxdWVyeVNsaWRlci5qcyIsIm1hcC5qcyIsIm1lbnUuanMiLCJvcHMuanMiLCJyZXF1ZXN0LmpzIiwic2xpZGVzaG93LmpzIiwidmlkZW8uanMiXSwibmFtZXMiOlsidGVhbSIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwicHJldmVudERlZmF1bHQiLCJ0YXJnZXQiLCJjbGFzc0xpc3QiLCJjb250YWlucyIsImxpbmsiLCJhY3RpdmUiLCJzdHlsZSIsImhlaWdodCIsInJlbW92ZSIsImN1cnJlbnQiLCJjbG9zZXN0IiwiYWRkIiwiY3VycmVudFRleHQiLCJzY3JvbGxIZWlnaHQiLCJhY3RpdmF0ZVRlYW0iLCJsaW5rcyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJib2R5IiwiZm9yRWFjaCIsImVsZW0iLCJ0aGlzIiwid2lkdGgiLCJvZmZzZXRXaWR0aCIsImRvY3VtZW50RWxlbWVudCIsImNsaWVudFdpZHRoIiwicmVxV2lkdGgiLCJwYXJzZUZsb2F0IiwiZ2V0Q29tcHV0ZWRTdHlsZSIsImxlbmd0aCIsIndpZHRoQ2FsYyIsImFjdGl2YXRlTWVudSIsIiQiLCJzbGlkZXIiLCJvbiIsImV4aXN0ZWRJdGVtIiwiZWRnZUl0ZW0iLCIkdGhpcyIsIml0ZW1zIiwiZmluZCIsImFjdGl2ZUl0ZW0iLCJmaWx0ZXIiLCJoYXNDbGFzcyIsIm5leHQiLCJmaXJzdCIsInByZXYiLCJsYXN0IiwibnVtIiwicmVxSXRlbSIsImVxIiwicmVxSW5kZXgiLCJpbmRleCIsImxpc3QiLCJhbmltYXRlIiwibGVmdCIsInJlbW92ZUNsYXNzIiwiYWRkQ2xhc3MiLCJtb3ZlU2xpZGUiLCJ5bWFwcyIsInJlYWR5IiwiaW5pdCIsImdlb09iamVjdHMiLCJtYXJrcyIsImxhdGl0dWRlIiwibG9uZ2l0dWRlIiwiaGludENvbnRlbnQiLCJtYXAiLCJNYXAiLCJjZW50ZXIiLCJ6b29tIiwiY29udHJvbHMiLCJiZWhhdmlvcnMiLCJpIiwiUGxhY2VtYXJrIiwiaWNvbkxheW91dCIsImljb25JbWFnZUhyZWYiLCJpY29uSW1hZ2VTaXplIiwiaWNvbkltYWdlT2Zmc2V0IiwiY2x1c3RlcmVyIiwiQ2x1c3RlcmVyIiwiY2x1c3Rlckljb25zIiwiaHJlZiIsInNpemUiLCJvZmZzZXQiLCJjbHVzdGVySWNvbkNvbnRlbnRMYXlvdXQiLCJtZW51IiwiYnV0dG9uIiwiaGVhZGVyIiwibmF2IiwiYWN0IiwidG9nZ2xlTWVudSIsInRvZ2dsZSIsImtleUNvZGUiLCJtZW51T3ZlciIsIk9uZVBhZ2VTY3JvbGwiLCJkIiwid3JhcHBlciIsImNvbnRlbnQiLCJzZWN0aW9ucyIsImNsaWVudFkiLCJtZW51TGlua3MiLCJwb2ludHMiLCJwYXVzZSIsIm1vdmVDb250ZW50IiwicG9zIiwidG9wIiwic2V0VGltZW91dCIsInNjcm9sbCIsIndheSIsImN1cnJlbnRQb3MiLCJwYXJzZUludCIsImRlbHRhWSIsInRlc3QiLCJuYXZpZ2F0b3IiLCJ1c2VyQWdlbnQiLCJ0b3VjaGVzIiwiY2hhbmdlZFRvdWNoZXMiLCJNYXRoIiwiYWJzIiwiZGF0YXNldCIsIm92ZXJsYXkiLCJtb2RhbCIsIm1vZGFsSW5uZXIiLCJtb2RhbFRleHQiLCJjcmVhdGVFbGVtZW50IiwiY2xvc2VPdmVybGF5Iiwib3BlbiIsInJlcGx5IiwidGV4dENvbnRlbnQiLCJpbm5lckhUTUwiLCJhcHBlbmRDaGlsZCIsImNsb3NlIiwiYWpheEZvcm0iLCJmb3JtIiwiZGF0YSIsIkZvcm1EYXRhIiwiYXBwZW5kIiwiZWxlbWVudHMiLCJuYW1lIiwidmFsdWUiLCJwaG9uZSIsInRleHRhcmVhIiwieGhyIiwiWE1MSHR0cFJlcXVlc3QiLCJyZXNwb25zZVR5cGUiLCJzZXRSZXF1ZXN0SGVhZGVyIiwic2VuZCIsInN1Ym1pdEZvcm0iLCJ2YWxpZGF0ZUZvcm0iLCJyZXF1ZXN0Iiwic3RhdHVzIiwicmVzcG9uc2UiLCJtZXNzYWdlIiwidmFsaWQiLCJ2YWxpZGF0ZUZpZWxkIiwiZmllbGQiLCJuZXh0RWxlbWVudFNpYmxpbmciLCJ2YWxpZGF0aW9uTWVzc2FnZSIsImNoZWNrVmFsaWRpdHkiLCJvcmRlckJ0biIsInBpeCIsInZpZGVvIiwicGxheUJ0biIsInZvbHVtZSIsInByb2dyZXNzQmFyIiwic3dpdGNoQnRuIiwicGxheWluZyIsInBsYXkiLCJvbnRpbWV1cGRhdGUiLCJkdXJhdGlvbiIsInRpbWUiLCJjdXJyZW50VGltZSIsInByb2dyZXNzIiwib2Zmc2V0WCIsInZpZGVvUGxheWVyIl0sIm1hcHBpbmdzIjoiQ0FBQSxZQVdBLFdBQ0EsSUFBQUEsRUFBQUMsU0FBQUMsY0FBQSxlQUNBRixFQUFBRyxpQkFBQSxRQUFBLFNBQUFDLEdBRUEsR0FEQUEsRUFBQUMsaUJBQ0FELEVBQUFFLE9BQUFDLFVBQUFDLFNBQUEsZ0JBQUEsQ0FDQSxJQUFBQyxFQUFBTCxFQUFBRSxPQUVBSSxFQUFBVixFQUFBRSxjQUFBLHFCQU9BLEdBTEFRLElBQ0FBLEVBQUFSLGNBQUEsaUJBQ0FTLE1BQUFDLE9BQUEsTUFDQUYsRUFBQUgsVUFBQU0sT0FBQSxlQUVBSCxHQUFBQSxFQUFBUixjQUFBLGtCQUFBTyxFQUFBLENBQ0EsSUFBQUssRUFBQUwsRUFBQU0sUUFBQSxXQUNBRCxFQUFBUCxVQUFBUyxJQUFBLGFBRUEsSUFBQUMsRUFBQUgsRUFBQVosY0FBQSxpQkFDQWUsRUFBQU4sTUFBQUMsT0FBQUssRUFBQUMsYUFBQSxTQUtBQyxHQUVBLFdBQ0EsSUFBQUMsRUFBQW5CLFNBQUFvQixpQkFBQSxnQkFDQUMsRUFBQXJCLFNBQUFDLGNBQUEsUUFDQWtCLEVBQUFHLFFBQUEsU0FBQUMsR0FDQUEsRUFBQXJCLGlCQUFBLFFBQUEsU0FBQUMsR0FDQUEsRUFBQUMsaUJBQ0EsSUFBQUksRUFBQWdCLEtBQ0FmLEVBQUFULFNBQUFDLGNBQUEseUJBUUEsR0FOQVEsSUFDQUEsRUFBQVIsY0FBQSxlQUNBUyxNQUFBZSxNQUFBLE1BQ0FoQixFQUFBSCxVQUFBTSxPQUFBLGVBR0FILEdBQUFBLEVBQUFSLGNBQUEsaUJBQUFP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d0ssR0FBQSxFQVFBLFNBQUFDLElBQ0FOLEVBQUFNLE9BQ0FELEdBQUEsRUFDQUosRUFBQS9KLFVBQUFTLElBQUEsVUFDQXlKLEVBQUFsSyxVQUFBUyxJQUFBLFFBRUEsU0FBQTBGLElBQ0EyRCxFQUFBM0QsUUFDQWdFLEdBQUEsRUFDQUosRUFBQS9KLFVBQUFNLE9BQUEsVUFDQTRKLEVBQUFsSyxVQUFBTSxPQUFBLFFBaEJBd0osRUFBQU8sYUFBQSxZQWtCQSxXQUNBLElBQUFDLEVBQUFSLEVBQUFRLFNBQ0FDLEVBQUFULEVBQUFVLFlBQ0FQLEVBQUF6QixNQUFBK0IsRUFBQUQsRUFBQSxJQXBCQUcsR0FDQVgsRUFBQVUsYUFBQVYsRUFBQVEsVUFDQW5FLEtBcUJBNEQsRUFBQW5LLGlCQUFBLFFBQUEsV0FDQXVLLEdBQ0FDLE1BR0FOLEVBQUFsSyxpQkFBQSxRQUFBLFdBQ0F1SyxHQUNBaEUsTUFHQTZELEVBQUFwSyxpQkFBQSxRQUFBLFdBQ0EsSUFBQTRJLEVBQUF0SCxLQUFBc0gsTUFDQXNCLEVBQUFFLE9BQUF4QixFQUFBLE1BRUF5QixFQUFBckssaUJBQUEsUUFBQSxTQUFBQyxHQUNBLElBQUFzQixFQUFBOEksRUFBQTdJLFlBQ0FpRixFQUFBeEcsRUFBQTZLLFFBQ0FULEVBQUF6QixNQUFBbkMsRUFBQWxGLEVBQUEsSUFDQTJJLEVBQUEzRCxRQUNBMkQsRUFBQVUsWUFBQVYsRUFBQVEsVUFBQWpFLEVBQUFsRixHQUNBMkksRUFBQU0sU0FFQUYsRUFBQXRLLGlCQUFBLFFBQUEsV0FDQXVLLEVBR0FBLElBQ0FoRSxJQUNBMkQsRUFBQVUsWUFBQSxHQUpBSixNQVNBTyxLQUNBIiwiZmlsZSI6InNjcmlwdC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24oKXtcclxuXHJcbiAgZnVuY3Rpb24gd2lkdGhDYWxjKCkge1xyXG4gICAgbGV0IHdpZHRoID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudFdpZHRoO1xyXG4gICAgbGV0IGxpbmtzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLm1lbnVfX2Jsb2NrJyk7XHJcbiAgICBsZXQgbGlua1dpZHRoID0gcGFyc2VGbG9hdChnZXRDb21wdXRlZFN0eWxlKGxpbmtzWzBdKS53aWR0aCk7XHJcblxyXG4gICAgbGV0IHJlcVdpZHRoID0gd2lkdGggLSBsaW5rV2lkdGggKiBsaW5rcy5sZW5ndGg7XHJcbiAgICByZXR1cm4gcmVxV2lkdGggPiA1NTAgPyA1NTAgOiByZXFXaWR0aDtcclxuICB9XHJcbiAgXHJcbiAgZnVuY3Rpb24gYWN0aXZhdGVUZWFtKCkge1xyXG4gICAgbGV0IHRlYW0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudGVhbV9fbGlzdCcpOyAgIFxyXG4gICAgdGVhbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGUpe1xyXG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICBpZihlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ21lbWJlcl9fbGluaycpKXtcclxuICAgICAgICBsZXQgbGluayA9IGUudGFyZ2V0O1xyXG5cclxuICAgICAgICBsZXQgYWN0aXZlID0gdGVhbS5xdWVyeVNlbGVjdG9yKCcubWVtYmVyLmlzLWFjdGl2ZScpO1xyXG5cclxuICAgICAgICBpZihhY3RpdmUpIHtcclxuICAgICAgICAgIGxldCBhY3RpdmVUZXh0ID0gYWN0aXZlLnF1ZXJ5U2VsZWN0b3IoJy5tZW1iZXJfX3RleHQnKTsgICAgICAgICAgXHJcbiAgICAgICAgICBhY3RpdmVUZXh0LnN0eWxlLmhlaWdodCA9ICcwcHgnO1xyXG4gICAgICAgICAgYWN0aXZlLmNsYXNzTGlzdC5yZW1vdmUoJ2lzLWFjdGl2ZScpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZighYWN0aXZlIHx8IGFjdGl2ZS5xdWVyeVNlbGVjdG9yKCcubWVtYmVyX19saW5rJykgIT0gbGluaykge1xyXG4gICAgICAgICAgbGV0IGN1cnJlbnQgID0gbGluay5jbG9zZXN0KCcubWVtYmVyJyk7XHJcbiAgICAgICAgICBjdXJyZW50LmNsYXNzTGlzdC5hZGQoJ2lzLWFjdGl2ZScpO1xyXG5cclxuICAgICAgICAgIGxldCBjdXJyZW50VGV4dCA9IGN1cnJlbnQucXVlcnlTZWxlY3RvcignLm1lbWJlcl9fdGV4dCcpO1xyXG4gICAgICAgICAgY3VycmVudFRleHQuc3R5bGUuaGVpZ2h0ID0gY3VycmVudFRleHQuc2Nyb2xsSGVpZ2h0ICsgJ3B4JztcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0pICAgIFxyXG4gIH1cclxuICBhY3RpdmF0ZVRlYW0oKVxyXG5cclxuICBmdW5jdGlvbiBhY3RpdmF0ZU1lbnUoKSB7XHJcbiAgICBsZXQgbGlua3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcubWVudV9fYmxvY2snKTtcclxuICAgIGxldCBib2R5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignYm9keScpOyAgXHJcbiAgICBsaW5rcy5mb3JFYWNoKGZ1bmN0aW9uKGVsZW0pe1xyXG4gICAgICBlbGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZSl7XHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIGxldCBsaW5rID0gdGhpczsgICAgICAgIFxyXG4gICAgICAgIGxldCBhY3RpdmUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubWVudV9faXRlbS5pcy1hY3RpdmUnKTtcclxuXHJcbiAgICAgICAgaWYoYWN0aXZlKSB7XHJcbiAgICAgICAgICBsZXQgYWN0aXZlVGV4dCA9IGFjdGl2ZS5xdWVyeVNlbGVjdG9yKCcubWVudV9fZGVzYycpOyAgICAgICAgICBcclxuICAgICAgICAgIGFjdGl2ZVRleHQuc3R5bGUud2lkdGggPSAnMHB4JztcclxuICAgICAgICAgIGFjdGl2ZS5jbGFzc0xpc3QucmVtb3ZlKCdpcy1hY3RpdmUnKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmKCFhY3RpdmUgfHwgYWN0aXZlLnF1ZXJ5U2VsZWN0b3IoJy5tZW51X19ibG9jaycpICE9IGxpbmspIHtcclxuICAgICAgICAgIGxldCBjdXJyZW50ICA9IGxpbmsuY2xvc2VzdCgnLm1lbnVfX2l0ZW0nKTtcclxuICAgICAgICAgIGN1cnJlbnQuY2xhc3NMaXN0LmFkZCgnaXMtYWN0aXZlJyk7XHJcblxyXG4gICAgICAgICAgbGV0IGN1cnJlbnRUZXh0ID0gY3VycmVudC5xdWVyeVNlbGVjdG9yKCcubWVudV9fZGVzYycpO1xyXG4gICAgICAgICAgaWYgKGJvZHkub2Zmc2V0V2lkdGggPiA0ODApIHtcclxuICAgICAgICAgIGN1cnJlbnRUZXh0LnN0eWxlLndpZHRoID0gd2lkdGhDYWxjKCkgKyAncHgnO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY3VycmVudFRleHQuc3R5bGUud2lkdGggPSAnYXV0byc7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSAgICAgIFxyXG4gICAgICB9KVxyXG4gICAgfSlcclxuICB9XHJcbiAgYWN0aXZhdGVNZW51KCk7ICBcclxufSgpKTtcclxuXHJcblxyXG4gICIsIiQoZnVuY3Rpb24gKCkge1xyXG4gICAgbGV0IHNsaWRlciA9ICQoJy5jYW5keS1iYXJfX3NsaWRlcicpO1xyXG4gICAgXHJcbiAgbGV0IG1vdmVTbGlkZSA9IGZ1bmN0aW9uKG51bSkge1xyXG4gICAgbGV0IGl0ZW1zID0gc2xpZGVyLmZpbmQoJy5jYW5keS1iYXJfX2l0ZW0nKTtcclxuICAgIGxldCBhY3RpdmVJdGVtID0gaXRlbXMuZmlsdGVyKCcuYWN0aXZlJyk7XHJcbiAgICBsZXQgcmVxSXRlbSA9IGl0ZW1zLmVxKG51bSk7XHJcbiAgICBsZXQgcmVxSW5kZXggPSByZXFJdGVtLmluZGV4KCk7XHJcbiAgICBsZXQgbGlzdCA9IHNsaWRlci5maW5kKCcuY2FuZHktYmFyX19saXN0Jyk7XHJcbiAgICBsZXQgZHVyYXRpb24gPSA1MDA7XHJcbiAgICBpZiAocmVxSXRlbS5sZW5ndGgpIHtcclxuICAgICAgbGlzdC5hbmltYXRlKHtcclxuICAgICAgICAnbGVmdCc6IC1yZXFJbmRleCAqIDEwMCArJyUnXHJcbiAgICAgIH0sIGR1cmF0aW9uLCBmdW5jdGlvbigpIHtcclxuICAgICAgICBhY3RpdmVJdGVtLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgICByZXFJdGVtLmFkZENsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgfSlcclxuICAgIH1cclxuICB9XHJcbiAgXHJcbiAgJCgnLnNjcm9sbC1idG4nKS5vbignY2xpY2snLCBmdW5jdGlvbihlKSB7XHJcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICBsZXQgJHRoaXMgPSAkKHRoaXMpO1xyXG4gICAgbGV0IGl0ZW1zID0gc2xpZGVyLmZpbmQoJy5jYW5keS1iYXJfX2l0ZW0nKTtcclxuICAgIGxldCBhY3RpdmVJdGVtID0gaXRlbXMuZmlsdGVyKCcuYWN0aXZlJyk7XHJcbiAgICBsZXQgZXhpc3RlZEl0ZW07XHJcbiAgICBsZXQgZWRnZUl0ZW07XHJcblxyXG4gICAgaWYgKCR0aGlzLmhhc0NsYXNzKCdzY3JvbGwtYnRuLS1mb3J3YXJkJykpIHtcclxuICAgICAgZXhpc3RlZEl0ZW0gPSBhY3RpdmVJdGVtLm5leHQoKTtcclxuICAgICAgZWRnZUl0ZW0gPSBpdGVtcy5maXJzdCgpOyAgICAgXHJcbiAgICB9IFxyXG4gICAgaWYgKCR0aGlzLmhhc0NsYXNzKCdzY3JvbGwtYnRuLS1iYWNrJykpIHtcclxuICAgICAgZXhpc3RlZEl0ZW0gPSBhY3RpdmVJdGVtLnByZXYoKTtcclxuICAgICAgZWRnZUl0ZW0gPSBpdGVtcy5sYXN0KCk7ICAgICAgXHJcbiAgICB9XHJcblxyXG4gICAgbGV0IHJlcUl0ZW0gPSBleGlzdGVkSXRlbS5sZW5ndGggPyBleGlzdGVkSXRlbS5pbmRleCgpIDogZWRnZUl0ZW0uaW5kZXgoKTtcclxuICAgIG1vdmVTbGlkZShyZXFJdGVtKTtcclxuICAgIH0pXHJcbn0pIiwieW1hcHMucmVhZHkoaW5pdCk7XHJcbiAgdmFyIGdlb09iamVjdHM9IFtdO1xyXG4gIHZhciBtYXJrcyA9IFtcclxuICAgIHtcclxuICAgICAgbGF0aXR1ZGU6IDU1Ljc1ODcsXHJcbiAgICAgIGxvbmdpdHVkZTogMzcuNTgyOCxcclxuICAgICAgaGludENvbnRlbnQ6ICc8ZGl2IGNsYXNzPVwibWFwX19oaW50XCI+0JrRg9C00YDQuNC90YHQutCw0Y8g0L/Qu9C+0YnQsNC00Ywg0LQuMTwvZGl2PicsXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICBsYXRpdHVkZTogNTUuNzQyNyxcclxuICAgICAgbG9uZ2l0dWRlOiAzNy41Nzk5LFxyXG4gICAgICBoaW50Q29udGVudDogJzxkaXYgY2xhc3M9XCJtYXBfX2hpbnRcIj7Rg9C7LtCf0LvRjtGJ0LjRhdCwINC0LjExPC9kaXY+JyxcclxuICAgIH0sXHJcbiAgICB7XHJcbiAgICAgIGxhdGl0dWRlOiA1NS43NTc0LFxyXG4gICAgICBsb25naXR1ZGU6IDM3LjYyMDgsXHJcbiAgICAgIGhpbnRDb250ZW50OiAnPGRpdiBjbGFzcz1cIm1hcF9faGludFwiPtCf0LvQvtGJ0LDQtNGMINCg0LXQstC+0LvRjtGG0LjQuCDQtC4xPC9kaXY+JyxcclxuICAgIH0sXHJcbiAgICB7XHJcbiAgICAgIGxhdGl0dWRlOiA1NS43NTAwLFxyXG4gICAgICBsb25naXR1ZGU6IDM3LjYwMzcsXHJcbiAgICAgIGhpbnRDb250ZW50OiAnPGRpdiBjbGFzcz1cIm1hcF9faGludFwiPtCR0L7Qu9GM0YjQvtC5INCX0L3QsNC80LXQvdGB0LrQuNC5INC/0LXRgC4g0LQuMjM8L2Rpdj4nLFxyXG4gICAgfVxyXG4gIF1cclxuXHJcbmZ1bmN0aW9uIGluaXQoKSB7XHJcbiAgdmFyIG1hcCA9IG5ldyB5bWFwcy5NYXAoJ21hcCcsIHtcclxuICAgIGNlbnRlcjogWzU1Ljc1MjY5NjU2LCAzNy41OTQyNzA4M10sXHJcbiAgICB6b29tOiAxNCxcclxuICAgIGNvbnRyb2xzOiBbJ3pvb21Db250cm9sJ10sXHJcbiAgICBiZWhhdmlvcnM6IFsnZHJhZyddXHJcbiAgfSk7XHJcbiAgZm9yIChsZXQgaT0wOyBpPG1hcmtzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICBnZW9PYmplY3RzW2ldID0gbmV3IHltYXBzLlBsYWNlbWFyayhbbWFya3NbaV0ubGF0aXR1ZGUsIG1hcmtzW2ldLmxvbmdpdHVkZV0sXHJcbiAgICAgIHtcclxuICAgICAgICBoaW50Q29udGVudDogbWFya3NbaV0uaGludENvbnRlbnRcclxuICAgICAgfSxcclxuICAgICAge1xyXG4gICAgICAgIGljb25MYXlvdXQ6ICdkZWZhdWx0I2ltYWdlJyxcclxuICAgICAgICBpY29uSW1hZ2VIcmVmOiAnLi4vaW1nL21hcmtlci5wbmcnLFxyXG4gICAgICAgIGljb25JbWFnZVNpemU6IFs0NiwgNTddLFxyXG4gICAgICAgIGljb25JbWFnZU9mZnNldDogWy0yMywgLTU3XVxyXG4gICAgICB9KTtcclxuICB9XHJcbiAgdmFyIGNsdXN0ZXJlciA9IG5ldyB5bWFwcy5DbHVzdGVyZXIoe1xyXG4gICAgY2x1c3Rlckljb25zOiBbXHJcbiAgICAgIHtcclxuICAgICAgICBocmVmOiAnLi4vaW1nL21hcmtlci5wbmcnLFxyXG4gICAgICAgIHNpemU6IFs0NiwgNTddLFxyXG4gICAgICAgIG9mZnNldDogWy0yMywgLTU3XVxyXG4gICAgICB9XHJcbiAgICBdLFxyXG4gICAgY2x1c3Rlckljb25Db250ZW50TGF5b3V0OiBudWxsXHJcbiAgfSk7XHJcbiAgbWFwLmdlb09iamVjdHMuYWRkKGNsdXN0ZXJlcik7XHJcbiAgY2x1c3RlcmVyLmFkZChnZW9PYmplY3RzKTtcclxufSIsImNvbnN0IG1lbnUgPSAoZnVuY3Rpb24oKSB7XHJcbiAgbGV0IGJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tZW51LWJ0bicpO1xyXG4gIGxldCBoZWFkZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaGVhZGVyJyk7XHJcbiAgbGV0IGJvZHkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdib2R5Jyk7XHJcbiAgbGV0IG5hdiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5uYXZfX2xpc3QnKTtcclxuICBsZXQgYWN0ID0gZmFsc2U7XHJcblxyXG4gIGZ1bmN0aW9uIHRvZ2dsZU1lbnUoKSB7XHJcbiAgICAgIGJ1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKCdpcy1hY3RpdmUnKTtcclxuICAgICAgaGVhZGVyLmNsYXNzTGlzdC50b2dnbGUoJ2lzLWFjdGl2ZScpO1xyXG4gICAgICBib2R5LmNsYXNzTGlzdC50b2dnbGUoJ2xvY2tlZCcpO1xyXG5cclxuICAgICAgYWN0ID8gYWN0ID0gZmFsc2UgOiBhY3QgPSB0cnVlO1xyXG4gIH1cclxuXHJcbiAgbGV0IGFkZExpc3RlbmVycyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRvZ2dsZU1lbnUpO1xyXG5cclxuICAgICAgICBuYXYuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihlKXtcclxuICAgICAgICAgIGxldCB0YXJnZXQgPSBlLnRhcmdldDtcclxuICAgICAgICAgIGlmICh0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCduYXZfX2xpbmsnKSAmJiBib2R5Lm9mZnNldFdpZHRoIDw9IDc2OCkge1xyXG4gICAgICAgICAgICB0b2dnbGVNZW51KCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGZ1bmN0aW9uKGUpe1xyXG4gICAgICAgIGlmIChlLmtleUNvZGUgPT0gMjcgJiYgYWN0KSB7XHJcbiAgICAgICAgICB0b2dnbGVNZW51KCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KVxyXG4gIHJldHVybiB7XHJcbiAgICBtZW51T3ZlcjogYWRkTGlzdGVuZXJzICBcclxuICB9XHJcbn0oKSk7XHJcbm1lbnUubWVudU92ZXIoKTsiLCJsZXQgT25lUGFnZVNjcm9sbCA9IGZ1bmN0aW9uKCl7XHJcbiAgY29uc3QgZCA9IGRvY3VtZW50O1xyXG4gIGNvbnN0IHdyYXBwZXIgPSBkLnF1ZXJ5U2VsZWN0b3IoJy53cmFwcGVyJyk7XHJcbiAgY29uc3QgY29udGVudCA9IGQucXVlcnlTZWxlY3RvcignI2NvbnRlbnQnKTtcclxuICBjb25zdCBzZWN0aW9ucyA9IGQucXVlcnlTZWxlY3RvckFsbCgnLnNlY3Rpb24nKTtcclxuICBsZXQgbWVudUxpbmtzID0gZC5xdWVyeVNlbGVjdG9yQWxsKCcubmF2X19saW5rJyk7ICBcclxuICBsZXQgcG9pbnRzID0gZC5xdWVyeVNlbGVjdG9yQWxsKCcubGlzdGluZ19faXRlbScpO1xyXG4gIGxldCBwYXVzZSA9IGZhbHNlO1xyXG4gIGxldCBjbGllbnRZO1xyXG4gIFxyXG4gIGZ1bmN0aW9uIG1vdmVDb250ZW50KGluZGV4KSB7XHJcbiAgICBpZiAoIXBhdXNlKSB7XHJcbiAgICAgIHBhdXNlID0gdHJ1ZTtcclxuICAgIGxldCBwb3MgPSBpbmRleCAqIC0xMDAgKyAnJSc7XHJcbiAgICBjb250ZW50LnN0eWxlLnRvcCA9IHBvcztcclxuXHJcbiAgICBsZXQgYWN0aXZlID0gZC5xdWVyeVNlbGVjdG9yKCcubGlzdGluZ19faXRlbS5pcy1hY3RpdmUnKTtcclxuICAgIGFjdGl2ZS5jbGFzc0xpc3QucmVtb3ZlKCdpcy1hY3RpdmUnKTtcclxuICAgIHBvaW50c1tpbmRleF0uY2xhc3NMaXN0LmFkZCgnaXMtYWN0aXZlJyk7XHJcblxyXG4gICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkgeyAgICAgICAgXHJcbiAgICAgICAgcGF1c2UgPSBmYWxzZTtcclxuICAgICAgfSwgOTAwKVxyXG4gICAgfSAgIFxyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gc2Nyb2xsKHdheSkge1xyXG4gICAgbGV0IGN1cnJlbnRQb3MgPSAhY29udGVudC5zdHlsZS50b3AgPyAwIDogLXBhcnNlSW50KGNvbnRlbnQuc3R5bGUudG9wLCAxMCkvMTAwO1xyXG4gICAgaWYgKHdheSA9PSAndXAnICYmIGN1cnJlbnRQb3MgPiAwKSB7ICAgICAgXHJcbiAgICAgIG1vdmVDb250ZW50KGN1cnJlbnRQb3MtMSk7XHJcbiAgICB9XHJcbiAgICBpZih3YXkgPT0gJ2Rvd24nICYmIGN1cnJlbnRQb3MgPCBzZWN0aW9ucy5sZW5ndGgtMSkge1xyXG4gICAgICBtb3ZlQ29udGVudChjdXJyZW50UG9zKzEpO1xyXG4gICAgfSBcclxuICB9XHJcblxyXG4gIHdyYXBwZXIuYWRkRXZlbnRMaXN0ZW5lcignd2hlZWwnLCBmdW5jdGlvbihlKSB7XHJcbiAgICBsZXQgd2F5ID0gZS5kZWx0YVkgPCAwID8gJ3VwJyA6ICdkb3duJztcclxuICAgIHNjcm9sbCh3YXkpO1xyXG4gIH0pXHJcbiAgd3JhcHBlci5hZGRFdmVudExpc3RlbmVyKCd0b3VjaG1vdmUnLCBmdW5jdGlvbihlKSB7XHJcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgfSlcclxuXHJcbiAgd3JhcHBlci5hZGRFdmVudExpc3RlbmVyKCd0b3VjaHN0YXJ0JywgZnVuY3Rpb24oZSkge1xyXG4gICAgaWYgKC9BbmRyb2lkfEFwcGxlV2ViS2l0fHdlYk9TfGlQaG9uZXxpUGFkfGlQb2R8QmxhY2tCZXJyeXxJRU1vYmlsZXxPcGVyYSBNaW5pL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSkge1xyXG4gICAgICBjbGllbnRZID0gZS50b3VjaGVzWzBdLmNsaWVudFk7XHJcbiAgICB9XHJcbiAgfSwgZmFsc2UpO1xyXG5cclxuICB3cmFwcGVyLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJywgZnVuY3Rpb24oZSkgeyAgICAgIFxyXG4gICAgICBsZXQgZGVsdGFZID0gZS5jaGFuZ2VkVG91Y2hlc1swXS5jbGllbnRZIC0gY2xpZW50WTtcclxuICAgICAgaWYgKE1hdGguYWJzKGRlbHRhWSk+NTApe1xyXG4gICAgICAgIGxldCB3YXkgPSBkZWx0YVkgPiAwID8gJ3VwJyA6ICdkb3duJztcclxuICAgICAgICBzY3JvbGwod2F5KTtcclxuICAgICAgfVxyXG4gIH0sIGZhbHNlKTtcclxuXHJcbiAgbWVudUxpbmtzLmZvckVhY2goZnVuY3Rpb24oZWxlbSkgeyAgICBcclxuICAgIGVsZW0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihlKXtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICBsZXQgaW5kZXggPSB0aGlzLmRhdGFzZXQuaW5kZXg7ICAgICAgICBcclxuICAgICAgbW92ZUNvbnRlbnQoaW5kZXgpO1xyXG4gICAgfSkgICAgICBcclxuICB9KVxyXG5cclxuICBwb2ludHMuZm9yRWFjaChmdW5jdGlvbihlbGVtKSB7XHJcbiAgICBlbGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZSl7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgbGluayA9IGUudGFyZ2V0O1xyXG4gICAgICBsZXQgaW5kZXggPSBsaW5rLmRhdGFzZXQuaW5kZXg7XHJcbiAgICAgIG1vdmVDb250ZW50KGluZGV4KTtcclxuICAgIH0pXHJcbiAgfSlcclxuXHJcbiAgbGV0IGJ1dHRvbiA9IGQucXVlcnlTZWxlY3RvcignLmludHJvLWJ1dHRvbicpO1xyXG4gIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcclxuICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgIG1vdmVDb250ZW50KDcpO1xyXG4gIH0pXHJcblxyXG4gIGQuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCBmdW5jdGlvbihlKSB7XHJcbiAgICBsZXQgd2F5O1xyXG4gICAgaWYgKGUua2V5Q29kZSA9PSAzOCkge1xyXG4gICAgICB3YXkgPSAndXAnO1xyXG4gICAgfVxyXG4gICAgaWYgKGUua2V5Q29kZSA9PSA0MCkge1xyXG4gICAgICB3YXkgPSAnZG93bic7XHJcbiAgICAgfVxyXG4gICAgIHNjcm9sbCh3YXkpO1xyXG4gIH0pXHJcbn1cclxuT25lUGFnZVNjcm9sbCgpOyIsImNvbnN0IG92ZXJsYXkgPSAoZnVuY3Rpb24oKXtcclxuICBsZXQgYm9keSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2JvZHknKTtcclxuICBsZXQgbW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWwnKTtcclxuICBsZXQgbW9kYWxJbm5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9faW5uZXInKTsgIFxyXG5cclxuICBsZXQgbW9kYWxUZXh0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgbW9kYWxUZXh0LmNsYXNzTGlzdC5hZGQoJ21vZGFsX190ZXh0Jyk7ICBcclxuXHJcbiAgbGV0IG9wZW5PdmVybGF5ID0gZnVuY3Rpb24oY29udGVudCwgcmVwbHkpIHtcclxuICAgIGxldCBidXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcclxuICAgIG1vZGFsVGV4dC50ZXh0Q29udGVudCA9IGNvbnRlbnQ7XHJcbiAgICBtb2RhbElubmVyLmlubmVySFRNTCA9IFwiXCI7XHJcbiAgICBpZihyZXBseSkge1xyXG4gICAgICBidXR0b24uY2xhc3NMaXN0LmFkZCgnb3JkZXItYnV0dG9uJyk7XHJcbiAgICAgIGJ1dHRvbi50ZXh0Q29udGVudCA9ICfQl9Cw0LrRgNGL0YLRjCc7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBidXR0b24uY2xhc3NMaXN0LmFkZCgnbW9kYWxfX2Nsb3NlJyk7XHJcbiAgICB9XHJcbiAgICBtb2RhbElubmVyLmFwcGVuZENoaWxkKG1vZGFsVGV4dCk7XHJcbiAgICBtb2RhbElubmVyLmFwcGVuZENoaWxkKGJ1dHRvbik7XHJcblxyXG4gICAgbW9kYWwuY2xhc3NMaXN0LmFkZCgnaXMtYWN0aXZlJyk7XHJcbiAgICBib2R5LmNsYXNzTGlzdC5hZGQoJ2xvY2tlZCcpO1xyXG5cclxuICAgIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgY2xvc2VPdmVybGF5KCk7XHJcbiAgICB9KVxyXG5cclxuICAgIG1vZGFsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcclxuICAgICAgaWYgKGUudGFyZ2V0ID09PSBtb2RhbCkge1xyXG4gICAgICAgIGNsb3NlT3ZlcmxheSgpO1xyXG4gICAgICB9XHJcbiAgICB9KVxyXG5cclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCAoZSkgPT4ge1xyXG4gICAgICBpZiAoZS5rZXlDb2RlID09PSAyNykgXHJcbiAgICAgICAgY2xvc2VPdmVybGF5KCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGxldCBjbG9zZU92ZXJsYXkgPSBmdW5jdGlvbigpIHtcclxuICAgIG1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoJ2lzLWFjdGl2ZScpO1xyXG4gICAgYm9keS5jbGFzc0xpc3QucmVtb3ZlKCdsb2NrZWQnKTtcclxuICB9XHJcblxyXG4gIHJldHVybiB7XHJcbiAgICBvcGVuOiBvcGVuT3ZlcmxheSxcclxuICAgIGNsb3NlOiBjbG9zZU92ZXJsYXlcclxuICB9O1xyXG59KCkpO1xyXG5cclxuY29uc3QgYWpheEZvcm0gPSBmdW5jdGlvbihmb3JtKSB7XHJcbiBcclxuICBsZXQgZGF0YSA9IG5ldyBGb3JtRGF0YSgpO1xyXG4gICAgZGF0YS5hcHBlbmQoXCJuYW1lXCIsIGZvcm0uZWxlbWVudHMubmFtZS52YWx1ZSk7XHJcbiAgICBkYXRhLmFwcGVuZChcInBob25lXCIsIGZvcm0uZWxlbWVudHMucGhvbmUudmFsdWUpO1xyXG4gICAgZGF0YS5hcHBlbmQoXCJjb21tZW50XCIsIGZvcm0uZWxlbWVudHMudGV4dGFyZWEudmFsdWUpO1xyXG4gICAgZGF0YS5hcHBlbmQoXCJ0b1wiLCBcImNsaWVudEBtYWlsLnJ1XCIpO1xyXG4gIFxyXG4gICAgY29uc3QgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XHJcbiAgICB4aHIucmVzcG9uc2VUeXBlID0gJ2pzb24nO1xyXG4gICAgeGhyLm9wZW4oJ1BPU1QnLCdodHRwczovL3dlYmRldi1hcGkubG9mdHNjaG9vbC5jb20vc2VuZG1haWwnKTtcclxuICAgIHhoci5zZXRSZXF1ZXN0SGVhZGVyKFwiWC1SZXF1ZXN0ZWQtV2l0aFwiLCBcIlhNTEh0dHBSZXF1ZXN0XCIpO1xyXG4gICAgeGhyLnNlbmQoZGF0YSk7XHJcblxyXG4gICAgcmV0dXJuIHhocjtcclxuICBcclxufVxyXG5cclxuY29uc3Qgc3VibWl0Rm9ybSA9IGZ1bmN0aW9uKCkgeyAgXHJcbiAgbGV0IGZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjb3JkZXItZm9ybScpO1xyXG4gIGlmICh2YWxpZGF0ZUZvcm0oZm9ybSkpIHtcclxuICAgIFxyXG4gIGxldCByZXF1ZXN0ID0gYWpheEZvcm0oZm9ybSk7ICBcclxuICAgIHJlcXVlc3QuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsICgpPT4ge1xyXG4gICAgICBsZXQgcmVwbHkgPSBmYWxzZTtcclxuICAgICAgaWYgKHJlcXVlc3Quc3RhdHVzID49NDAwKSB7XHJcbiAgICAgICAgbGV0IGNvbnRlbnQgPSAn0J7RiNC40LHQutCwINGB0L7QtdC00LjQvdC10L3QuNGPINGBINGB0LXRgNCy0LXRgNC+0LwsINC/0L7Qv9GA0L7QsdGD0LnRgtC1INC/0L7Qt9C20LUnO1xyXG4gICAgICAgIG92ZXJsYXkub3BlbihgJHtjb250ZW50fS4g0J7RiNC40LHQutCwICR7cmVxdWVzdC5zdGF0dXN9YCwgcmVwbHkpO1xyXG4gICAgICB9IGVsc2UgaWYgKHJlcXVlc3QucmVzcG9uc2Uuc3RhdHVzID09IDApIHtcclxuICAgICAgICBjb250ZW50ID0gcmVxdWVzdC5yZXNwb25zZS5tZXNzYWdlO1xyXG4gICAgICAgIG92ZXJsYXkub3Blbihjb250ZW50LCByZXBseSk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgY29udGVudCA9ICfQodC+0L7QsdGJ0LXQvdC40LUg0L7RgtC/0YDQsNCy0LvQtdC90L4nO1xyXG4gICAgICAgIHJlcGx5ID0gdHJ1ZTtcclxuICAgICAgICBvdmVybGF5Lm9wZW4oY29udGVudCwgcmVwbHkpO1xyXG4gICAgICB9XHJcbiAgICB9KVxyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gdmFsaWRhdGVGb3JtKGZvcm0pIHtcclxuICBsZXQgdmFsaWQgPSB0cnVlO1xyXG4gIGlmKCF2YWxpZGF0ZUZpZWxkKGZvcm0uZWxlbWVudHMubmFtZSkpIHtcclxuICAgIHZhbGlkID0gZmFsc2U7XHJcbiAgfVxyXG4gIGlmKCF2YWxpZGF0ZUZpZWxkKGZvcm0uZWxlbWVudHMucGhvbmUpKSB7XHJcbiAgICB2YWxpZCA9IGZhbHNlO1xyXG4gIH1cclxuICBpZighdmFsaWRhdGVGaWVsZChmb3JtLmVsZW1lbnRzLnRleHRhcmVhKSkge1xyXG4gICAgdmFsaWQgPSBmYWxzZTtcclxuICB9XHJcbiAgcmV0dXJuIHZhbGlkO1xyXG59XHJcbmZ1bmN0aW9uIHZhbGlkYXRlRmllbGQoZmllbGQpIHtcclxuICBmaWVsZC5uZXh0RWxlbWVudFNpYmxpbmcudGV4dENvbnRlbnQgPSBmaWVsZC52YWxpZGF0aW9uTWVzc2FnZTtcclxuICByZXR1cm4gZmllbGQuY2hlY2tWYWxpZGl0eSgpO1xyXG59XHJcblxyXG5sZXQgb3JkZXJCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjc2VuZCcpO1xyXG5vcmRlckJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGUgPT4ge1xyXG4gIGUucHJldmVudERlZmF1bHQoKTtcclxuICBzdWJtaXRGb3JtKCk7XHJcbn0pOyIsIihmdW5jdGlvbigpe1xyXG4gIGNvbnN0IGl0ZW1zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnJldmlld3NfX2l0ZW0nKTtcclxuICBjb25zdCBwaXggPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucmV2aWV3c19fcGl4LWl0ZW0nKTtcclxuICBsZXQgYWN0aXZlID0gMDtcclxuXHJcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBpdGVtcy5sZW5ndGg7IGkrKykge1xyXG4gICAgcGl4W2ldLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIGl0ZW1zW2ldLmNsYXNzTGlzdC50b2dnbGUoJ2lzLWFjdGl2ZScpO1xyXG4gICAgICBwaXhbaV0uY2xhc3NMaXN0LnRvZ2dsZSgnaXMtYWN0aXZlJyk7XHJcbiAgICAgXHJcbiAgICAgIHBpeFthY3RpdmVdLmNsYXNzTGlzdC50b2dnbGUoJ2lzLWFjdGl2ZScpO1xyXG4gICAgICBpdGVtc1thY3RpdmVdLmNsYXNzTGlzdC50b2dnbGUoJ2lzLWFjdGl2ZScpO1xyXG4gICAgICBhY3RpdmUgPSBpOyAgICAgXHJcbiAgICB9KVxyXG4gIH1cclxufSgpKTsiLCJkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24oKSB7XHJcbiAgbGV0IHZpZGVvUGxheWVyID0gZnVuY3Rpb24oKXtcclxuXHJcbiAgICBsZXQgdmlkZW8gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudmlkZW9fX2NvbnRlbnQnKTtcclxuICAgIGxldCBwbGF5QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnZpZGVvX19idG4nKTtcclxuICAgIGxldCB2b2x1bWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudmlkZW9fX3JhbmdlLS12b2x1bWUnKTtcclxuICAgIGxldCBwcm9ncmVzc0JhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy52aWRlb19fcmFuZ2UtLXByb2dyZXNzJyk7XHJcbiAgICBsZXQgc3dpdGNoQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnZpZGVvX19wbGF5Jyk7XHJcbiAgICBsZXQgcGxheWluZyA9IGZhbHNlO1xyXG4gIFxyXG4gICAgdmlkZW8ub250aW1ldXBkYXRlID0gZnVuY3Rpb24oKXtcclxuICAgICAgcHJvZ3Jlc3MoKTtcclxuICAgICAgaWYodmlkZW8uY3VycmVudFRpbWUgPT0gdmlkZW8uZHVyYXRpb24pe1xyXG4gICAgICAgIHBhdXNlKCk7XHJcbiAgICAgIH1cclxuICAgIH0gXHJcbiAgICBmdW5jdGlvbiBwbGF5KCkge1xyXG4gICAgICB2aWRlby5wbGF5KCk7XHJcbiAgICAgIHBsYXlpbmcgPSB0cnVlO1xyXG4gICAgICBwbGF5QnRuLmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpO1xyXG4gICAgICBzd2l0Y2hCdG4uY2xhc3NMaXN0LmFkZCgnc3RvcCcpO1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gcGF1c2UoKSB7XHJcbiAgICAgIHZpZGVvLnBhdXNlKCk7XHJcbiAgICAgIHBsYXlpbmcgPSBmYWxzZTtcclxuICAgICAgcGxheUJ0bi5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTtcclxuICAgICAgc3dpdGNoQnRuLmNsYXNzTGlzdC5yZW1vdmUoJ3N0b3AnKTtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIHByb2dyZXNzKCl7XHJcbiAgICAgIGxldCBkdXJhdGlvbiA9IHZpZGVvLmR1cmF0aW9uO1xyXG4gICAgICBsZXQgdGltZSA9IHZpZGVvLmN1cnJlbnRUaW1lO1xyXG4gICAgICBwcm9ncmVzc0Jhci52YWx1ZSA9ICh0aW1lL2R1cmF0aW9uKSoxMDA7XHJcbiAgICB9XHJcbiAgXHJcbiAgICBwbGF5QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oKXtcclxuICAgICAgaWYoIXBsYXlpbmcpIHtcclxuICAgICAgICBwbGF5KCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgdmlkZW8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbigpe1xyXG4gICAgICAgIGlmKHBsYXlpbmcpIHtcclxuICAgICAgICAgIHBhdXNlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICB2b2x1bWUuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBmdW5jdGlvbigpe1xyXG4gICAgICBsZXQgdmFsdWUgPSB0aGlzLnZhbHVlO1xyXG4gICAgICB2aWRlby52b2x1bWUgPSB2YWx1ZS8xMDA7XHJcbiAgICB9KVxyXG4gICAgcHJvZ3Jlc3NCYXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgIGxldCB3aWR0aCA9IHByb2dyZXNzQmFyLm9mZnNldFdpZHRoO1xyXG4gICAgICBsZXQgcG9zID0gZS5vZmZzZXRYO1xyXG4gICAgICBwcm9ncmVzc0Jhci52YWx1ZSA9IChwb3Mvd2lkdGgpKjEwMDtcclxuICAgICAgdmlkZW8ucGF1c2UoKTtcclxuICAgICAgdmlkZW8uY3VycmVudFRpbWUgPSB2aWRlby5kdXJhdGlvbioocG9zL3dpZHRoKTtcclxuICAgICAgdmlkZW8ucGxheSgpO1xyXG4gICAgfSlcclxuICAgIHN3aXRjaEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsZnVuY3Rpb24oKXtcclxuICAgICAgaWYoIXBsYXlpbmcpIHtcclxuICAgICAgICBwbGF5KCk7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSBpZihwbGF5aW5nKSB7XHJcbiAgICAgICAgcGF1c2UoKTtcclxuICAgICAgICB2aWRlby5jdXJyZW50VGltZSA9IDA7XHJcbiAgICAgIH1cclxuICAgIH0pXHJcbiAgXHJcbiAgfVxyXG4gIHZpZGVvUGxheWVyKCk7XHJcbn0sIGZhbHNlKTtcclxuIl19
