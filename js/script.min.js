!function(){!function(){let e=document.querySelector(".team__list");e.addEventListener("click",function(t){if(t.preventDefault(),t.target.classList.contains("member__link")){let n=t.target,i=e.querySelector(".member.is-active");if(i&&(i.querySelector(".member__text").style.height="0px",i.classList.remove("is-active")),!i||i.querySelector(".member__link")!=n){let e=n.closest(".member");e.classList.add("is-active");let t=e.querySelector(".member__text");t.style.height=t.scrollHeight+"px"}}})}(),function(){let e=document.querySelectorAll(".menu__block"),t=document.querySelector("body");e.forEach(function(e){e.addEventListener("click",function(e){e.preventDefault();let n=this,i=document.querySelector(".menu__item.is-active");if(i&&(i.querySelector(".menu__desc").style.width="0px",i.classList.remove("is-active")),!i||i.querySelector(".menu__block")!=n){let e=n.closest(".menu__item");e.classList.add("is-active");let i=e.querySelector(".menu__desc");t.offsetWidth>480?i.style.width=function(){let e=document.documentElement.clientWidth,t=document.querySelectorAll(".menu__block"),n=e-parseFloat(getComputedStyle(t[0]).width)*t.length;return n>550?550:n}()+"px":i.style.width="auto"}})})}()}(),$(function(){let e=$(".candy-bar__slider");$(".scroll-btn").on("click",function(t){t.preventDefault();let n,i,o=$(this),l=e.find(".candy-bar__item"),c=l.filter(".active");o.hasClass("scroll-btn--forward")&&(n=c.next(),i=l.first()),o.hasClass("scroll-btn--back")&&(n=c.prev(),i=l.last()),function(t){let n=e.find(".candy-bar__item"),i=n.filter(".active"),o=n.eq(t),l=o.index(),c=e.find(".candy-bar__list");o.length&&c.animate({left:100*-l+"%"},500,function(){i.removeClass("active"),o.addClass("active")})}(n.length?n.index():i.index())})}),ymaps.ready(init);var geoObjects=[],marks=[{latitude:55.7587,longitude:37.5828,hintContent:'<div class="map__hint">Кудринская площадь д.1</div>'},{latitude:55.7427,longitude:37.5799,hintContent:'<div class="map__hint">ул.Плющиха д.11</div>'},{latitude:55.7574,longitude:37.6208,hintContent:'<div class="map__hint">Площадь Революции д.1</div>'},{latitude:55.75,longitude:37.6037,hintContent:'<div class="map__hint">Большой Знаменский пер. д.23</div>'}];function init(){var e=new ymaps.Map("map",{center:[55.75269656,37.59427083],zoom:14,controls:["zoomControl"],behaviors:["drag"]});for(let e=0;e<marks.length;e++)geoObjects[e]=new ymaps.Placemark([marks[e].latitude,marks[e].longitude],{hintContent:marks[e].hintContent},{iconLayout:"default#image",iconImageHref:"../img/mapMarker.png",iconImageSize:[46,57],iconImageOffset:[-23,-57]});var t=new ymaps.Clusterer({clusterIcons:[{href:"../img/mapMarker.png",size:[46,57],offset:[-23,-57]}],clusterIconContentLayout:null});e.geoObjects.add(t),t.add(geoObjects)}const menu=function(){let e=document.querySelector(".menu-btn"),t=document.querySelector(".header"),n=document.querySelector("body"),i=document.querySelector(".nav__list"),o=!1;function l(){e.classList.toggle("is-active"),t.classList.toggle("is-active"),n.classList.toggle("locked"),o=!o}return document.addEventListener("keydown",function(e){27==e.keyCode&&o&&l()}),{menuOver:function(){e.addEventListener("click",l),i.addEventListener("click",function(e){e.target.classList.contains("nav__link")&&n.offsetWidth<=768&&l()})}}}();menu.menuOver();let OnePageScroll=function(){const e=document,t=e.querySelector(".wrapper"),n=e.querySelector("#content"),i=e.querySelectorAll(".section");let o,l=e.querySelectorAll(".nav__link"),c=e.querySelectorAll(".listing__item"),a=!1;function s(t){if(!a){a=!0;let i=-100*t+"%";n.style.top=i,e.querySelector(".listing__item.is-active").classList.remove("is-active"),c[t].classList.add("is-active"),setTimeout(function(){a=!1},900)}}function r(e){let t=n.style.top?-parseInt(n.style.top,10)/100:0;"up"==e&&t>0&&s(t-1),"down"==e&&t<i.length-1&&s(t+1)}t.addEventListener("wheel",function(e){r(e.deltaY<0?"up":"down")}),t.addEventListener("touchmove",function(e){e.preventDefault()}),t.addEventListener("touchstart",function(e){/Android|AppleWebKit|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&(o=e.touches[0].clientY)},!1),t.addEventListener("touchend",function(e){let t=e.changedTouches[0].clientY-o;if(Math.abs(t)>50){r(t>0?"up":"down")}},!1),l.forEach(function(e){e.addEventListener("click",function(e){e.preventDefault(),s(this.dataset.index)})}),c.forEach(function(e){e.addEventListener("click",function(e){e.preventDefault(),link=e.target,s(link.dataset.index)})}),e.querySelector(".intro-button").addEventListener("click",function(e){e.preventDefault(),s(7)}),e.addEventListener("keyup",function(e){let t;38==e.keyCode&&(t="up"),40==e.keyCode&&(t="down"),r(t)})};OnePageScroll();const overlay=function(){let e=document.querySelector("body"),t=document.querySelector(".modal"),n=document.querySelector(".modal__inner"),i=document.createElement("div");i.classList.add("modal__text");let o=function(){t.classList.remove("is-active"),e.classList.remove("locked")};return{open:function(l,c){let a=document.createElement("button");i.textContent=l,n.innerHTML="",c?(a.classList.add("order-button"),a.textContent="Закрыть"):a.classList.add("modal__close"),n.appendChild(i),n.appendChild(a),t.classList.add("is-active"),e.classList.add("locked"),a.addEventListener("click",e=>{e.preventDefault(),o()}),t.addEventListener("click",e=>{e.target===t&&o()}),document.addEventListener("keydown",e=>{27===e.keyCode&&o()})},close:o}}(),ajaxForm=function(e){let t=new FormData;t.append("name",e.elements.name.value),t.append("phone",e.elements.phone.value),t.append("comment",e.elements.textarea.value),t.append("to","client@mail.ru");const n=new XMLHttpRequest;return n.responseType="json",n.open("POST","https://webdev-api.loftschool.com/sendmail"),n.setRequestHeader("X-Requested-With","XMLHttpRequest"),n.send(t),n},submitForm=function(){let e=document.querySelector("#order-form");if(validateForm(e)){let t=ajaxForm(e);t.addEventListener("load",()=>{let e=!1;if(t.status>=400){let n="Ошибка соединения с сервером, попробуйте позже";overlay.open(`${n}. Ошибка ${t.status}`,e)}else 0==t.response.status?(content=t.response.message,overlay.open(content,e)):(content="Сообщение отправлено",e=!0,overlay.open(content,e))})}};function validateForm(e){let t=!0;return validateField(e.elements.name)||(t=!1),validateField(e.elements.phone)||(t=!1),validateField(e.elements.textarea)||(t=!1),t}function validateField(e){return e.nextElementSibling.textContent=e.validationMessage,e.checkValidity()}let orderBtn=document.querySelector("#send");orderBtn.addEventListener("click",e=>{e.preventDefault(),submitForm()}),function(){const e=document.querySelectorAll(".reviews__item"),t=document.querySelectorAll(".reviews__pix-item");let n=0;for(let i=0;i<e.length;i++)t[i].addEventListener("click",function(o){o.preventDefault(),e[i].classList.toggle("is-active"),t[i].classList.toggle("is-active"),t[n].classList.toggle("is-active"),e[n].classList.toggle("is-active"),n=i})}();let videoPlayer=function(){let e=document.querySelector(".video__content"),t=document.querySelector(".video__btn"),n=document.querySelector(".video__volume"),i=document.querySelector(".video__progress"),o=document.querySelector(".video__play"),l=!1;function c(){e.play(),l=!0,t.classList.add("hidden"),o.classList.add("stop")}function a(){e.pause(),l=!1,t.classList.remove("hidden"),o.classList.remove("stop")}e.ontimeupdate=function(){!function(){let t=e.duration,n=e.currentTime;i.value=n/t*100}(),e.currentTime==e.duration&&a()},t.addEventListener("click",function(){l||c()}),e.addEventListener("click",function(){l&&a()}),n.addEventListener("input",function(){let t=this.value;e.volume=t/100}),i.addEventListener("click",function(t){let n=i.offsetWidth,o=t.offsetX;i.value=o/n*100,e.pause(),e.currentTime=e.duration*(o/n),e.play()}),o.addEventListener("click",function(){l?l&&(a(),e.currentTime=0):c()})};videoPlayer();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFjY29yZGVvbi5qcyIsImpxdWVyeVNsaWRlci5qcyIsIm1hcC5qcyIsIm1lbnUuanMiLCJvcHMuanMiLCJyZXF1ZXN0LmpzIiwic2xpZGVzaG93LmpzIiwidmlkZW8uanMiXSwibmFtZXMiOlsidGVhbSIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwicHJldmVudERlZmF1bHQiLCJ0YXJnZXQiLCJjbGFzc0xpc3QiLCJjb250YWlucyIsImxpbmsiLCJhY3RpdmUiLCJzdHlsZSIsImhlaWdodCIsInJlbW92ZSIsImN1cnJlbnQiLCJjbG9zZXN0IiwiYWRkIiwiY3VycmVudFRleHQiLCJzY3JvbGxIZWlnaHQiLCJhY3RpdmF0ZVRlYW0iLCJsaW5rcyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJib2R5IiwiZm9yRWFjaCIsImVsZW0iLCJ0aGlzIiwid2lkdGgiLCJvZmZzZXRXaWR0aCIsImRvY3VtZW50RWxlbWVudCIsImNsaWVudFdpZHRoIiwicmVxV2lkdGgiLCJwYXJzZUZsb2F0IiwiZ2V0Q29tcHV0ZWRTdHlsZSIsImxlbmd0aCIsIndpZHRoQ2FsYyIsImFjdGl2YXRlTWVudSIsIiQiLCJzbGlkZXIiLCJvbiIsImV4aXN0ZWRJdGVtIiwiZWRnZUl0ZW0iLCIkdGhpcyIsIml0ZW1zIiwiZmluZCIsImFjdGl2ZUl0ZW0iLCJmaWx0ZXIiLCJoYXNDbGFzcyIsIm5leHQiLCJmaXJzdCIsInByZXYiLCJsYXN0IiwibnVtIiwicmVxSXRlbSIsImVxIiwicmVxSW5kZXgiLCJpbmRleCIsImxpc3QiLCJhbmltYXRlIiwibGVmdCIsInJlbW92ZUNsYXNzIiwiYWRkQ2xhc3MiLCJtb3ZlU2xpZGUiLCJ5bWFwcyIsInJlYWR5IiwiaW5pdCIsImdlb09iamVjdHMiLCJtYXJrcyIsImxhdGl0dWRlIiwibG9uZ2l0dWRlIiwiaGludENvbnRlbnQiLCJtYXAiLCJNYXAiLCJjZW50ZXIiLCJ6b29tIiwiY29udHJvbHMiLCJiZWhhdmlvcnMiLCJpIiwiUGxhY2VtYXJrIiwiaWNvbkxheW91dCIsImljb25JbWFnZUhyZWYiLCJpY29uSW1hZ2VTaXplIiwiaWNvbkltYWdlT2Zmc2V0IiwiY2x1c3RlcmVyIiwiQ2x1c3RlcmVyIiwiY2x1c3Rlckljb25zIiwiaHJlZiIsInNpemUiLCJvZmZzZXQiLCJjbHVzdGVySWNvbkNvbnRlbnRMYXlvdXQiLCJtZW51IiwiYnV0dG9uIiwiaGVhZGVyIiwibmF2IiwiYWN0IiwidG9nZ2xlTWVudSIsInRvZ2dsZSIsImtleUNvZGUiLCJtZW51T3ZlciIsIk9uZVBhZ2VTY3JvbGwiLCJkIiwid3JhcHBlciIsImNvbnRlbnQiLCJzZWN0aW9ucyIsImNsaWVudFkiLCJtZW51TGlua3MiLCJwb2ludHMiLCJwYXVzZSIsIm1vdmVDb250ZW50IiwicG9zIiwidG9wIiwic2V0VGltZW91dCIsInNjcm9sbCIsIndheSIsImN1cnJlbnRQb3MiLCJwYXJzZUludCIsImRlbHRhWSIsInRlc3QiLCJuYXZpZ2F0b3IiLCJ1c2VyQWdlbnQiLCJ0b3VjaGVzIiwiY2hhbmdlZFRvdWNoZXMiLCJNYXRoIiwiYWJzIiwiZGF0YXNldCIsIm92ZXJsYXkiLCJtb2RhbCIsIm1vZGFsSW5uZXIiLCJtb2RhbFRleHQiLCJjcmVhdGVFbGVtZW50IiwiY2xvc2VPdmVybGF5Iiwib3BlbiIsInJlcGx5IiwidGV4dENvbnRlbnQiLCJpbm5lckhUTUwiLCJhcHBlbmRDaGlsZCIsImNsb3NlIiwiYWpheEZvcm0iLCJmb3JtIiwiZGF0YSIsIkZvcm1EYXRhIiwiYXBwZW5kIiwiZWxlbWVudHMiLCJuYW1lIiwidmFsdWUiLCJwaG9uZSIsInRleHRhcmVhIiwieGhyIiwiWE1MSHR0cFJlcXVlc3QiLCJyZXNwb25zZVR5cGUiLCJzZXRSZXF1ZXN0SGVhZGVyIiwic2VuZCIsInN1Ym1pdEZvcm0iLCJ2YWxpZGF0ZUZvcm0iLCJyZXF1ZXN0Iiwic3RhdHVzIiwicmVzcG9uc2UiLCJtZXNzYWdlIiwidmFsaWQiLCJ2YWxpZGF0ZUZpZWxkIiwiZmllbGQiLCJuZXh0RWxlbWVudFNpYmxpbmciLCJ2YWxpZGF0aW9uTWVzc2FnZSIsImNoZWNrVmFsaWRpdHkiLCJvcmRlckJ0biIsInBpeCIsInZpZGVvUGxheWVyIiwidmlkZW8iLCJwbGF5QnRuIiwidm9sdW1lIiwicHJvZ3Jlc3NCYXIiLCJzd2l0Y2hCdG4iLCJwbGF5aW5nIiwicGxheSIsIm9udGltZXVwZGF0ZSIsImR1cmF0aW9uIiwidGltZSIsImN1cnJlbnRUaW1lIiwicHJvZ3Jlc3MiLCJvZmZzZXRYIl0sIm1hcHBpbmdzIjoiQ0FBQSxZQVdBLFdBQ0EsSUFBQUEsRUFBQUMsU0FBQUMsY0FBQSxlQUNBRixFQUFBRyxpQkFBQSxRQUFBLFNBQUFDLEdBRUEsR0FEQUEsRUFBQUMsaUJBQ0FELEVBQUFFLE9BQUFDLFVBQUFDLFNBQUEsZ0JBQUEsQ0FDQSxJQUFBQyxFQUFBTCxFQUFBRSxPQUVBSSxFQUFBVixFQUFBRSxjQUFBLHFCQU9BLEdBTEFRLElBQ0FBLEVBQUFSLGNBQUEsaUJBQ0FTLE1BQUFDLE9BQUEsTUFDQUYsRUFBQUgsVUFBQU0sT0FBQSxlQUVBSCxHQUFBQSxFQUFBUixjQUFBLGtCQUFBTyxFQUFBLENBQ0EsSUFBQUssRUFBQUwsRUFBQU0sUUFBQSxXQUNBRCxFQUFBUCxVQUFBUyxJQUFBLGFBRUEsSUFBQUMsRUFBQUgsRUFBQVosY0FBQSxpQkFDQWUsRUFBQU4sTUFBQUMsT0FBQUssRUFBQUMsYUFBQSxTQUtBQyxHQUVBLFdBQ0EsSUFBQUMsRUFBQW5CLFNBQUFvQixpQkFBQSxnQkFDQUMsRUFBQXJCLFNBQUFDLGNBQUEsUUFDQWtCLEVBQUFHLFFBQUEsU0FBQUMsR0FDQUEsRUFBQXJCLGlCQUFBLFFBQUEsU0FBQUMsR0FDQUEsRUFBQUMsaUJBQ0EsSUFBQUksRUFBQWdCLEtBQ0FmLEVBQUFULFNBQUFDLGNBQUEseUJBUUEsR0FOQVEsSUFDQUEsRUFBQVIsY0FBQSxlQUNBUyxNQUFBZSxNQUFBLE1BQ0FoQixFQUFBSCxVQUFBTSxPQUFBLGVBR0FILEdBQUFBLEVBQUFSLGNBQUEsaUJBQUFP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QUFBQyxJQUNBTixFQUFBTSxPQUNBRCxHQUFBLEVBQ0FKLEVBQUFoSyxVQUFBUyxJQUFBLFVBQ0EwSixFQUFBbkssVUFBQVMsSUFBQSxRQUVBLFNBQUEwRixJQUNBNEQsRUFBQTVELFFBQ0FpRSxHQUFBLEVBQ0FKLEVBQUFoSyxVQUFBTSxPQUFBLFVBQ0E2SixFQUFBbkssVUFBQU0sT0FBQSxRQWhCQXlKLEVBQUFPLGFBQUEsWUFrQkEsV0FDQSxJQUFBQyxFQUFBUixFQUFBUSxTQUNBQyxFQUFBVCxFQUFBVSxZQUNBUCxFQUFBMUIsTUFBQWdDLEVBQUFELEVBQUEsSUFwQkFHLEdBQ0FYLEVBQUFVLGFBQUFWLEVBQUFRLFVBQ0FwRSxLQXFCQTZELEVBQUFwSyxpQkFBQSxRQUFBLFdBQ0F3SyxHQUNBQyxNQUdBTixFQUFBbkssaUJBQUEsUUFBQSxXQUNBd0ssR0FDQWpFLE1BR0E4RCxFQUFBckssaUJBQUEsUUFBQSxXQUNBLElBQUE0SSxFQUFBdEgsS0FBQXNILE1BQ0F1QixFQUFBRSxPQUFBekIsRUFBQSxNQUVBMEIsRUFBQXRLLGlCQUFBLFFBQUEsU0FBQUMsR0FDQSxJQUFBc0IsRUFBQStJLEVBQUE5SSxZQUNBaUYsRUFBQXhHLEVBQUE4SyxRQUNBVCxFQUFBMUIsTUFBQW5DLEVBQUFsRixFQUFBLElBQ0E0SSxFQUFBNUQsUUFDQTRELEVBQUFVLFlBQUFWLEVBQUFRLFVBQUFsRSxFQUFBbEYsR0FDQTRJLEVBQUFNLFNBRUFGLEVBQUF2SyxpQkFBQSxRQUFBLFdBQ0F3SyxFQUdBQSxJQUNBakUsSUFDQTRELEVBQUFVLFlBQUEsR0FKQUosT0FTQVAiLCJmaWxlIjoic2NyaXB0Lm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbigpe1xyXG5cclxuICBmdW5jdGlvbiB3aWR0aENhbGMoKSB7XHJcbiAgICBsZXQgd2lkdGggPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGg7XHJcbiAgICBsZXQgbGlua3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcubWVudV9fYmxvY2snKTtcclxuICAgIGxldCBsaW5rV2lkdGggPSBwYXJzZUZsb2F0KGdldENvbXB1dGVkU3R5bGUobGlua3NbMF0pLndpZHRoKTtcclxuXHJcbiAgICBsZXQgcmVxV2lkdGggPSB3aWR0aCAtIGxpbmtXaWR0aCAqIGxpbmtzLmxlbmd0aDtcclxuICAgIHJldHVybiByZXFXaWR0aCA+IDU1MCA/IDU1MCA6IHJlcVdpZHRoO1xyXG4gIH1cclxuICBcclxuICBmdW5jdGlvbiBhY3RpdmF0ZVRlYW0oKSB7XHJcbiAgICBsZXQgdGVhbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy50ZWFtX19saXN0Jyk7ICAgXHJcbiAgICB0ZWFtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZSl7XHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIGlmKGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnbWVtYmVyX19saW5rJykpe1xyXG4gICAgICAgIGxldCBsaW5rID0gZS50YXJnZXQ7XHJcblxyXG4gICAgICAgIGxldCBhY3RpdmUgPSB0ZWFtLnF1ZXJ5U2VsZWN0b3IoJy5tZW1iZXIuaXMtYWN0aXZlJyk7XHJcblxyXG4gICAgICAgIGlmKGFjdGl2ZSkge1xyXG4gICAgICAgICAgbGV0IGFjdGl2ZVRleHQgPSBhY3RpdmUucXVlcnlTZWxlY3RvcignLm1lbWJlcl9fdGV4dCcpOyAgICAgICAgICBcclxuICAgICAgICAgIGFjdGl2ZVRleHQuc3R5bGUuaGVpZ2h0ID0gJzBweCc7XHJcbiAgICAgICAgICBhY3RpdmUuY2xhc3NMaXN0LnJlbW92ZSgnaXMtYWN0aXZlJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKCFhY3RpdmUgfHwgYWN0aXZlLnF1ZXJ5U2VsZWN0b3IoJy5tZW1iZXJfX2xpbmsnKSAhPSBsaW5rKSB7XHJcbiAgICAgICAgICBsZXQgY3VycmVudCAgPSBsaW5rLmNsb3Nlc3QoJy5tZW1iZXInKTtcclxuICAgICAgICAgIGN1cnJlbnQuY2xhc3NMaXN0LmFkZCgnaXMtYWN0aXZlJyk7XHJcblxyXG4gICAgICAgICAgbGV0IGN1cnJlbnRUZXh0ID0gY3VycmVudC5xdWVyeVNlbGVjdG9yKCcubWVtYmVyX190ZXh0Jyk7XHJcbiAgICAgICAgICBjdXJyZW50VGV4dC5zdHlsZS5oZWlnaHQgPSBjdXJyZW50VGV4dC5zY3JvbGxIZWlnaHQgKyAncHgnO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSkgICAgXHJcbiAgfVxyXG4gIGFjdGl2YXRlVGVhbSgpXHJcblxyXG4gIGZ1bmN0aW9uIGFjdGl2YXRlTWVudSgpIHtcclxuICAgIGxldCBsaW5rcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5tZW51X19ibG9jaycpO1xyXG4gICAgbGV0IGJvZHkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdib2R5Jyk7ICBcclxuICAgIGxpbmtzLmZvckVhY2goZnVuY3Rpb24oZWxlbSl7XHJcbiAgICAgIGVsZW0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihlKXtcclxuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgbGV0IGxpbmsgPSB0aGlzOyAgICAgICAgXHJcbiAgICAgICAgbGV0IGFjdGl2ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tZW51X19pdGVtLmlzLWFjdGl2ZScpO1xyXG5cclxuICAgICAgICBpZihhY3RpdmUpIHtcclxuICAgICAgICAgIGxldCBhY3RpdmVUZXh0ID0gYWN0aXZlLnF1ZXJ5U2VsZWN0b3IoJy5tZW51X19kZXNjJyk7ICAgICAgICAgIFxyXG4gICAgICAgICAgYWN0aXZlVGV4dC5zdHlsZS53aWR0aCA9ICcwcHgnO1xyXG4gICAgICAgICAgYWN0aXZlLmNsYXNzTGlzdC5yZW1vdmUoJ2lzLWFjdGl2ZScpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYoIWFjdGl2ZSB8fCBhY3RpdmUucXVlcnlTZWxlY3RvcignLm1lbnVfX2Jsb2NrJykgIT0gbGluaykge1xyXG4gICAgICAgICAgbGV0IGN1cnJlbnQgID0gbGluay5jbG9zZXN0KCcubWVudV9faXRlbScpO1xyXG4gICAgICAgICAgY3VycmVudC5jbGFzc0xpc3QuYWRkKCdpcy1hY3RpdmUnKTtcclxuXHJcbiAgICAgICAgICBsZXQgY3VycmVudFRleHQgPSBjdXJyZW50LnF1ZXJ5U2VsZWN0b3IoJy5tZW51X19kZXNjJyk7XHJcbiAgICAgICAgICBpZiAoYm9keS5vZmZzZXRXaWR0aCA+IDQ4MCkge1xyXG4gICAgICAgICAgY3VycmVudFRleHQuc3R5bGUud2lkdGggPSB3aWR0aENhbGMoKSArICdweCc7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjdXJyZW50VGV4dC5zdHlsZS53aWR0aCA9ICdhdXRvJztcclxuICAgICAgICAgIH1cclxuICAgICAgICB9ICAgICAgXHJcbiAgICAgIH0pXHJcbiAgICB9KVxyXG4gIH1cclxuICBhY3RpdmF0ZU1lbnUoKTsgIFxyXG59KCkpO1xyXG5cclxuXHJcbiAgIiwiJChmdW5jdGlvbiAoKSB7XHJcbiAgICBsZXQgc2xpZGVyID0gJCgnLmNhbmR5LWJhcl9fc2xpZGVyJyk7XHJcbiAgICBcclxuICBsZXQgbW92ZVNsaWRlID0gZnVuY3Rpb24obnVtKSB7XHJcbiAgICBsZXQgaXRlbXMgPSBzbGlkZXIuZmluZCgnLmNhbmR5LWJhcl9faXRlbScpO1xyXG4gICAgbGV0IGFjdGl2ZUl0ZW0gPSBpdGVtcy5maWx0ZXIoJy5hY3RpdmUnKTtcclxuICAgIGxldCByZXFJdGVtID0gaXRlbXMuZXEobnVtKTtcclxuICAgIGxldCByZXFJbmRleCA9IHJlcUl0ZW0uaW5kZXgoKTtcclxuICAgIGxldCBsaXN0ID0gc2xpZGVyLmZpbmQoJy5jYW5keS1iYXJfX2xpc3QnKTtcclxuICAgIGxldCBkdXJhdGlvbiA9IDUwMDtcclxuICAgIGlmIChyZXFJdGVtLmxlbmd0aCkge1xyXG4gICAgICBsaXN0LmFuaW1hdGUoe1xyXG4gICAgICAgICdsZWZ0JzogLXJlcUluZGV4ICogMTAwICsnJSdcclxuICAgICAgfSwgZHVyYXRpb24sIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGFjdGl2ZUl0ZW0ucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICAgIHJlcUl0ZW0uYWRkQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICB9KVxyXG4gICAgfVxyXG4gIH1cclxuICBcclxuICAkKCcuc2Nyb2xsLWJ0bicpLm9uKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcclxuICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgIGxldCAkdGhpcyA9ICQodGhpcyk7XHJcbiAgICBsZXQgaXRlbXMgPSBzbGlkZXIuZmluZCgnLmNhbmR5LWJhcl9faXRlbScpO1xyXG4gICAgbGV0IGFjdGl2ZUl0ZW0gPSBpdGVtcy5maWx0ZXIoJy5hY3RpdmUnKTtcclxuICAgIGxldCBleGlzdGVkSXRlbTtcclxuICAgIGxldCBlZGdlSXRlbTtcclxuXHJcbiAgICBpZiAoJHRoaXMuaGFzQ2xhc3MoJ3Njcm9sbC1idG4tLWZvcndhcmQnKSkge1xyXG4gICAgICBleGlzdGVkSXRlbSA9IGFjdGl2ZUl0ZW0ubmV4dCgpO1xyXG4gICAgICBlZGdlSXRlbSA9IGl0ZW1zLmZpcnN0KCk7ICAgICBcclxuICAgIH0gXHJcbiAgICBpZiAoJHRoaXMuaGFzQ2xhc3MoJ3Njcm9sbC1idG4tLWJhY2snKSkge1xyXG4gICAgICBleGlzdGVkSXRlbSA9IGFjdGl2ZUl0ZW0ucHJldigpO1xyXG4gICAgICBlZGdlSXRlbSA9IGl0ZW1zLmxhc3QoKTsgICAgICBcclxuICAgIH1cclxuXHJcbiAgICBsZXQgcmVxSXRlbSA9IGV4aXN0ZWRJdGVtLmxlbmd0aCA/IGV4aXN0ZWRJdGVtLmluZGV4KCkgOiBlZGdlSXRlbS5pbmRleCgpO1xyXG4gICAgbW92ZVNsaWRlKHJlcUl0ZW0pO1xyXG4gICAgfSlcclxufSkiLCJ5bWFwcy5yZWFkeShpbml0KTtcclxuICB2YXIgZ2VvT2JqZWN0cz0gW107XHJcbiAgdmFyIG1hcmtzID0gW1xyXG4gICAge1xyXG4gICAgICBsYXRpdHVkZTogNTUuNzU4NyxcclxuICAgICAgbG9uZ2l0dWRlOiAzNy41ODI4LFxyXG4gICAgICBoaW50Q29udGVudDogJzxkaXYgY2xhc3M9XCJtYXBfX2hpbnRcIj7QmtGD0LTRgNC40L3RgdC60LDRjyDQv9C70L7RidCw0LTRjCDQtC4xPC9kaXY+JyxcclxuICAgIH0sXHJcbiAgICB7XHJcbiAgICAgIGxhdGl0dWRlOiA1NS43NDI3LFxyXG4gICAgICBsb25naXR1ZGU6IDM3LjU3OTksXHJcbiAgICAgIGhpbnRDb250ZW50OiAnPGRpdiBjbGFzcz1cIm1hcF9faGludFwiPtGD0Lsu0J/Qu9GO0YnQuNGF0LAg0LQuMTE8L2Rpdj4nLFxyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgbGF0aXR1ZGU6IDU1Ljc1NzQsXHJcbiAgICAgIGxvbmdpdHVkZTogMzcuNjIwOCxcclxuICAgICAgaGludENvbnRlbnQ6ICc8ZGl2IGNsYXNzPVwibWFwX19oaW50XCI+0J/Qu9C+0YnQsNC00Ywg0KDQtdCy0L7Qu9GO0YbQuNC4INC0LjE8L2Rpdj4nLFxyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgbGF0aXR1ZGU6IDU1Ljc1MDAsXHJcbiAgICAgIGxvbmdpdHVkZTogMzcuNjAzNyxcclxuICAgICAgaGludENvbnRlbnQ6ICc8ZGl2IGNsYXNzPVwibWFwX19oaW50XCI+0JHQvtC70YzRiNC+0Lkg0JfQvdCw0LzQtdC90YHQutC40Lkg0L/QtdGALiDQtC4yMzwvZGl2PicsXHJcbiAgICB9XHJcbiAgXVxyXG5cclxuZnVuY3Rpb24gaW5pdCgpIHtcclxuICB2YXIgbWFwID0gbmV3IHltYXBzLk1hcCgnbWFwJywge1xyXG4gICAgY2VudGVyOiBbNTUuNzUyNjk2NTYsIDM3LjU5NDI3MDgzXSxcclxuICAgIHpvb206IDE0LFxyXG4gICAgY29udHJvbHM6IFsnem9vbUNvbnRyb2wnXSxcclxuICAgIGJlaGF2aW9yczogWydkcmFnJ11cclxuICB9KTtcclxuICBmb3IgKGxldCBpPTA7IGk8bWFya3MubGVuZ3RoOyBpKyspIHtcclxuICAgIGdlb09iamVjdHNbaV0gPSBuZXcgeW1hcHMuUGxhY2VtYXJrKFttYXJrc1tpXS5sYXRpdHVkZSwgbWFya3NbaV0ubG9uZ2l0dWRlXSxcclxuICAgICAge1xyXG4gICAgICAgIGhpbnRDb250ZW50OiBtYXJrc1tpXS5oaW50Q29udGVudFxyXG4gICAgICB9LFxyXG4gICAgICB7XHJcbiAgICAgICAgaWNvbkxheW91dDogJ2RlZmF1bHQjaW1hZ2UnLFxyXG4gICAgICAgIGljb25JbWFnZUhyZWY6ICcuLi9pbWcvbWFwTWFya2VyLnBuZycsXHJcbiAgICAgICAgaWNvbkltYWdlU2l6ZTogWzQ2LCA1N10sXHJcbiAgICAgICAgaWNvbkltYWdlT2Zmc2V0OiBbLTIzLCAtNTddXHJcbiAgICAgIH0pO1xyXG4gIH1cclxuICB2YXIgY2x1c3RlcmVyID0gbmV3IHltYXBzLkNsdXN0ZXJlcih7XHJcbiAgICBjbHVzdGVySWNvbnM6IFtcclxuICAgICAge1xyXG4gICAgICAgIGhyZWY6ICcuLi9pbWcvbWFwTWFya2VyLnBuZycsXHJcbiAgICAgICAgc2l6ZTogWzQ2LCA1N10sXHJcbiAgICAgICAgb2Zmc2V0OiBbLTIzLCAtNTddXHJcbiAgICAgIH1cclxuICAgIF0sXHJcbiAgICBjbHVzdGVySWNvbkNvbnRlbnRMYXlvdXQ6IG51bGxcclxuICB9KTtcclxuICBtYXAuZ2VvT2JqZWN0cy5hZGQoY2x1c3RlcmVyKTtcclxuICBjbHVzdGVyZXIuYWRkKGdlb09iamVjdHMpO1xyXG59IiwiY29uc3QgbWVudSA9IChmdW5jdGlvbigpIHtcclxuICBsZXQgYnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1lbnUtYnRuJyk7XHJcbiAgbGV0IGhlYWRlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5oZWFkZXInKTtcclxuICBsZXQgYm9keSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2JvZHknKTtcclxuICBsZXQgbmF2ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm5hdl9fbGlzdCcpO1xyXG4gIGxldCBhY3QgPSBmYWxzZTtcclxuXHJcbiAgZnVuY3Rpb24gdG9nZ2xlTWVudSgpIHtcclxuICAgICAgYnV0dG9uLmNsYXNzTGlzdC50b2dnbGUoJ2lzLWFjdGl2ZScpO1xyXG4gICAgICBoZWFkZXIuY2xhc3NMaXN0LnRvZ2dsZSgnaXMtYWN0aXZlJyk7XHJcbiAgICAgIGJvZHkuY2xhc3NMaXN0LnRvZ2dsZSgnbG9ja2VkJyk7XHJcblxyXG4gICAgICBhY3QgPyBhY3QgPSBmYWxzZSA6IGFjdCA9IHRydWU7XHJcbiAgfVxyXG5cclxuICBsZXQgYWRkTGlzdGVuZXJzID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdG9nZ2xlTWVudSk7XHJcblxyXG4gICAgICAgIG5hdi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGUpe1xyXG4gICAgICAgICAgbGV0IHRhcmdldCA9IGUudGFyZ2V0O1xyXG4gICAgICAgICAgaWYgKHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ25hdl9fbGluaycpICYmIGJvZHkub2Zmc2V0V2lkdGggPD0gNzY4KSB7XHJcbiAgICAgICAgICAgIHRvZ2dsZU1lbnUoKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgZnVuY3Rpb24oZSl7XHJcbiAgICAgICAgaWYgKGUua2V5Q29kZSA9PSAyNyAmJiBhY3QpIHtcclxuICAgICAgICAgIHRvZ2dsZU1lbnUoKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pXHJcbiAgcmV0dXJuIHtcclxuICAgIG1lbnVPdmVyOiBhZGRMaXN0ZW5lcnMgIFxyXG4gIH1cclxufSgpKTtcclxubWVudS5tZW51T3ZlcigpOyIsImxldCBPbmVQYWdlU2Nyb2xsID0gZnVuY3Rpb24oKXtcclxuICBjb25zdCBkID0gZG9jdW1lbnQ7XHJcbiAgY29uc3Qgd3JhcHBlciA9IGQucXVlcnlTZWxlY3RvcignLndyYXBwZXInKTtcclxuICBjb25zdCBjb250ZW50ID0gZC5xdWVyeVNlbGVjdG9yKCcjY29udGVudCcpO1xyXG4gIGNvbnN0IHNlY3Rpb25zID0gZC5xdWVyeVNlbGVjdG9yQWxsKCcuc2VjdGlvbicpO1xyXG4gIGxldCBtZW51TGlua3MgPSBkLnF1ZXJ5U2VsZWN0b3JBbGwoJy5uYXZfX2xpbmsnKTsgIFxyXG4gIGxldCBwb2ludHMgPSBkLnF1ZXJ5U2VsZWN0b3JBbGwoJy5saXN0aW5nX19pdGVtJyk7XHJcbiAgbGV0IHBhdXNlID0gZmFsc2U7XHJcbiAgbGV0IGNsaWVudFk7XHJcbiAgXHJcbiAgZnVuY3Rpb24gbW92ZUNvbnRlbnQoaW5kZXgpIHtcclxuICAgIGlmICghcGF1c2UpIHtcclxuICAgICAgcGF1c2UgPSB0cnVlO1xyXG4gICAgbGV0IHBvcyA9IGluZGV4ICogLTEwMCArICclJztcclxuICAgIGNvbnRlbnQuc3R5bGUudG9wID0gcG9zO1xyXG5cclxuICAgIGxldCBhY3RpdmUgPSBkLnF1ZXJ5U2VsZWN0b3IoJy5saXN0aW5nX19pdGVtLmlzLWFjdGl2ZScpO1xyXG4gICAgYWN0aXZlLmNsYXNzTGlzdC5yZW1vdmUoJ2lzLWFjdGl2ZScpO1xyXG4gICAgcG9pbnRzW2luZGV4XS5jbGFzc0xpc3QuYWRkKCdpcy1hY3RpdmUnKTtcclxuXHJcbiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7ICAgICAgICBcclxuICAgICAgICBwYXVzZSA9IGZhbHNlO1xyXG4gICAgICB9LCA5MDApXHJcbiAgICB9ICAgXHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBzY3JvbGwod2F5KSB7XHJcbiAgICBsZXQgY3VycmVudFBvcyA9ICFjb250ZW50LnN0eWxlLnRvcCA/IDAgOiAtcGFyc2VJbnQoY29udGVudC5zdHlsZS50b3AsIDEwKS8xMDA7XHJcbiAgICBpZiAod2F5ID09ICd1cCcgJiYgY3VycmVudFBvcyA+IDApIHsgICAgICBcclxuICAgICAgbW92ZUNvbnRlbnQoY3VycmVudFBvcy0xKTtcclxuICAgIH1cclxuICAgIGlmKHdheSA9PSAnZG93bicgJiYgY3VycmVudFBvcyA8IHNlY3Rpb25zLmxlbmd0aC0xKSB7XHJcbiAgICAgIG1vdmVDb250ZW50KGN1cnJlbnRQb3MrMSk7XHJcbiAgICB9IFxyXG4gIH1cclxuXHJcbiAgd3JhcHBlci5hZGRFdmVudExpc3RlbmVyKCd3aGVlbCcsIGZ1bmN0aW9uKGUpIHtcclxuICAgIGxldCB3YXkgPSBlLmRlbHRhWSA8IDAgPyAndXAnIDogJ2Rvd24nO1xyXG4gICAgc2Nyb2xsKHdheSk7XHJcbiAgfSlcclxuICB3cmFwcGVyLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNobW92ZScsIGZ1bmN0aW9uKGUpIHtcclxuICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICB9KVxyXG5cclxuICB3cmFwcGVyLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCBmdW5jdGlvbihlKSB7XHJcbiAgICBpZiAoL0FuZHJvaWR8QXBwbGVXZWJLaXR8d2ViT1N8aVBob25lfGlQYWR8aVBvZHxCbGFja0JlcnJ5fElFTW9iaWxlfE9wZXJhIE1pbmkvaS50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpKSB7XHJcbiAgICAgIGNsaWVudFkgPSBlLnRvdWNoZXNbMF0uY2xpZW50WTtcclxuICAgIH1cclxuICB9LCBmYWxzZSk7XHJcblxyXG4gIHdyYXBwZXIuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCBmdW5jdGlvbihlKSB7ICAgICAgXHJcbiAgICAgIGxldCBkZWx0YVkgPSBlLmNoYW5nZWRUb3VjaGVzWzBdLmNsaWVudFkgLSBjbGllbnRZO1xyXG4gICAgICBpZiAoTWF0aC5hYnMoZGVsdGFZKT41MCl7XHJcbiAgICAgICAgbGV0IHdheSA9IGRlbHRhWSA+IDAgPyAndXAnIDogJ2Rvd24nO1xyXG4gICAgICAgIHNjcm9sbCh3YXkpO1xyXG4gICAgICB9XHJcbiAgfSwgZmFsc2UpO1xyXG5cclxuICBtZW51TGlua3MuZm9yRWFjaChmdW5jdGlvbihlbGVtKSB7ICAgIFxyXG4gICAgZWxlbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGUpe1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIGxldCBpbmRleCA9IHRoaXMuZGF0YXNldC5pbmRleDsgICAgICAgIFxyXG4gICAgICBtb3ZlQ29udGVudChpbmRleCk7XHJcbiAgICB9KSAgICAgIFxyXG4gIH0pXHJcblxyXG4gIHBvaW50cy5mb3JFYWNoKGZ1bmN0aW9uKGVsZW0pIHtcclxuICAgIGVsZW0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihlKXtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICBsaW5rID0gZS50YXJnZXQ7XHJcbiAgICAgIGxldCBpbmRleCA9IGxpbmsuZGF0YXNldC5pbmRleDtcclxuICAgICAgbW92ZUNvbnRlbnQoaW5kZXgpO1xyXG4gICAgfSlcclxuICB9KVxyXG5cclxuICBsZXQgYnV0dG9uID0gZC5xdWVyeVNlbGVjdG9yKCcuaW50cm8tYnV0dG9uJyk7XHJcbiAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xyXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgbW92ZUNvbnRlbnQoNyk7XHJcbiAgfSlcclxuXHJcbiAgZC5hZGRFdmVudExpc3RlbmVyKCdrZXl1cCcsIGZ1bmN0aW9uKGUpIHtcclxuICAgIGxldCB3YXk7XHJcbiAgICBpZiAoZS5rZXlDb2RlID09IDM4KSB7XHJcbiAgICAgIHdheSA9ICd1cCc7XHJcbiAgICB9XHJcbiAgICBpZiAoZS5rZXlDb2RlID09IDQwKSB7XHJcbiAgICAgIHdheSA9ICdkb3duJztcclxuICAgICB9XHJcbiAgICAgc2Nyb2xsKHdheSk7XHJcbiAgfSlcclxufVxyXG5PbmVQYWdlU2Nyb2xsKCk7IiwiY29uc3Qgb3ZlcmxheSA9IChmdW5jdGlvbigpe1xyXG4gIGxldCBib2R5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignYm9keScpO1xyXG4gIGxldCBtb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbCcpO1xyXG4gIGxldCBtb2RhbElubmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX19pbm5lcicpOyAgXHJcblxyXG4gIGxldCBtb2RhbFRleHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICBtb2RhbFRleHQuY2xhc3NMaXN0LmFkZCgnbW9kYWxfX3RleHQnKTsgIFxyXG5cclxuICBsZXQgb3Blbk92ZXJsYXkgPSBmdW5jdGlvbihjb250ZW50LCByZXBseSkge1xyXG4gICAgbGV0IGJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xyXG4gICAgbW9kYWxUZXh0LnRleHRDb250ZW50ID0gY29udGVudDtcclxuICAgIG1vZGFsSW5uZXIuaW5uZXJIVE1MID0gXCJcIjtcclxuICAgIGlmKHJlcGx5KSB7XHJcbiAgICAgIGJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdvcmRlci1idXR0b24nKTtcclxuICAgICAgYnV0dG9uLnRleHRDb250ZW50ID0gJ9CX0LDQutGA0YvRgtGMJztcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdtb2RhbF9fY2xvc2UnKTtcclxuICAgIH1cclxuICAgIG1vZGFsSW5uZXIuYXBwZW5kQ2hpbGQobW9kYWxUZXh0KTtcclxuICAgIG1vZGFsSW5uZXIuYXBwZW5kQ2hpbGQoYnV0dG9uKTtcclxuXHJcbiAgICBtb2RhbC5jbGFzc0xpc3QuYWRkKCdpcy1hY3RpdmUnKTtcclxuICAgIGJvZHkuY2xhc3NMaXN0LmFkZCgnbG9ja2VkJyk7XHJcblxyXG4gICAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICBjbG9zZU92ZXJsYXkoKTtcclxuICAgIH0pXHJcblxyXG4gICAgbW9kYWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xyXG4gICAgICBpZiAoZS50YXJnZXQgPT09IG1vZGFsKSB7XHJcbiAgICAgICAgY2xvc2VPdmVybGF5KCk7XHJcbiAgICAgIH1cclxuICAgIH0pXHJcblxyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIChlKSA9PiB7XHJcbiAgICAgIGlmIChlLmtleUNvZGUgPT09IDI3KSBcclxuICAgICAgICBjbG9zZU92ZXJsYXkoKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgbGV0IGNsb3NlT3ZlcmxheSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgbW9kYWwuY2xhc3NMaXN0LnJlbW92ZSgnaXMtYWN0aXZlJyk7XHJcbiAgICBib2R5LmNsYXNzTGlzdC5yZW1vdmUoJ2xvY2tlZCcpO1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIHtcclxuICAgIG9wZW46IG9wZW5PdmVybGF5LFxyXG4gICAgY2xvc2U6IGNsb3NlT3ZlcmxheVxyXG4gIH07XHJcbn0oKSk7XHJcblxyXG5jb25zdCBhamF4Rm9ybSA9IGZ1bmN0aW9uKGZvcm0pIHtcclxuIFxyXG4gIGxldCBkYXRhID0gbmV3IEZvcm1EYXRhKCk7XHJcbiAgICBkYXRhLmFwcGVuZChcIm5hbWVcIiwgZm9ybS5lbGVtZW50cy5uYW1lLnZhbHVlKTtcclxuICAgIGRhdGEuYXBwZW5kKFwicGhvbmVcIiwgZm9ybS5lbGVtZW50cy5waG9uZS52YWx1ZSk7XHJcbiAgICBkYXRhLmFwcGVuZChcImNvbW1lbnRcIiwgZm9ybS5lbGVtZW50cy50ZXh0YXJlYS52YWx1ZSk7XHJcbiAgICBkYXRhLmFwcGVuZChcInRvXCIsIFwiY2xpZW50QG1haWwucnVcIik7XHJcbiAgXHJcbiAgICBjb25zdCB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcclxuICAgIHhoci5yZXNwb25zZVR5cGUgPSAnanNvbic7XHJcbiAgICB4aHIub3BlbignUE9TVCcsJ2h0dHBzOi8vd2ViZGV2LWFwaS5sb2Z0c2Nob29sLmNvbS9zZW5kbWFpbCcpO1xyXG4gICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoXCJYLVJlcXVlc3RlZC1XaXRoXCIsIFwiWE1MSHR0cFJlcXVlc3RcIik7XHJcbiAgICB4aHIuc2VuZChkYXRhKTtcclxuXHJcbiAgICByZXR1cm4geGhyO1xyXG4gIFxyXG59XHJcblxyXG5jb25zdCBzdWJtaXRGb3JtID0gZnVuY3Rpb24oKSB7ICBcclxuICBsZXQgZm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNvcmRlci1mb3JtJyk7XHJcbiAgaWYgKHZhbGlkYXRlRm9ybShmb3JtKSkge1xyXG4gICAgXHJcbiAgbGV0IHJlcXVlc3QgPSBhamF4Rm9ybShmb3JtKTsgIFxyXG4gICAgcmVxdWVzdC5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywgKCk9PiB7XHJcbiAgICAgIGxldCByZXBseSA9IGZhbHNlO1xyXG4gICAgICBpZiAocmVxdWVzdC5zdGF0dXMgPj00MDApIHtcclxuICAgICAgICBsZXQgY29udGVudCA9ICfQntGI0LjQsdC60LAg0YHQvtC10LTQuNC90LXQvdC40Y8g0YEg0YHQtdGA0LLQtdGA0L7QvCwg0L/QvtC/0YDQvtCx0YPQudGC0LUg0L/QvtC30LbQtSc7XHJcbiAgICAgICAgb3ZlcmxheS5vcGVuKGAke2NvbnRlbnR9LiDQntGI0LjQsdC60LAgJHtyZXF1ZXN0LnN0YXR1c31gLCByZXBseSk7XHJcbiAgICAgIH0gZWxzZSBpZiAocmVxdWVzdC5yZXNwb25zZS5zdGF0dXMgPT0gMCkge1xyXG4gICAgICAgIGNvbnRlbnQgPSByZXF1ZXN0LnJlc3BvbnNlLm1lc3NhZ2U7XHJcbiAgICAgICAgb3ZlcmxheS5vcGVuKGNvbnRlbnQsIHJlcGx5KTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBjb250ZW50ID0gJ9Ch0L7QvtCx0YnQtdC90LjQtSDQvtGC0L/RgNCw0LLQu9C10L3Qvic7XHJcbiAgICAgICAgcmVwbHkgPSB0cnVlO1xyXG4gICAgICAgIG92ZXJsYXkub3Blbihjb250ZW50LCByZXBseSk7XHJcbiAgICAgIH1cclxuICAgIH0pXHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiB2YWxpZGF0ZUZvcm0oZm9ybSkge1xyXG4gIGxldCB2YWxpZCA9IHRydWU7XHJcbiAgaWYoIXZhbGlkYXRlRmllbGQoZm9ybS5lbGVtZW50cy5uYW1lKSkge1xyXG4gICAgdmFsaWQgPSBmYWxzZTtcclxuICB9XHJcbiAgaWYoIXZhbGlkYXRlRmllbGQoZm9ybS5lbGVtZW50cy5waG9uZSkpIHtcclxuICAgIHZhbGlkID0gZmFsc2U7XHJcbiAgfVxyXG4gIGlmKCF2YWxpZGF0ZUZpZWxkKGZvcm0uZWxlbWVudHMudGV4dGFyZWEpKSB7XHJcbiAgICB2YWxpZCA9IGZhbHNlO1xyXG4gIH1cclxuICByZXR1cm4gdmFsaWQ7XHJcbn1cclxuZnVuY3Rpb24gdmFsaWRhdGVGaWVsZChmaWVsZCkge1xyXG4gIGZpZWxkLm5leHRFbGVtZW50U2libGluZy50ZXh0Q29udGVudCA9IGZpZWxkLnZhbGlkYXRpb25NZXNzYWdlO1xyXG4gIHJldHVybiBmaWVsZC5jaGVja1ZhbGlkaXR5KCk7XHJcbn1cclxuXHJcbmxldCBvcmRlckJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNzZW5kJyk7XHJcbm9yZGVyQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZSA9PiB7XHJcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gIHN1Ym1pdEZvcm0oKTtcclxufSk7IiwiKGZ1bmN0aW9uKCl7XHJcbiAgY29uc3QgaXRlbXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucmV2aWV3c19faXRlbScpO1xyXG4gIGNvbnN0IHBpeCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5yZXZpZXdzX19waXgtaXRlbScpO1xyXG4gIGxldCBhY3RpdmUgPSAwO1xyXG5cclxuICBmb3IgKGxldCBpID0gMDsgaSA8IGl0ZW1zLmxlbmd0aDsgaSsrKSB7XHJcbiAgICBwaXhbaV0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgaXRlbXNbaV0uY2xhc3NMaXN0LnRvZ2dsZSgnaXMtYWN0aXZlJyk7XHJcbiAgICAgIHBpeFtpXS5jbGFzc0xpc3QudG9nZ2xlKCdpcy1hY3RpdmUnKTtcclxuICAgICBcclxuICAgICAgcGl4W2FjdGl2ZV0uY2xhc3NMaXN0LnRvZ2dsZSgnaXMtYWN0aXZlJyk7XHJcbiAgICAgIGl0ZW1zW2FjdGl2ZV0uY2xhc3NMaXN0LnRvZ2dsZSgnaXMtYWN0aXZlJyk7XHJcbiAgICAgIGFjdGl2ZSA9IGk7ICAgICBcclxuICAgIH0pXHJcbiAgfVxyXG59KCkpOyIsImxldCB2aWRlb1BsYXllciA9IGZ1bmN0aW9uKCl7XHJcblxyXG4gIGxldCB2aWRlbyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy52aWRlb19fY29udGVudCcpO1xyXG4gIGxldCBwbGF5QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnZpZGVvX19idG4nKTtcclxuICBsZXQgdm9sdW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnZpZGVvX192b2x1bWUnKTtcclxuICBsZXQgcHJvZ3Jlc3NCYXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudmlkZW9fX3Byb2dyZXNzJyk7XHJcbiAgbGV0IHN3aXRjaEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy52aWRlb19fcGxheScpO1xyXG4gIGxldCBwbGF5aW5nID0gZmFsc2U7XHJcblxyXG4gIHZpZGVvLm9udGltZXVwZGF0ZSA9IGZ1bmN0aW9uKCl7XHJcbiAgICBwcm9ncmVzcygpO1xyXG4gICAgaWYodmlkZW8uY3VycmVudFRpbWUgPT0gdmlkZW8uZHVyYXRpb24pe1xyXG4gICAgICBwYXVzZSgpO1xyXG4gICAgfVxyXG4gIH0gXHJcbiAgZnVuY3Rpb24gcGxheSgpIHtcclxuICAgIHZpZGVvLnBsYXkoKTtcclxuICAgIHBsYXlpbmcgPSB0cnVlO1xyXG4gICAgcGxheUJ0bi5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKTtcclxuICAgIHN3aXRjaEJ0bi5jbGFzc0xpc3QuYWRkKCdzdG9wJyk7XHJcbiAgfVxyXG4gIGZ1bmN0aW9uIHBhdXNlKCkge1xyXG4gICAgdmlkZW8ucGF1c2UoKTtcclxuICAgIHBsYXlpbmcgPSBmYWxzZTtcclxuICAgIHBsYXlCdG4uY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7XHJcbiAgICBzd2l0Y2hCdG4uY2xhc3NMaXN0LnJlbW92ZSgnc3RvcCcpO1xyXG4gIH1cclxuICBmdW5jdGlvbiBwcm9ncmVzcygpe1xyXG4gICAgbGV0IGR1cmF0aW9uID0gdmlkZW8uZHVyYXRpb247XHJcbiAgICBsZXQgdGltZSA9IHZpZGVvLmN1cnJlbnRUaW1lO1xyXG4gICAgcHJvZ3Jlc3NCYXIudmFsdWUgPSAodGltZS9kdXJhdGlvbikqMTAwO1xyXG4gIH1cclxuXHJcbiAgcGxheUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCl7XHJcbiAgICBpZighcGxheWluZykge1xyXG4gICAgICBwbGF5KCk7XHJcbiAgICB9XHJcbiAgfSk7XHJcbiAgdmlkZW8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbigpe1xyXG4gICAgICBpZihwbGF5aW5nKSB7XHJcbiAgICAgICAgcGF1c2UoKTtcclxuICAgICAgfVxyXG4gIH0pO1xyXG4gIHZvbHVtZS5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIGZ1bmN0aW9uKCl7XHJcbiAgICBsZXQgdmFsdWUgPSB0aGlzLnZhbHVlO1xyXG4gICAgdmlkZW8udm9sdW1lID0gdmFsdWUvMTAwO1xyXG4gIH0pXHJcbiAgcHJvZ3Jlc3NCYXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihlKSB7XHJcbiAgICBsZXQgd2lkdGggPSBwcm9ncmVzc0Jhci5vZmZzZXRXaWR0aDtcclxuICAgIGxldCBwb3MgPSBlLm9mZnNldFg7XHJcbiAgICBwcm9ncmVzc0Jhci52YWx1ZSA9IChwb3Mvd2lkdGgpKjEwMDtcclxuICAgIHZpZGVvLnBhdXNlKCk7XHJcbiAgICB2aWRlby5jdXJyZW50VGltZSA9IHZpZGVvLmR1cmF0aW9uKihwb3Mvd2lkdGgpO1xyXG4gICAgdmlkZW8ucGxheSgpO1xyXG4gIH0pXHJcbiAgc3dpdGNoQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJyxmdW5jdGlvbigpe1xyXG4gICAgaWYoIXBsYXlpbmcpIHtcclxuICAgICAgcGxheSgpO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZihwbGF5aW5nKSB7XHJcbiAgICAgIHBhdXNlKCk7XHJcbiAgICAgIHZpZGVvLmN1cnJlbnRUaW1lID0gMDtcclxuICAgIH1cclxuICB9KVxyXG5cclxufVxyXG52aWRlb1BsYXllcigpO1xyXG4iXX0=
